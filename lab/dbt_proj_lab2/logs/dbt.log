[0m02:14:06.510309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c0c7dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c04f9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c09edbb0>]}


============================== 02:14:06.520312 | 2127a481-c68c-49ae-a535-587b9178b081 ==============================
[0m02:14:06.520312 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:14:06.521963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:14:08.373821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2127a481-c68c-49ae-a535-587b9178b081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ac8ac440>]}
[0m02:14:08.455170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2127a481-c68c-49ae-a535-587b9178b081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5aca051c0>]}
[0m02:14:08.456751 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:14:08.618326 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:14:08.621452 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:14:08.622831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2127a481-c68c-49ae-a535-587b9178b081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ac8ac3b0>]}
[0m02:14:10.544602 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot stock_prices_snapshot (snapshots/stock_prices_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m02:14:10.548062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.1182017, "process_user_time": 7.603519, "process_kernel_time": 0.675494, "process_mem_max_rss": "207184", "process_in_blocks": "11104", "process_out_blocks": "2205", "command_success": false}
[0m02:14:10.549881 [debug] [MainThread]: Command `dbt run` failed at 02:14:10.549659 after 4.12 seconds
[0m02:14:10.551311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c02a2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ac56fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ac227110>]}
[0m02:14:10.552649 [debug] [MainThread]: Flushing usage events
[0m02:19:16.435097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b18cf17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b18cf0e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b18e532f0>]}


============================== 02:19:16.443546 | fb78f193-9346-45f2-ba17-ee2fb80b2349 ==============================
[0m02:19:16.443546 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:19:16.445210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:19:17.699046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb78f193-9346-45f2-ba17-ee2fb80b2349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b068707a0>]}
[0m02:19:17.795327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb78f193-9346-45f2-ba17-ee2fb80b2349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b06abbce0>]}
[0m02:19:17.797178 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:19:17.959463 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:19:17.962146 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:19:17.963253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb78f193-9346-45f2-ba17-ee2fb80b2349', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b13938260>]}
[0m02:19:20.316201 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot stock_prices_snapshot (snapshots/stock_prices_snapshot.sql)
  expected token ',', got '='
    line 5
      --             strategy='timestamp',  -- Can be 'timestamp' or 'check'
[0m02:19:20.321124 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.0177083, "process_user_time": 6.793168, "process_kernel_time": 0.519916, "process_mem_max_rss": "207228", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m02:19:20.325065 [debug] [MainThread]: Command `dbt run` failed at 02:19:20.324727 after 4.02 seconds
[0m02:19:20.328053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b18d9d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b05536390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b13938260>]}
[0m02:19:20.331394 [debug] [MainThread]: Flushing usage events
[0m02:25:09.122582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff059aba1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05a418860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff059ba0aa0>]}


============================== 02:25:09.133404 | 2c7376d1-2006-4788-aa5d-0d6fd6dda5b8 ==============================
[0m02:25:09.133404 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:25:09.135322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:25:10.347796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c7376d1-2006-4788-aa5d-0d6fd6dda5b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff04648d790>]}
[0m02:25:10.429416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c7376d1-2006-4788-aa5d-0d6fd6dda5b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0487084a0>]}
[0m02:25:10.431216 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:25:10.664620 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:25:10.675269 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:25:10.681657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c7376d1-2006-4788-aa5d-0d6fd6dda5b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff048708a70>]}
[0m02:25:12.757507 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot stock_prices_snapshot (snapshots/stock_prices_snapshot.sql)
  expected token ',', got '='
    line 5
      --             strategy='timestamp',  -- Can be 'timestamp' or 'check'
[0m02:25:12.763939 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7777622, "process_user_time": 6.049368, "process_kernel_time": 0.523574, "process_mem_max_rss": "207188", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m02:25:12.766112 [debug] [MainThread]: Command `dbt run` failed at 02:25:12.765746 after 3.78 seconds
[0m02:25:12.767495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff05d7bb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0460b39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0460b2b10>]}
[0m02:25:12.768961 [debug] [MainThread]: Flushing usage events
[0m02:26:45.984264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8973c96c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8971b33950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f897227ec00>]}


============================== 02:26:45.993318 | 66c456d2-37d0-4392-bee4-9bd54d9b8ca7 ==============================
[0m02:26:45.993318 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:26:45.994521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:26:47.182226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66c456d2-37d0-4392-bee4-9bd54d9b8ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895eeb6ae0>]}
[0m02:26:47.259426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66c456d2-37d0-4392-bee4-9bd54d9b8ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f895e6c6930>]}
[0m02:26:47.260708 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:26:47.435494 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:26:47.438625 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:26:47.440244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '66c456d2-37d0-4392-bee4-9bd54d9b8ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c5b8c20>]}
[0m02:26:49.068483 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj_lab2.stock_price_base' (models/stock_price_base.sql) depends on a node named 'raw_data_stockprice' which was not found
[0m02:26:49.070260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2247555, "process_user_time": 5.664365, "process_kernel_time": 0.501005, "process_mem_max_rss": "205904", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m02:26:49.071316 [debug] [MainThread]: Command `dbt run` failed at 02:26:49.071138 after 3.23 seconds
[0m02:26:49.072135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8971b33950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8972de4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f896c5b8c20>]}
[0m02:26:49.073326 [debug] [MainThread]: Flushing usage events
[0m02:31:54.118840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1923e66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1936c12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb191c20da0>]}


============================== 02:31:54.127598 | 528a46fb-0356-4fc5-8aa2-bb8f857558b9 ==============================
[0m02:31:54.127598 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:31:54.128949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m02:31:55.214089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '528a46fb-0356-4fc5-8aa2-bb8f857558b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17e3c7ef0>]}
[0m02:31:55.287598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '528a46fb-0356-4fc5-8aa2-bb8f857558b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb19140b290>]}
[0m02:31:55.289140 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:31:55.439828 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:31:55.442683 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:31:55.443858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '528a46fb-0356-4fc5-8aa2-bb8f857558b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17f949bb0>]}
[0m02:31:56.736961 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj_lab2.stock_price_base' (models/stock_price_base.sql) depends on a node named 'raw_data_stockprice' which was not found
[0m02:31:56.739489 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.742853, "process_user_time": 4.766975, "process_kernel_time": 0.464582, "process_mem_max_rss": "206208", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m02:31:56.741235 [debug] [MainThread]: Command `dbt run` failed at 02:31:56.741063 after 2.74 seconds
[0m02:31:56.742598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb191b31a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17e0dbfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb17e339d00>]}
[0m02:31:56.743606 [debug] [MainThread]: Flushing usage events
[0m19:05:47.829365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c62d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c629f0>]}


============================== 19:05:47.833972 | a6c9d003-f006-4434-be85-40d298ed64ef ==============================
[0m19:05:47.833972 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:05:47.834733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:05:50.154277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6c9d003-f006-4434-be85-40d298ed64ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a70bfb0>]}
[0m19:05:50.230990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6c9d003-f006-4434-be85-40d298ed64ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a77ee40>]}
[0m19:05:50.234141 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:05:50.296171 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:05:50.297446 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:05:50.298306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6c9d003-f006-4434-be85-40d298ed64ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c697860>]}
[0m19:05:51.681020 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj_lab2.stock_price_base' (models/stock_price_base.sql) depends on a node named 'raw_data_stockprice' which was not found
[0m19:05:51.687397 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9401565, "process_user_time": 4.324355, "process_kernel_time": 0.606719, "process_mem_max_rss": "169959424", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:05:51.688639 [debug] [MainThread]: Command `dbt run` failed at 19:05:51.688429 after 3.94 seconds
[0m19:05:51.689350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c62c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c839f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ca0e810>]}
[0m19:05:51.689907 [debug] [MainThread]: Flushing usage events
[0m19:11:04.926292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6a7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d88e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d88e5a0>]}


============================== 19:11:04.932331 | 113c1b43-5274-44bb-b861-ef8dee66c954 ==============================
[0m19:11:04.932331 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:11:04.933052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:11:05.145908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '113c1b43-5274-44bb-b861-ef8dee66c954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c724ce0>]}
[0m19:11:05.184732 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.34103304, "process_user_time": 1.963443, "process_kernel_time": 0.462317, "process_mem_max_rss": "88817664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:11:05.185556 [debug] [MainThread]: Command `dbt clean` succeeded at 19:11:05.185393 after 0.34 seconds
[0m19:11:05.186198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9588c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9b0290>]}
[0m19:11:05.186863 [debug] [MainThread]: Flushing usage events
[0m19:11:13.556634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cb2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b62cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b62a50>]}


============================== 19:11:13.561236 | d901ab26-f312-4190-8432-856ddfb6cfe8 ==============================
[0m19:11:13.561236 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:11:13.562000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:11:16.118467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd901ab26-f312-4190-8432-856ddfb6cfe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103f6270>]}
[0m19:11:16.192725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd901ab26-f312-4190-8432-856ddfb6cfe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11226ef00>]}
[0m19:11:16.196099 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:11:16.225705 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:11:16.227572 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:11:16.229248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd901ab26-f312-4190-8432-856ddfb6cfe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12466bc20>]}
[0m19:11:17.697654 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj_lab2.stock_price_base' (models/stock_price_base.sql) depends on a node named 'stockprice' which was not found
[0m19:11:17.704373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.217268, "process_user_time": 4.377051, "process_kernel_time": 0.648477, "process_mem_max_rss": "169402368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:11:17.705867 [debug] [MainThread]: Command `dbt run` failed at 19:11:17.705659 after 4.22 seconds
[0m19:11:17.739104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b62d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12484eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1248d93d0>]}
[0m19:11:17.755249 [debug] [MainThread]: Flushing usage events
[0m19:12:20.400660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6d5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a80acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a80aa80>]}


============================== 19:12:20.405986 | db4f5b95-5bae-469e-93b9-a36ff4b4e632 ==============================
[0m19:12:20.405986 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:12:20.406796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:12:21.678536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db4f5b95-5bae-469e-93b9-a36ff4b4e632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d0e16a0>]}
[0m19:12:21.750793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db4f5b95-5bae-469e-93b9-a36ff4b4e632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad60ad0>]}
[0m19:12:21.754017 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:12:21.776587 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:12:21.777951 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:12:21.778456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'db4f5b95-5bae-469e-93b9-a36ff4b4e632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c248bc0>]}
[0m19:12:23.117958 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj_lab2.stock_price_base' (models/stock_price_base.sql) depends on a node named 'stockprice' which was not found
[0m19:12:23.126411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8058627, "process_user_time": 4.228613, "process_kernel_time": 0.447225, "process_mem_max_rss": "169488384", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:12:23.127240 [debug] [MainThread]: Command `dbt run` failed at 19:12:23.127094 after 2.81 seconds
[0m19:12:23.127767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6d5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1d6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4b23f0>]}
[0m19:12:23.128246 [debug] [MainThread]: Flushing usage events
[0m19:24:36.663236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b5a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112542bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112542960>]}


============================== 19:24:36.669851 | ed399791-f878-423c-9b6d-8b7ccc211c28 ==============================
[0m19:24:36.669851 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:24:36.670781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:24:39.211422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed399791-f878-423c-9b6d-8b7ccc211c28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124d5ec00>]}
[0m19:24:39.276679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed399791-f878-423c-9b6d-8b7ccc211c28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fb9f70>]}
[0m19:24:39.279958 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:24:39.310851 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:24:39.312162 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:24:39.312787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed399791-f878-423c-9b6d-8b7ccc211c28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125040170>]}
[0m19:24:40.585228 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj_lab2.price_momentum' (models/price_momentum.sql) depends on a source named 'raw_data.stockprice' which was not found
[0m19:24:40.592990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.0089135, "process_user_time": 4.48734, "process_kernel_time": 0.878299, "process_mem_max_rss": "169267200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:24:40.594075 [debug] [MainThread]: Command `dbt run` failed at 19:24:40.593865 after 4.01 seconds
[0m19:24:40.595116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112542b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123ceae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12504e060>]}
[0m19:24:40.595658 [debug] [MainThread]: Flushing usage events
[0m19:28:24.586031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10873daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10885e7b0>]}


============================== 19:28:24.592374 | 067bfcaa-cb0f-4f12-84cf-6a5e47cfd412 ==============================
[0m19:28:24.592374 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:28:24.593124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:28:26.883065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '067bfcaa-cb0f-4f12-84cf-6a5e47cfd412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6f05c0>]}
[0m19:28:26.948642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '067bfcaa-cb0f-4f12-84cf-6a5e47cfd412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b01fda0>]}
[0m19:28:26.951713 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:28:26.984727 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:28:26.986843 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:28:26.987583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '067bfcaa-cb0f-4f12-84cf-6a5e47cfd412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3a10d0>]}
[0m19:28:28.242879 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_proj_lab2.price_momentum' (models/price_momentum.sql) depends on a source named 'raw_data.stockprice' which was not found
[0m19:28:28.247350 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7385638, "process_user_time": 4.412674, "process_kernel_time": 0.739897, "process_mem_max_rss": "169803776", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:28:28.248191 [debug] [MainThread]: Command `dbt run` failed at 19:28:28.248035 after 3.74 seconds
[0m19:28:28.248766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e6a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b542a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b563020>]}
[0m19:28:28.249426 [debug] [MainThread]: Flushing usage events
[0m19:32:34.711531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7b7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae18c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b21a840>]}


============================== 19:32:34.719489 | 95cc96a7-923b-4b3f-82dc-e8c4a277df5a ==============================
[0m19:32:34.719489 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:32:34.720472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:32:36.983684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95cc96a7-923b-4b3f-82dc-e8c4a277df5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cf01790>]}
[0m19:32:37.051238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95cc96a7-923b-4b3f-82dc-e8c4a277df5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1eea20>]}
[0m19:32:37.054351 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:32:37.080746 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:32:37.082125 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:32:37.082666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '95cc96a7-923b-4b3f-82dc-e8c4a277df5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ce030>]}
[0m19:32:38.618147 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m19:32:38.635371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95cc96a7-923b-4b3f-82dc-e8c4a277df5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dffacf0>]}
[0m19:32:38.758554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95cc96a7-923b-4b3f-82dc-e8c4a277df5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11df9e690>]}
[0m19:32:38.759246 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m19:32:38.759710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95cc96a7-923b-4b3f-82dc-e8c4a277df5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dd43290>]}
[0m19:32:38.762632 [info ] [MainThread]: 
[0m19:32:38.763824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:32:38.770435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:32:38.788489 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:32:38.788990 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:32:38.789381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:39.975977 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:32:39.976505 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:32:39.976997 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m19:32:39.977387 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:32:39.978027 [debug] [ThreadPool]: On list_dev: No close available on handle
[0m19:32:39.979107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:32:39.979583 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:32:39.979989 [info ] [MainThread]: 
[0m19:32:39.980453 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m19:32:39.981056 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "dev"
  Database Error
    250001 (08001): Failed to connect to DB: DQB02309.snowflakecomputing.com:443. Role 'ADMIN' specified in the connect string does not exist or not authorized. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
[0m19:32:39.985507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.361518, "process_user_time": 5.18606, "process_kernel_time": 0.949333, "process_mem_max_rss": "181121024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:32:39.986569 [debug] [MainThread]: Command `dbt run` failed at 19:32:39.986367 after 5.36 seconds
[0m19:32:39.987169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ae3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e2039e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dfd01d0>]}
[0m19:32:39.987714 [debug] [MainThread]: Flushing usage events
[0m19:33:57.562298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9d2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9d2960>]}


============================== 19:33:57.568283 | 7eae135c-6979-4e70-9b21-6affdba1408e ==============================
[0m19:33:57.568283 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:33:57.569029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:33:58.802741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7eae135c-6979-4e70-9b21-6affdba1408e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986df40>]}
[0m19:33:58.867079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7eae135c-6979-4e70-9b21-6affdba1408e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c62a3c0>]}
[0m19:33:58.868431 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:33:58.889793 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:33:58.995939 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:33:58.996653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7eae135c-6979-4e70-9b21-6affdba1408e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d63eff0>]}
[0m19:34:00.426325 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m19:34:00.441638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7eae135c-6979-4e70-9b21-6affdba1408e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6ff560>]}
[0m19:34:00.560636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7eae135c-6979-4e70-9b21-6affdba1408e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d826150>]}
[0m19:34:00.561270 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m19:34:00.561728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7eae135c-6979-4e70-9b21-6affdba1408e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7fb6b0>]}
[0m19:34:00.564010 [info ] [MainThread]: 
[0m19:34:00.564981 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:34:00.571630 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:34:00.590305 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:34:00.590810 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:34:00.591199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:01.090665 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:34:01.091417 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:34:01.092129 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m19:34:01.092708 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:34:01.093479 [debug] [ThreadPool]: On list_dev: No close available on handle
[0m19:34:01.094513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:01.094969 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:34:01.095448 [info ] [MainThread]: 
[0m19:34:01.095995 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m19:34:01.096707 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "dev"
  Database Error
    250001 (08001): Failed to connect to DB: GRUCZYK-GXB35691.snowflakecomputing.com:443. Role 'ADMIN' specified in the connect string does not exist or not authorized. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
[0m19:34:01.102045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6162531, "process_user_time": 4.834039, "process_kernel_time": 0.634169, "process_mem_max_rss": "181239808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:34:01.103088 [debug] [MainThread]: Command `dbt run` failed at 19:34:01.102885 after 3.62 seconds
[0m19:34:01.103773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9d2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4511f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4f1a30>]}
[0m19:34:01.104369 [debug] [MainThread]: Flushing usage events
[0m19:35:58.458442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f46b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e2ba0>]}


============================== 19:35:58.463616 | 0cf6f897-915e-4bad-8106-28844d521f9c ==============================
[0m19:35:58.463616 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:35:58.464407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:36:00.128264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cf6f897-915e-4bad-8106-28844d521f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1258d9df0>]}
[0m19:36:00.193368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cf6f897-915e-4bad-8106-28844d521f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e3cfe0>]}
[0m19:36:00.194841 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:36:00.220027 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:36:00.323393 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:36:00.324017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0cf6f897-915e-4bad-8106-28844d521f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12615b050>]}
[0m19:36:01.726011 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m19:36:01.745587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cf6f897-915e-4bad-8106-28844d521f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12633d070>]}
[0m19:36:01.866942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cf6f897-915e-4bad-8106-28844d521f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126337410>]}
[0m19:36:01.867583 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m19:36:01.868053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cf6f897-915e-4bad-8106-28844d521f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261ac590>]}
[0m19:36:01.870386 [info ] [MainThread]: 
[0m19:36:01.871098 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:36:01.876922 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:36:01.895011 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:36:01.895531 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:36:01.895916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:02.383703 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:36:02.384418 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:36:02.385116 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m19:36:02.385695 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m19:36:02.386419 [debug] [ThreadPool]: On list_dev: No close available on handle
[0m19:36:02.387476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:02.387936 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:36:02.388423 [info ] [MainThread]: 
[0m19:36:02.388977 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m19:36:02.389680 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "dev"
  Database Error
    250001 (08001): Failed to connect to DB: DQB02309.snowflakecomputing.com:443. Role 'ADMIN' specified in the connect string does not exist or not authorized. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
[0m19:36:02.394253 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.009512, "process_user_time": 4.681871, "process_kernel_time": 0.597874, "process_mem_max_rss": "181731328", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:36:02.395300 [debug] [MainThread]: Command `dbt run` failed at 19:36:02.395095 after 4.01 seconds
[0m19:36:02.395916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1264f78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12606eae0>]}
[0m19:36:02.396463 [debug] [MainThread]: Flushing usage events
[0m19:37:35.659314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b89790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075eacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ea960>]}


============================== 19:37:35.665035 | de1ad3ee-fd4d-442e-9dd6-79b5df2b65e7 ==============================
[0m19:37:35.665035 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:37:35.665874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:37:37.254331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de1ad3ee-fd4d-442e-9dd6-79b5df2b65e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10816a570>]}
[0m19:37:37.331150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de1ad3ee-fd4d-442e-9dd6-79b5df2b65e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bb5dc0>]}
[0m19:37:37.334034 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:37:37.359246 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:37:37.468140 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m19:37:37.468896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de1ad3ee-fd4d-442e-9dd6-79b5df2b65e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b88ce0>]}
[0m19:37:38.891247 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m19:37:38.906838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de1ad3ee-fd4d-442e-9dd6-79b5df2b65e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d5bc50>]}
[0m19:37:39.026554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de1ad3ee-fd4d-442e-9dd6-79b5df2b65e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a41a4e0>]}
[0m19:37:39.027310 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m19:37:39.027836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de1ad3ee-fd4d-442e-9dd6-79b5df2b65e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3b32c0>]}
[0m19:37:39.030264 [info ] [MainThread]: 
[0m19:37:39.030966 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:37:39.037355 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:37:39.056865 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:37:39.057438 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:37:39.057824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:39.677127 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.619 seconds
[0m19:37:39.680321 [debug] [ThreadPool]: On list_dev: Close
[0m19:37:39.828717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m19:37:39.842034 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m19:37:39.842616 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m19:37:39.843094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:40.288037 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.445 seconds
[0m19:37:40.291036 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m19:37:40.399922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de1ad3ee-fd4d-442e-9dd6-79b5df2b65e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0f1370>]}
[0m19:37:40.400918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:40.401545 [info ] [MainThread]: 
[0m19:37:40.411840 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.moving_averages
[0m19:37:40.412880 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.moving_averages .......................... [RUN]
[0m19:37:40.413973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.moving_averages)
[0m19:37:40.415737 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.moving_averages
[0m19:37:40.428476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.moving_averages"
[0m19:37:40.430259 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.moving_averages
[0m19:37:40.488386 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.moving_averages"
[0m19:37:40.490696 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.moving_averages"
[0m19:37:40.491752 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.moving_averages"} */
create or replace   view dev.analytics.moving_averages
  
   as (
    WITH price_data AS (
    SELECT
        date,
        symbol,
        close,
        volume
    FROM dev.raw_data.stockprice
)

SELECT
    symbol,
    DATE_TRUNC('week', date) AS week_start,
    AVG(close) AS avg_close_price,
    AVG(volume) AS avg_volume
FROM price_data
GROUP BY symbol, DATE_TRUNC('week', date)
ORDER BY week_start, symbol;
[0m19:37:40.492752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:41.046403 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86119-0004-2cec-0002-707300017582
[0m19:37:41.047080 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 27 unexpected ';'.
[0m19:37:41.047699 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: Close
[0m19:37:41.185202 [debug] [Thread-1 (]: Database Error in model moving_averages (models/moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 27 unexpected ';'.
  compiled code at target/run/dbt_proj_lab2/models/moving_averages.sql
[0m19:37:41.187590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1ad3ee-fd4d-442e-9dd6-79b5df2b65e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a73f410>]}
[0m19:37:41.188610 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model analytics.moving_averages ................. [[31mERROR[0m in 0.77s]
[0m19:37:41.189604 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.moving_averages
[0m19:37:41.190282 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.price_momentum
[0m19:37:41.190985 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.price_momentum ........................... [RUN]
[0m19:37:41.192560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.moving_averages, now model.dbt_proj_lab2.price_momentum)
[0m19:37:41.193155 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.price_momentum
[0m19:37:41.197721 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.price_momentum"
[0m19:37:41.198821 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.price_momentum
[0m19:37:41.203500 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.price_momentum"
[0m19:37:41.205557 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.price_momentum"
[0m19:37:41.206487 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.price_momentum"} */
create or replace   view dev.analytics.price_momentum
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    previous_close,
    close - previous_close AS price_momentum
FROM base_data
WHERE previous_close IS NOT NULL
ORDER BY symbol, date;
[0m19:37:41.207656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:41.599338 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86119-0004-2ceb-0002-70730001260a
[0m19:37:41.600232 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 21 unexpected ';'.
[0m19:37:41.601033 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: Close
[0m19:37:41.723227 [debug] [Thread-1 (]: Database Error in model price_momentum (models/price_momentum.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 21 unexpected ';'.
  compiled code at target/run/dbt_proj_lab2/models/price_momentum.sql
[0m19:37:41.723982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1ad3ee-fd4d-442e-9dd6-79b5df2b65e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a40a540>]}
[0m19:37:41.724878 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model analytics.price_momentum .................. [[31mERROR[0m in 0.53s]
[0m19:37:41.725845 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.price_momentum
[0m19:37:41.726509 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.rsi
[0m19:37:41.727221 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi ...................................... [RUN]
[0m19:37:41.728140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.price_momentum, now model.dbt_proj_lab2.rsi)
[0m19:37:41.728708 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.rsi
[0m19:37:41.732543 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.rsi"
[0m19:37:41.734122 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.rsi
[0m19:37:41.738908 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.rsi"
[0m19:37:41.741452 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.rsi"
[0m19:37:41.742509 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.rsi"} */
create or replace   view dev.analytics.rsi
  
   as (
    WITH price_changes AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM dev.raw_data.stockprice
),

daily_changes AS (
    SELECT
        date,
        symbol,
        GREATEST(close - prev_close, 0) AS gain,
        GREATEST(prev_close - close, 0) AS loss
    FROM price_changes
    WHERE prev_close IS NOT NULL
),

rsi_data AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS 13 PRECEDING) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS 13 PRECEDING) AS avg_loss
    FROM daily_changes
)

SELECT
    date,
    symbol,
    100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))) AS rsi
FROM rsi_data;
[0m19:37:41.743261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:42.201675 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86119-0004-2cf4-0002-707300014572
[0m19:37:42.202433 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 36 at position 13 unexpected ';'.
[0m19:37:42.203229 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: Close
[0m19:37:42.324230 [debug] [Thread-1 (]: Database Error in model rsi (models/rsi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 36 at position 13 unexpected ';'.
  compiled code at target/run/dbt_proj_lab2/models/rsi.sql
[0m19:37:42.324958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1ad3ee-fd4d-442e-9dd6-79b5df2b65e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a321130>]}
[0m19:37:42.325885 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model analytics.rsi ............................. [[31mERROR[0m in 0.60s]
[0m19:37:42.326836 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.rsi
[0m19:37:42.328615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:42.329110 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.rsi' was properly closed.
[0m19:37:42.329674 [info ] [MainThread]: 
[0m19:37:42.330230 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m19:37:42.331751 [debug] [MainThread]: Command end result
[0m19:37:42.374920 [info ] [MainThread]: 
[0m19:37:42.375669 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:37:42.376410 [info ] [MainThread]: 
[0m19:37:42.377405 [error] [MainThread]:   Database Error in model moving_averages (models/moving_averages.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 27 unexpected ';'.
  compiled code at target/run/dbt_proj_lab2/models/moving_averages.sql
[0m19:37:42.378317 [info ] [MainThread]: 
[0m19:37:42.379103 [error] [MainThread]:   Database Error in model price_momentum (models/price_momentum.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 21 unexpected ';'.
  compiled code at target/run/dbt_proj_lab2/models/price_momentum.sql
[0m19:37:42.379673 [info ] [MainThread]: 
[0m19:37:42.380274 [error] [MainThread]:   Database Error in model rsi (models/rsi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 36 at position 13 unexpected ';'.
  compiled code at target/run/dbt_proj_lab2/models/rsi.sql
[0m19:37:42.380758 [info ] [MainThread]: 
[0m19:37:42.381759 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m19:37:42.384973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.825838, "process_user_time": 5.285207, "process_kernel_time": 0.604334, "process_mem_max_rss": "183386112", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:37:42.385804 [debug] [MainThread]: Command `dbt run` failed at 19:37:42.385655 after 6.83 seconds
[0m19:37:42.386352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2ed160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2ed3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2edb20>]}
[0m19:37:42.386849 [debug] [MainThread]: Flushing usage events
[0m19:40:55.595067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f61e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115a6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115a6930>]}


============================== 19:40:55.601177 | 5e51e871-34a6-4710-a5bc-f1d34a4dd784 ==============================
[0m19:40:55.601177 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:40:55.602069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:40:57.957518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e51e871-34a6-4710-a5bc-f1d34a4dd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe39d90>]}
[0m19:40:58.021781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e51e871-34a6-4710-a5bc-f1d34a4dd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232119a0>]}
[0m19:40:58.024896 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:40:58.054294 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:40:58.242237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m19:40:58.242950 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/price_momentum.sql
[0m19:40:58.243433 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/rsi.sql
[0m19:40:58.243897 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/moving_averages.sql
[0m19:40:58.517011 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m19:40:58.534667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e51e871-34a6-4710-a5bc-f1d34a4dd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ed4b60>]}
[0m19:40:58.651641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e51e871-34a6-4710-a5bc-f1d34a4dd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12417fd10>]}
[0m19:40:58.652488 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m19:40:58.653038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e51e871-34a6-4710-a5bc-f1d34a4dd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1242ea720>]}
[0m19:40:58.655792 [info ] [MainThread]: 
[0m19:40:58.656627 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:40:58.662917 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:40:58.682235 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:40:58.682729 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:40:58.683114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:59.334166 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.651 seconds
[0m19:40:59.337513 [debug] [ThreadPool]: On list_dev: Close
[0m19:40:59.456710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m19:40:59.471077 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m19:40:59.471676 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m19:40:59.472153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:59.909017 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.437 seconds
[0m19:40:59.911812 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m19:41:00.029810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e51e871-34a6-4710-a5bc-f1d34a4dd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fea1af0>]}
[0m19:41:00.030865 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:41:00.031427 [info ] [MainThread]: 
[0m19:41:00.040744 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.moving_averages
[0m19:41:00.041777 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.moving_averages .......................... [RUN]
[0m19:41:00.042721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.moving_averages)
[0m19:41:00.043336 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.moving_averages
[0m19:41:00.058432 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.moving_averages"
[0m19:41:00.059718 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.moving_averages
[0m19:41:00.107192 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.moving_averages"
[0m19:41:00.108683 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.moving_averages"
[0m19:41:00.109177 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.moving_averages"} */
create or replace   view dev.analytics.moving_averages
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
FROM base_data
ORDER BY symbol, date
  );
[0m19:41:00.109640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:00.844224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m19:41:00.874163 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: Close
[0m19:41:00.997626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e51e871-34a6-4710-a5bc-f1d34a4dd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123efc710>]}
[0m19:41:00.998726 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.moving_averages ..................... [[32mSUCCESS 1[0m in 0.95s]
[0m19:41:00.999729 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.moving_averages
[0m19:41:01.000413 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.price_momentum
[0m19:41:01.001146 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.price_momentum ........................... [RUN]
[0m19:41:01.001964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.moving_averages, now model.dbt_proj_lab2.price_momentum)
[0m19:41:01.002570 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.price_momentum
[0m19:41:01.006896 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.price_momentum"
[0m19:41:01.008150 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.price_momentum
[0m19:41:01.013604 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.price_momentum"
[0m19:41:01.015388 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.price_momentum"
[0m19:41:01.016001 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.price_momentum"} */
create or replace   view dev.analytics.price_momentum
  
   as (
    -- models/price_momentum.sql

WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    previous_close,
    close - previous_close AS price_momentum
FROM base_data
WHERE previous_close IS NOT NULL
ORDER BY symbol, date
  );
[0m19:41:01.016584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:01.867507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.851 seconds
[0m19:41:01.871271 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: Close
[0m19:41:01.988559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e51e871-34a6-4710-a5bc-f1d34a4dd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246f0f20>]}
[0m19:41:01.989656 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.price_momentum ...................... [[32mSUCCESS 1[0m in 0.99s]
[0m19:41:01.990752 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.price_momentum
[0m19:41:01.991414 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.rsi
[0m19:41:01.992122 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi ...................................... [RUN]
[0m19:41:01.992917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.price_momentum, now model.dbt_proj_lab2.rsi)
[0m19:41:01.993515 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.rsi
[0m19:41:01.998217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.rsi"
[0m19:41:01.999587 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.rsi
[0m19:41:02.003814 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.rsi"
[0m19:41:02.007636 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.rsi"
[0m19:41:02.008375 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.rsi"} */
create or replace   view dev.analytics.rsi
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

gains_and_losses AS (
    SELECT
        date,
        symbol,
        close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
)

SELECT
    date,
    symbol,
    avg_gain,
    avg_loss,
    CASE 
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM averages
ORDER BY symbol, date
  );
[0m19:41:02.008992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:02.685766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m19:41:02.689466 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: Close
[0m19:41:02.819948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e51e871-34a6-4710-a5bc-f1d34a4dd784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1247a2a50>]}
[0m19:41:02.821044 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi ................................. [[32mSUCCESS 1[0m in 0.83s]
[0m19:41:02.822099 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.rsi
[0m19:41:02.823744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:02.824218 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.rsi' was properly closed.
[0m19:41:02.824773 [info ] [MainThread]: 
[0m19:41:02.825320 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m19:41:02.826828 [debug] [MainThread]: Command end result
[0m19:41:02.864130 [info ] [MainThread]: 
[0m19:41:02.864766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:02.865341 [info ] [MainThread]: 
[0m19:41:02.866176 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:41:02.870282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.359561, "process_user_time": 4.455237, "process_kernel_time": 0.936039, "process_mem_max_rss": "181243904", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:41:02.871359 [debug] [MainThread]: Command `dbt run` succeeded at 19:41:02.871183 after 7.36 seconds
[0m19:41:02.871973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a6c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1242db530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1247c8ec0>]}
[0m19:41:02.872563 [debug] [MainThread]: Flushing usage events
[0m03:54:31.037966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c8a3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc997c58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9984f380>]}


============================== 03:54:31.052680 | 115384d5-4d4f-48ca-87e0-abeb2d08bc51 ==============================
[0m03:54:31.052680 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:31.054235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:54:32.268540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '115384d5-4d4f-48ca-87e0-abeb2d08bc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc94171b50>]}
[0m03:54:32.349891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '115384d5-4d4f-48ca-87e0-abeb2d08bc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc85ecbcb0>]}
[0m03:54:32.351267 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:32.507259 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:32.669279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:32.670364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:32.677509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m03:54:32.713085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '115384d5-4d4f-48ca-87e0-abeb2d08bc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc85cf7ad0>]}
[0m03:54:32.859351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '115384d5-4d4f-48ca-87e0-abeb2d08bc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc85a779e0>]}
[0m03:54:32.860399 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m03:54:32.861294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '115384d5-4d4f-48ca-87e0-abeb2d08bc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc85ace450>]}
[0m03:54:32.863876 [info ] [MainThread]: 
[0m03:54:32.865059 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:54:32.872286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m03:54:32.892951 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m03:54:32.894005 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m03:54:32.894809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:34.231366 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.336 seconds
[0m03:54:34.237296 [debug] [ThreadPool]: On list_dev: Close
[0m03:54:34.367345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m03:54:34.411834 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m03:54:34.415105 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m03:54:34.416473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:34.909528 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.493 seconds
[0m03:54:34.913795 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m03:54:35.042765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '115384d5-4d4f-48ca-87e0-abeb2d08bc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9abcd700>]}
[0m03:54:35.044437 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:54:35.046020 [info ] [MainThread]: 
[0m03:54:35.060602 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.moving_averages
[0m03:54:35.062398 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.moving_averages .......................... [RUN]
[0m03:54:35.064022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.moving_averages)
[0m03:54:35.065299 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.moving_averages
[0m03:54:35.079407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.moving_averages"
[0m03:54:35.082763 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.moving_averages
[0m03:54:35.130231 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.moving_averages"
[0m03:54:35.133673 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.moving_averages"
[0m03:54:35.134803 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.moving_averages"} */
create or replace   view dev.analytics.moving_averages
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
FROM base_data
ORDER BY symbol, date
  );
[0m03:54:35.135867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:35.960149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.824 seconds
[0m03:54:36.001509 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: Close
[0m03:54:36.119180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '115384d5-4d4f-48ca-87e0-abeb2d08bc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc85df1730>]}
[0m03:54:36.121080 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.moving_averages ..................... [[32mSUCCESS 1[0m in 1.05s]
[0m03:54:36.122943 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.moving_averages
[0m03:54:36.124749 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.price_momentum
[0m03:54:36.128069 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.price_momentum ........................... [RUN]
[0m03:54:36.130543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.moving_averages, now model.dbt_proj_lab2.price_momentum)
[0m03:54:36.132458 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.price_momentum
[0m03:54:36.138865 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.price_momentum"
[0m03:54:36.143137 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.price_momentum
[0m03:54:36.153731 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.price_momentum"
[0m03:54:36.158234 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.price_momentum"
[0m03:54:36.160252 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.price_momentum"} */
create or replace   view dev.analytics.price_momentum
  
   as (
    -- models/price_momentum.sql

WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    previous_close,
    close - previous_close AS price_momentum
FROM base_data
WHERE previous_close IS NOT NULL
ORDER BY symbol, date
  );
[0m03:54:36.162174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:36.867294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m03:54:36.871399 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: Close
[0m03:54:36.991835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '115384d5-4d4f-48ca-87e0-abeb2d08bc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc84e01fa0>]}
[0m03:54:36.993760 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.price_momentum ...................... [[32mSUCCESS 1[0m in 0.86s]
[0m03:54:36.995480 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.price_momentum
[0m03:54:36.996761 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.rsi
[0m03:54:36.998301 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi ...................................... [RUN]
[0m03:54:37.000017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.price_momentum, now model.dbt_proj_lab2.rsi)
[0m03:54:37.001180 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.rsi
[0m03:54:37.006271 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.rsi"
[0m03:54:37.009107 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.rsi
[0m03:54:37.013937 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.rsi"
[0m03:54:37.018468 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.rsi"
[0m03:54:37.020169 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.rsi"} */
create or replace   view dev.analytics.rsi
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

gains_and_losses AS (
    SELECT
        date,
        symbol,
        close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
)

SELECT
    date,
    symbol,
    avg_gain,
    avg_loss,
    CASE 
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM averages
ORDER BY symbol, date
  );
[0m03:54:37.021351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:37.803131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m03:54:37.808412 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: Close
[0m03:54:37.953382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '115384d5-4d4f-48ca-87e0-abeb2d08bc51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc85a02030>]}
[0m03:54:37.955380 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi ................................. [[32mSUCCESS 1[0m in 0.95s]
[0m03:54:37.956862 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.rsi
[0m03:54:37.960200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:54:37.961108 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.rsi' was properly closed.
[0m03:54:37.962030 [info ] [MainThread]: 
[0m03:54:37.962966 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m03:54:37.964789 [debug] [MainThread]: Command end result
[0m03:54:38.032183 [info ] [MainThread]: 
[0m03:54:38.033347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:54:38.034216 [info ] [MainThread]: 
[0m03:54:38.035163 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m03:54:38.036823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.11776, "process_user_time": 5.229691, "process_kernel_time": 0.680244, "process_mem_max_rss": "214324", "process_in_blocks": "2312", "process_out_blocks": "3373"}
[0m03:54:38.038484 [debug] [MainThread]: Command `dbt run` succeeded at 03:54:38.038275 after 7.12 seconds
[0m03:54:38.039558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9c8a3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc85ce06b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc9999e990>]}
[0m03:54:38.040618 [debug] [MainThread]: Flushing usage events
[0m03:54:41.966818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ca4ef740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ca56aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ca4ece30>]}


============================== 03:54:41.975114 | be3e567f-2726-4bab-8f2e-5702f42281b3 ==============================
[0m03:54:41.975114 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:41.976409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:54:43.104422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be3e567f-2726-4bab-8f2e-5702f42281b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cb458800>]}
[0m03:54:43.189051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be3e567f-2726-4bab-8f2e-5702f42281b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b2c9be90>]}
[0m03:54:43.190441 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:43.330715 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:43.467556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:43.468568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:43.475522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m03:54:43.508791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be3e567f-2726-4bab-8f2e-5702f42281b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b2b7a720>]}
[0m03:54:43.645877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be3e567f-2726-4bab-8f2e-5702f42281b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b3865d60>]}
[0m03:54:43.646947 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m03:54:43.647932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be3e567f-2726-4bab-8f2e-5702f42281b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b2927440>]}
[0m03:54:43.650269 [info ] [MainThread]: 
[0m03:54:43.651274 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:43.654330 [debug] [MainThread]: Command end result
[0m03:54:43.716072 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.8664838, "process_user_time": 3.877528, "process_kernel_time": 0.459047, "process_mem_max_rss": "205312", "process_out_blocks": "1791", "process_in_blocks": "0"}
[0m03:54:43.717432 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:54:43.717297 after 1.87 seconds
[0m03:54:43.718834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ca3ce630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c9ff8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c8b6f9e0>]}
[0m03:54:43.720566 [debug] [MainThread]: Flushing usage events
[0m03:54:48.148413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcebc00a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcebca2ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcebc449cd0>]}


============================== 03:54:48.157585 | a17cd933-d806-4e14-9523-177989032d66 ==============================
[0m03:54:48.157585 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:48.159856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m03:54:49.409764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a17cd933-d806-4e14-9523-177989032d66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb7f79b50>]}
[0m03:54:49.478458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a17cd933-d806-4e14-9523-177989032d66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea8472cf0>]}
[0m03:54:49.479934 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:49.631924 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:49.785013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:49.785990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:49.793877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m03:54:49.829920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a17cd933-d806-4e14-9523-177989032d66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea816a900>]}
[0m03:54:49.975871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a17cd933-d806-4e14-9523-177989032d66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea3d935c0>]}
[0m03:54:49.977052 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m03:54:49.978166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a17cd933-d806-4e14-9523-177989032d66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea816a000>]}
[0m03:54:49.981254 [info ] [MainThread]: 
[0m03:54:49.982389 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:49.986800 [debug] [MainThread]: Command end result
[0m03:54:50.042706 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0227885, "process_user_time": 4.146944, "process_kernel_time": 0.451279, "process_mem_max_rss": "207248", "process_out_blocks": "1791", "process_in_blocks": "0"}
[0m03:54:50.044183 [debug] [MainThread]: Command `dbt test` succeeded at 03:54:50.044006 after 2.02 seconds
[0m03:54:50.045382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcebbeb0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea3ff78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea3ff5e50>]}
[0m03:54:50.046706 [debug] [MainThread]: Flushing usage events
[0m05:08:34.607534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d03249370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d03a4b020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d06629e20>]}


============================== 05:08:34.623957 | 15511af9-193f-4011-adcc-a52cef453982 ==============================
[0m05:08:34.623957 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:08:34.625851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:08:35.999198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15511af9-193f-4011-adcc-a52cef453982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cfdf71970>]}
[0m05:08:36.087015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15511af9-193f-4011-adcc-a52cef453982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cebd38c20>]}
[0m05:08:36.088485 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:08:36.247835 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:08:36.402630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:08:36.403911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:08:36.411393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m05:08:36.448312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15511af9-193f-4011-adcc-a52cef453982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ceb9a6fc0>]}
[0m05:08:36.588480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15511af9-193f-4011-adcc-a52cef453982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ceb73a4e0>]}
[0m05:08:36.589493 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m05:08:36.590697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15511af9-193f-4011-adcc-a52cef453982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ceb93eba0>]}
[0m05:08:36.594267 [info ] [MainThread]: 
[0m05:08:36.599964 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:08:36.607622 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:08:36.632390 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:08:36.633627 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:08:36.634979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:37.269993 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.635 seconds
[0m05:08:37.273955 [debug] [ThreadPool]: On list_dev: Close
[0m05:08:37.409857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:08:37.426092 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:08:37.427328 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:08:37.428392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:08:37.997446 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.569 seconds
[0m05:08:38.001655 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:08:38.146764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15511af9-193f-4011-adcc-a52cef453982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ceba81940>]}
[0m05:08:38.148917 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:08:38.150314 [info ] [MainThread]: 
[0m05:08:38.168189 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.moving_averages
[0m05:08:38.169413 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.moving_averages .......................... [RUN]
[0m05:08:38.170480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.moving_averages)
[0m05:08:38.171372 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.moving_averages
[0m05:08:38.184553 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.moving_averages"
[0m05:08:38.189095 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.moving_averages
[0m05:08:38.239369 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.moving_averages"
[0m05:08:38.243397 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.moving_averages"
[0m05:08:38.244338 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.moving_averages"} */
create or replace   view dev.analytics.moving_averages
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
FROM base_data
ORDER BY symbol, date
  );
[0m05:08:38.245126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:39.157532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.912 seconds
[0m05:08:39.196490 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: Close
[0m05:08:39.304815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15511af9-193f-4011-adcc-a52cef453982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ceba3d730>]}
[0m05:08:39.306874 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.moving_averages ..................... [[32mSUCCESS 1[0m in 1.13s]
[0m05:08:39.308643 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.moving_averages
[0m05:08:39.310015 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.price_momentum
[0m05:08:39.311474 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.price_momentum ........................... [RUN]
[0m05:08:39.312831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.moving_averages, now model.dbt_proj_lab2.price_momentum)
[0m05:08:39.314091 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.price_momentum
[0m05:08:39.318445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.price_momentum"
[0m05:08:39.321199 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.price_momentum
[0m05:08:39.327329 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.price_momentum"
[0m05:08:39.330929 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.price_momentum"
[0m05:08:39.332268 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.price_momentum"} */
create or replace   view dev.analytics.price_momentum
  
   as (
    -- models/price_momentum.sql

WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    previous_close,
    close - previous_close AS price_momentum
FROM base_data
WHERE previous_close IS NOT NULL
ORDER BY symbol, date
  );
[0m05:08:39.333597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:40.181295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.848 seconds
[0m05:08:40.186500 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: Close
[0m05:08:40.310585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15511af9-193f-4011-adcc-a52cef453982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ceab2e4b0>]}
[0m05:08:40.312579 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.price_momentum ...................... [[32mSUCCESS 1[0m in 1.00s]
[0m05:08:40.314488 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.price_momentum
[0m05:08:40.315832 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.rsi
[0m05:08:40.317338 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi ...................................... [RUN]
[0m05:08:40.318656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.price_momentum, now model.dbt_proj_lab2.rsi)
[0m05:08:40.319748 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.rsi
[0m05:08:40.325096 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.rsi"
[0m05:08:40.328207 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.rsi
[0m05:08:40.333194 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.rsi"
[0m05:08:40.337827 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.rsi"
[0m05:08:40.339474 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.rsi"} */
create or replace   view dev.analytics.rsi
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

gains_and_losses AS (
    SELECT
        date,
        symbol,
        close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
)

SELECT
    date,
    symbol,
    avg_gain,
    avg_loss,
    CASE 
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM averages
ORDER BY symbol, date
  );
[0m05:08:40.344086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:41.614388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.270 seconds
[0m05:08:41.618916 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: Close
[0m05:08:41.727899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15511af9-193f-4011-adcc-a52cef453982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ceb5f85f0>]}
[0m05:08:41.729768 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi ................................. [[32mSUCCESS 1[0m in 1.41s]
[0m05:08:41.731519 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.rsi
[0m05:08:41.734232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:08:41.735383 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.rsi' was properly closed.
[0m05:08:41.736498 [info ] [MainThread]: 
[0m05:08:41.737678 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m05:08:41.739875 [debug] [MainThread]: Command end result
[0m05:08:41.827914 [info ] [MainThread]: 
[0m05:08:41.829195 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:08:41.830268 [info ] [MainThread]: 
[0m05:08:41.831397 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:08:41.833098 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.358422, "process_user_time": 4.946079, "process_kernel_time": 0.613083, "process_mem_max_rss": "212736", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m05:08:41.834466 [debug] [MainThread]: Command `dbt run` succeeded at 05:08:41.834287 after 7.36 seconds
[0m05:08:41.835575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d033be600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d05b369f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cf11bf470>]}
[0m05:08:41.836802 [debug] [MainThread]: Flushing usage events
[0m05:08:47.048932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f347267c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3472678290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3473099670>]}


============================== 05:08:47.058388 | c6c88601-f91f-4b7b-8221-7bbc1bf48a36 ==============================
[0m05:08:47.058388 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:08:47.060824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:08:48.383346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6c88601-f91f-4b7b-8221-7bbc1bf48a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3472f6e9c0>]}
[0m05:08:48.456852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6c88601-f91f-4b7b-8221-7bbc1bf48a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d3404a0>]}
[0m05:08:48.458516 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:08:48.616859 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:08:48.775509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:08:48.776766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:08:48.784360 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m05:08:48.822320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6c88601-f91f-4b7b-8221-7bbc1bf48a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345addc050>]}
[0m05:08:48.961275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6c88601-f91f-4b7b-8221-7bbc1bf48a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345ab75d90>]}
[0m05:08:48.962435 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m05:08:48.963396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c88601-f91f-4b7b-8221-7bbc1bf48a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345b4bfc80>]}
[0m05:08:48.965777 [info ] [MainThread]: 
[0m05:08:48.966939 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:08:48.969963 [debug] [MainThread]: Command end result
[0m05:08:49.025385 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.1058903, "process_user_time": 4.449618, "process_kernel_time": 0.482159, "process_mem_max_rss": "205072", "process_out_blocks": "1791", "process_in_blocks": "0"}
[0m05:08:49.026442 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:08:49.026308 after 2.11 seconds
[0m05:08:49.027334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34728d5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34727a0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f346d32b0e0>]}
[0m05:08:49.028368 [debug] [MainThread]: Flushing usage events
[0m05:08:53.152708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b3cd2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b3e426c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b3fa0fe0>]}


============================== 05:08:53.162550 | d2e68257-52c2-45ec-a02a-0e0959bc4409 ==============================
[0m05:08:53.162550 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:08:53.163955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:08:54.341046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc77d3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc7662e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc88f8740>]}


============================== 05:08:54.351082 | 95b0762c-2c4b-4ac9-9902-58871c904618 ==============================
[0m05:08:54.351082 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:08:54.352332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:08:54.595453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2e68257-52c2-45ec-a02a-0e0959bc4409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b3928530>]}
[0m05:08:54.707712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2e68257-52c2-45ec-a02a-0e0959bc4409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b4662ba0>]}
[0m05:08:54.710019 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:08:54.892831 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:08:55.076626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:08:55.077865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:08:55.085482 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m05:08:55.123502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2e68257-52c2-45ec-a02a-0e0959bc4409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a0683f80>]}
[0m05:08:55.272106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2e68257-52c2-45ec-a02a-0e0959bc4409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a04652b0>]}
[0m05:08:55.273232 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m05:08:55.274372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e68257-52c2-45ec-a02a-0e0959bc4409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b4d43c80>]}
[0m05:08:55.277412 [info ] [MainThread]: 
[0m05:08:55.278803 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:08:55.286104 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:08:55.312240 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:08:55.313325 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:08:55.314527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:55.749875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95b0762c-2c4b-4ac9-9902-58871c904618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cafe4acc0>]}
[0m05:08:55.821589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95b0762c-2c4b-4ac9-9902-58871c904618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cafe4a240>]}
[0m05:08:55.822924 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:08:55.884636 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.570 seconds
[0m05:08:55.888459 [debug] [ThreadPool]: On list_dev: Close
[0m05:08:55.981232 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:08:56.010337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m05:08:56.026338 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:08:56.027417 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:08:56.028342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:56.152468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:08:56.155641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:08:56.163709 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m05:08:56.203493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95b0762c-2c4b-4ac9-9902-58871c904618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc74c68d0>]}
[0m05:08:56.383605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95b0762c-2c4b-4ac9-9902-58871c904618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0caf6ee990>]}
[0m05:08:56.384964 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m05:08:56.386152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95b0762c-2c4b-4ac9-9902-58871c904618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc21cdbb0>]}
[0m05:08:56.389644 [info ] [MainThread]: 
[0m05:08:56.391370 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:08:56.395329 [debug] [MainThread]: Command end result
[0m05:08:56.458830 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.250592, "process_user_time": 4.414075, "process_kernel_time": 0.605991, "process_mem_max_rss": "207316", "process_out_blocks": "1791", "process_in_blocks": "0"}
[0m05:08:56.460378 [debug] [MainThread]: Command `dbt test` succeeded at 05:08:56.460198 after 2.25 seconds
[0m05:08:56.461735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc7d952e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cb4df27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc76807d0>]}
[0m05:08:56.463494 [debug] [MainThread]: Flushing usage events
[0m05:08:56.560303 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.532 seconds
[0m05:08:56.563415 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:08:57.063388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e68257-52c2-45ec-a02a-0e0959bc4409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a060ef90>]}
[0m05:08:57.064833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:08:57.066275 [info ] [MainThread]: 
[0m05:08:57.081522 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.moving_averages
[0m05:08:57.083038 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.moving_averages .......................... [RUN]
[0m05:08:57.085280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.moving_averages)
[0m05:08:57.086627 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.moving_averages
[0m05:08:57.101085 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.moving_averages"
[0m05:08:57.103955 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.moving_averages
[0m05:08:57.160065 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.moving_averages"
[0m05:08:57.163829 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.moving_averages"
[0m05:08:57.165339 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.moving_averages"} */
create or replace   view dev.analytics.moving_averages
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
FROM base_data
ORDER BY symbol, date
  );
[0m05:08:57.166719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:58.003355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.837 seconds
[0m05:08:58.069725 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: Close
[0m05:08:58.222984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2e68257-52c2-45ec-a02a-0e0959bc4409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a05a4f20>]}
[0m05:08:58.224499 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.moving_averages ..................... [[32mSUCCESS 1[0m in 1.14s]
[0m05:08:58.225863 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.moving_averages
[0m05:08:58.226973 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.price_momentum
[0m05:08:58.228387 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.price_momentum ........................... [RUN]
[0m05:08:58.229462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.moving_averages, now model.dbt_proj_lab2.price_momentum)
[0m05:08:58.230432 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.price_momentum
[0m05:08:58.234471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.price_momentum"
[0m05:08:58.236999 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.price_momentum
[0m05:08:58.243222 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.price_momentum"
[0m05:08:58.246627 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.price_momentum"
[0m05:08:58.248222 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.price_momentum"} */
create or replace   view dev.analytics.price_momentum
  
   as (
    -- models/price_momentum.sql

WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    previous_close,
    close - previous_close AS price_momentum
FROM base_data
WHERE previous_close IS NOT NULL
ORDER BY symbol, date
  );
[0m05:08:58.249357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:58.751776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516d725b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516c910920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516d725820>]}


============================== 05:08:58.761458 | 5e0f6675-95b5-4c50-9175-d0c298bfcd54 ==============================
[0m05:08:58.761458 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:08:58.762802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:08:59.226477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.977 seconds
[0m05:08:59.230716 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: Close
[0m05:08:59.339041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2e68257-52c2-45ec-a02a-0e0959bc4409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f829b54e1e0>]}
[0m05:08:59.340707 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.price_momentum ...................... [[32mSUCCESS 1[0m in 1.11s]
[0m05:08:59.342430 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.price_momentum
[0m05:08:59.343633 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.rsi
[0m05:08:59.344794 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi ...................................... [RUN]
[0m05:08:59.346221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.price_momentum, now model.dbt_proj_lab2.rsi)
[0m05:08:59.347273 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.rsi
[0m05:08:59.351591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.rsi"
[0m05:08:59.353915 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.rsi
[0m05:08:59.358387 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.rsi"
[0m05:08:59.362794 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.rsi"
[0m05:08:59.364572 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.rsi"} */
create or replace   view dev.analytics.rsi
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

gains_and_losses AS (
    SELECT
        date,
        symbol,
        close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
)

SELECT
    date,
    symbol,
    avg_gain,
    avg_loss,
    CASE 
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM averages
ORDER BY symbol, date
  );
[0m05:08:59.366739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:59.966900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e0f6675-95b5-4c50-9175-d0c298bfcd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5158ef1370>]}
[0m05:09:00.038592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e0f6675-95b5-4c50-9175-d0c298bfcd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5159b0e810>]}
[0m05:09:00.040528 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:09:00.117342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m05:09:00.122625 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: Close
[0m05:09:00.189776 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:09:00.235031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2e68257-52c2-45ec-a02a-0e0959bc4409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f829bf0ba70>]}
[0m05:09:00.238222 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi ................................. [[32mSUCCESS 1[0m in 0.89s]
[0m05:09:00.239597 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.rsi
[0m05:09:00.243683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:09:00.347394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:00.348814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:00.357962 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m05:09:00.409326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e0f6675-95b5-4c50-9175-d0c298bfcd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515f6d8ef0>]}
[0m05:09:00.655470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e0f6675-95b5-4c50-9175-d0c298bfcd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5158d76000>]}
[0m05:09:00.657910 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m05:09:00.660085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e0f6675-95b5-4c50-9175-d0c298bfcd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5168b6ddc0>]}
[0m05:09:00.671793 [info ] [MainThread]: 
[0m05:09:00.676191 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:09:00.696116 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:09:00.773388 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:09:00.778428 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:09:00.779685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:01.331681 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.552 seconds
[0m05:09:01.335692 [debug] [ThreadPool]: On list_dev: Close
[0m05:09:01.490206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:09:01.506539 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:09:01.507765 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:09:01.508921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:09:02.062671 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.554 seconds
[0m05:09:02.066318 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:09:02.174566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e0f6675-95b5-4c50-9175-d0c298bfcd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5159145580>]}
[0m05:09:02.176356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:09:02.177744 [info ] [MainThread]: 
[0m05:09:02.191323 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.moving_averages
[0m05:09:02.192730 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.moving_averages .......................... [RUN]
[0m05:09:02.194230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.moving_averages)
[0m05:09:02.195372 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.moving_averages
[0m05:09:02.207520 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.moving_averages"
[0m05:09:02.210225 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.moving_averages
[0m05:09:02.252333 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.moving_averages"
[0m05:09:02.255587 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.moving_averages"
[0m05:09:02.256602 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.moving_averages"} */
create or replace   view dev.analytics.moving_averages
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
FROM base_data
ORDER BY symbol, date
  );
[0m05:09:02.257574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:02.918096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m05:09:02.969392 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: Close
[0m05:09:03.092512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0f6675-95b5-4c50-9175-d0c298bfcd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516d092930>]}
[0m05:09:03.094447 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.moving_averages ..................... [[32mSUCCESS 1[0m in 0.90s]
[0m05:09:03.096479 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.moving_averages
[0m05:09:03.098151 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.price_momentum
[0m05:09:03.099586 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.price_momentum ........................... [RUN]
[0m05:09:03.101421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.moving_averages, now model.dbt_proj_lab2.price_momentum)
[0m05:09:03.102605 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.price_momentum
[0m05:09:03.107737 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.price_momentum"
[0m05:09:03.111049 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.price_momentum
[0m05:09:03.118877 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.price_momentum"
[0m05:09:03.125067 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.price_momentum"
[0m05:09:03.126653 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.price_momentum"} */
create or replace   view dev.analytics.price_momentum
  
   as (
    -- models/price_momentum.sql

WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    previous_close,
    close - previous_close AS price_momentum
FROM base_data
WHERE previous_close IS NOT NULL
ORDER BY symbol, date
  );
[0m05:09:03.128446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:03.937782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.809 seconds
[0m05:09:03.942641 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: Close
[0m05:09:04.057909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0f6675-95b5-4c50-9175-d0c298bfcd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515816d730>]}
[0m05:09:04.060334 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.price_momentum ...................... [[32mSUCCESS 1[0m in 0.96s]
[0m05:09:04.062446 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.price_momentum
[0m05:09:04.063637 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.rsi
[0m05:09:04.064945 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi ...................................... [RUN]
[0m05:09:04.066422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.price_momentum, now model.dbt_proj_lab2.rsi)
[0m05:09:04.067772 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.rsi
[0m05:09:04.072652 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.rsi"
[0m05:09:04.077282 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.rsi
[0m05:09:04.081788 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.rsi"
[0m05:09:04.088039 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.rsi"
[0m05:09:04.089845 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.rsi"} */
create or replace   view dev.analytics.rsi
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

gains_and_losses AS (
    SELECT
        date,
        symbol,
        close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
)

SELECT
    date,
    symbol,
    avg_gain,
    avg_loss,
    CASE 
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM averages
ORDER BY symbol, date
  );
[0m05:09:04.093771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:04.750702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m05:09:04.754592 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: Close
[0m05:09:04.881384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0f6675-95b5-4c50-9175-d0c298bfcd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515816daf0>]}
[0m05:09:04.906568 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi ................................. [[32mSUCCESS 1[0m in 0.81s]
[0m05:09:04.908432 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.rsi
[0m05:09:04.912441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:09:04.913542 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.rsi' was properly closed.
[0m05:09:04.914965 [info ] [MainThread]: 
[0m05:09:04.920684 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m05:09:04.923095 [debug] [MainThread]: Command end result
[0m05:09:04.982233 [info ] [MainThread]: 
[0m05:09:04.984208 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:09:04.986170 [info ] [MainThread]: 
[0m05:09:04.987409 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:09:04.989357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3692365, "process_user_time": 5.563544, "process_kernel_time": 0.66145, "process_mem_max_rss": "212624", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m05:09:04.990550 [debug] [MainThread]: Command `dbt run` succeeded at 05:09:04.990408 after 6.37 seconds
[0m05:09:04.991647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516d57dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516d022330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516d023b60>]}
[0m05:09:04.993109 [debug] [MainThread]: Flushing usage events
[0m05:09:07.040523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018da628a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018d8f25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018e29e510>]}


============================== 05:09:07.052287 | 83f58ba7-f233-4ef1-9793-de9bc5c3b613 ==============================
[0m05:09:07.052287 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:09:07.054148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m05:09:08.627749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83f58ba7-f233-4ef1-9793-de9bc5c3b613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018e9678f0>]}
[0m05:09:08.696327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83f58ba7-f233-4ef1-9793-de9bc5c3b613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017a19d430>]}
[0m05:09:08.697713 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:09:08.849950 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:09:09.030396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:09.032106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:09.040213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m05:09:09.084498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83f58ba7-f233-4ef1-9793-de9bc5c3b613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017a0893d0>]}
[0m05:09:09.236922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83f58ba7-f233-4ef1-9793-de9bc5c3b613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0179d8e570>]}
[0m05:09:09.238168 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m05:09:09.239653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83f58ba7-f233-4ef1-9793-de9bc5c3b613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017a08b5c0>]}
[0m05:09:09.242759 [info ] [MainThread]: 
[0m05:09:09.245718 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:09:09.253485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:09:09.281993 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:09:09.283892 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:09:09.285522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:09.887113 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.602 seconds
[0m05:09:09.890425 [debug] [ThreadPool]: On list_dev: Close
[0m05:09:10.029467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:09:10.044198 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:09:10.045154 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:09:10.045894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:09:10.597223 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.551 seconds
[0m05:09:10.601366 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:09:10.733950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83f58ba7-f233-4ef1-9793-de9bc5c3b613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017a26dd00>]}
[0m05:09:10.735662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:09:10.737016 [info ] [MainThread]: 
[0m05:09:10.750334 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.moving_averages
[0m05:09:10.751663 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.moving_averages .......................... [RUN]
[0m05:09:10.753133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.moving_averages)
[0m05:09:10.754339 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.moving_averages
[0m05:09:10.766509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.moving_averages"
[0m05:09:10.768555 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.moving_averages
[0m05:09:10.817675 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.moving_averages"
[0m05:09:10.821489 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.moving_averages"
[0m05:09:10.822788 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.moving_averages"} */
create or replace   view dev.analytics.moving_averages
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
FROM base_data
ORDER BY symbol, date
  );
[0m05:09:10.823861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:11.515060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m05:09:11.558999 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: Close
[0m05:09:11.718272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f58ba7-f233-4ef1-9793-de9bc5c3b613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017a19d520>]}
[0m05:09:11.720324 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.moving_averages ..................... [[32mSUCCESS 1[0m in 0.96s]
[0m05:09:11.722236 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.moving_averages
[0m05:09:11.723639 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.price_momentum
[0m05:09:11.725232 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.price_momentum ........................... [RUN]
[0m05:09:11.726583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.moving_averages, now model.dbt_proj_lab2.price_momentum)
[0m05:09:11.727861 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.price_momentum
[0m05:09:11.732818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.price_momentum"
[0m05:09:11.735888 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.price_momentum
[0m05:09:11.742857 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.price_momentum"
[0m05:09:11.747437 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.price_momentum"
[0m05:09:11.748713 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.price_momentum"} */
create or replace   view dev.analytics.price_momentum
  
   as (
    -- models/price_momentum.sql

WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    previous_close,
    close - previous_close AS price_momentum
FROM base_data
WHERE previous_close IS NOT NULL
ORDER BY symbol, date
  );
[0m05:09:11.750029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:12.543249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m05:09:12.548829 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: Close
[0m05:09:12.680904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f58ba7-f233-4ef1-9793-de9bc5c3b613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0179b2cfb0>]}
[0m05:09:12.682746 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.price_momentum ...................... [[32mSUCCESS 1[0m in 0.95s]
[0m05:09:12.686587 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.price_momentum
[0m05:09:12.688517 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.rsi
[0m05:09:12.691412 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi ...................................... [RUN]
[0m05:09:12.694233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.price_momentum, now model.dbt_proj_lab2.rsi)
[0m05:09:12.696713 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.rsi
[0m05:09:12.703779 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.rsi"
[0m05:09:12.707154 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.rsi
[0m05:09:12.715574 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.rsi"
[0m05:09:12.723630 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.rsi"
[0m05:09:12.725840 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.rsi"} */
create or replace   view dev.analytics.rsi
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

gains_and_losses AS (
    SELECT
        date,
        symbol,
        close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
)

SELECT
    date,
    symbol,
    avg_gain,
    avg_loss,
    CASE 
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM averages
ORDER BY symbol, date
  );
[0m05:09:12.728007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:13.562644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.835 seconds
[0m05:09:13.566748 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: Close
[0m05:09:13.706520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83f58ba7-f233-4ef1-9793-de9bc5c3b613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f017a0687d0>]}
[0m05:09:13.708153 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi ................................. [[32mSUCCESS 1[0m in 1.01s]
[0m05:09:13.709967 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.rsi
[0m05:09:13.712932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:09:13.713941 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.rsi' was properly closed.
[0m05:09:13.715136 [info ] [MainThread]: 
[0m05:09:13.716117 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m05:09:13.717837 [debug] [MainThread]: Command end result
[0m05:09:13.781423 [info ] [MainThread]: 
[0m05:09:13.782862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:09:13.784031 [info ] [MainThread]: 
[0m05:09:13.785088 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:09:13.786708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9020524, "process_user_time": 5.31407, "process_kernel_time": 0.553315, "process_mem_max_rss": "212772", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m05:09:13.788150 [debug] [MainThread]: Command `dbt run` succeeded at 05:09:13.787994 after 6.90 seconds
[0m05:09:13.789107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018d8f25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018de1ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f018de1b620>]}
[0m05:09:13.790072 [debug] [MainThread]: Flushing usage events
[0m05:09:16.111559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93003d1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9300bbda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f930127c500>]}


============================== 05:09:16.120760 | 133a2653-6bdc-4fe4-97a6-1f1a5b93a748 ==============================
[0m05:09:16.120760 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:09:16.122235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:09:17.648612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '133a2653-6bdc-4fe4-97a6-1f1a5b93a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec614950>]}
[0m05:09:17.730581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '133a2653-6bdc-4fe4-97a6-1f1a5b93a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec912e40>]}
[0m05:09:17.732105 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:09:17.924484 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:09:18.145024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:18.146264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:18.153868 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m05:09:18.190679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '133a2653-6bdc-4fe4-97a6-1f1a5b93a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec69aba0>]}
[0m05:09:18.354544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '133a2653-6bdc-4fe4-97a6-1f1a5b93a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec67e8a0>]}
[0m05:09:18.356408 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m05:09:18.358484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '133a2653-6bdc-4fe4-97a6-1f1a5b93a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec659550>]}
[0m05:09:18.365265 [info ] [MainThread]: 
[0m05:09:18.367635 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:09:18.377602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:09:18.406807 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:09:18.408471 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:09:18.409813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:18.950740 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.541 seconds
[0m05:09:18.954545 [debug] [ThreadPool]: On list_dev: Close
[0m05:09:19.099362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:09:19.117713 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:09:19.119159 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:09:19.120302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:09:19.656669 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.536 seconds
[0m05:09:19.662384 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:09:19.804660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '133a2653-6bdc-4fe4-97a6-1f1a5b93a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec659550>]}
[0m05:09:19.807770 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:09:19.810174 [info ] [MainThread]: 
[0m05:09:19.826737 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.moving_averages
[0m05:09:19.828399 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.moving_averages .......................... [RUN]
[0m05:09:19.830314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.moving_averages)
[0m05:09:19.831556 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.moving_averages
[0m05:09:19.844620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.moving_averages"
[0m05:09:19.853279 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.moving_averages
[0m05:09:19.898324 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.moving_averages"
[0m05:09:19.901473 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.moving_averages"
[0m05:09:19.902481 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.moving_averages"} */
create or replace   view dev.analytics.moving_averages
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
FROM base_data
ORDER BY symbol, date
  );
[0m05:09:19.903476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:20.484433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m05:09:20.525186 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: Close
[0m05:09:20.655223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '133a2653-6bdc-4fe4-97a6-1f1a5b93a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec79d190>]}
[0m05:09:20.657382 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.moving_averages ..................... [[32mSUCCESS 1[0m in 0.82s]
[0m05:09:20.659852 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.moving_averages
[0m05:09:20.663392 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.price_momentum
[0m05:09:20.665432 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.price_momentum ........................... [RUN]
[0m05:09:20.667423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.moving_averages, now model.dbt_proj_lab2.price_momentum)
[0m05:09:20.668703 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.price_momentum
[0m05:09:20.674798 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.price_momentum"
[0m05:09:20.679314 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.price_momentum
[0m05:09:20.688586 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.price_momentum"
[0m05:09:20.695069 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.price_momentum"
[0m05:09:20.697232 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.price_momentum"} */
create or replace   view dev.analytics.price_momentum
  
   as (
    -- models/price_momentum.sql

WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    previous_close,
    close - previous_close AS price_momentum
FROM base_data
WHERE previous_close IS NOT NULL
ORDER BY symbol, date
  );
[0m05:09:20.699379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:21.551318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.852 seconds
[0m05:09:21.555333 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: Close
[0m05:09:21.692296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '133a2653-6bdc-4fe4-97a6-1f1a5b93a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec11e5a0>]}
[0m05:09:21.693938 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.price_momentum ...................... [[32mSUCCESS 1[0m in 1.02s]
[0m05:09:21.696244 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.price_momentum
[0m05:09:21.697402 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.rsi
[0m05:09:21.698917 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi ...................................... [RUN]
[0m05:09:21.700603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.price_momentum, now model.dbt_proj_lab2.rsi)
[0m05:09:21.701595 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.rsi
[0m05:09:21.706262 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.rsi"
[0m05:09:21.708913 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.rsi
[0m05:09:21.713509 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.rsi"
[0m05:09:21.717834 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.rsi"
[0m05:09:21.719308 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.rsi"} */
create or replace   view dev.analytics.rsi
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

gains_and_losses AS (
    SELECT
        date,
        symbol,
        close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
)

SELECT
    date,
    symbol,
    avg_gain,
    avg_loss,
    CASE 
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM averages
ORDER BY symbol, date
  );
[0m05:09:21.720935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:22.574498 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m05:09:22.578986 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: Close
[0m05:09:22.723676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '133a2653-6bdc-4fe4-97a6-1f1a5b93a748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec1445f0>]}
[0m05:09:22.725666 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi ................................. [[32mSUCCESS 1[0m in 1.02s]
[0m05:09:22.732666 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.rsi
[0m05:09:22.735634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:09:22.736578 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.rsi' was properly closed.
[0m05:09:22.737790 [info ] [MainThread]: 
[0m05:09:22.739607 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m05:09:22.741933 [debug] [MainThread]: Command end result
[0m05:09:22.810203 [info ] [MainThread]: 
[0m05:09:22.812146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:09:22.813561 [info ] [MainThread]: 
[0m05:09:22.814666 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:09:22.816543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.831796, "process_user_time": 5.234482, "process_kernel_time": 0.609881, "process_mem_max_rss": "212656", "process_out_blocks": "1837", "process_in_blocks": "0"}
[0m05:09:22.817687 [debug] [MainThread]: Command `dbt run` succeeded at 05:09:22.817534 after 6.83 seconds
[0m05:09:22.818800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93019b0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec5c43e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ec830c80>]}
[0m05:09:22.820891 [debug] [MainThread]: Flushing usage events
[0m05:09:24.722338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb87484800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb84c0bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8542bfb0>]}


============================== 05:09:24.737508 | eac6a58a-cd43-4357-bd2c-735a1e905554 ==============================
[0m05:09:24.737508 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:09:24.739327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:09:26.331162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eac6a58a-cd43-4357-bd2c-735a1e905554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb711d27b0>]}
[0m05:09:26.420535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eac6a58a-cd43-4357-bd2c-735a1e905554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb71197ad0>]}
[0m05:09:26.422524 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:09:26.635887 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:09:26.789529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:26.790537 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:26.797944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m05:09:26.840247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eac6a58a-cd43-4357-bd2c-735a1e905554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7f589b20>]}
[0m05:09:26.976159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eac6a58a-cd43-4357-bd2c-735a1e905554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb70d84890>]}
[0m05:09:26.977171 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m05:09:26.978395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eac6a58a-cd43-4357-bd2c-735a1e905554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb70e1fb30>]}
[0m05:09:26.981081 [info ] [MainThread]: 
[0m05:09:26.982870 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:09:26.990324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:09:27.011721 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:09:27.013052 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:09:27.013885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:09:27.458631 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.445 seconds
[0m05:09:27.461905 [debug] [ThreadPool]: On list_dev: Close
[0m05:09:27.581710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:09:27.596323 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:09:27.597205 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:09:27.597943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:09:28.062340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff1d5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff031a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff1d6ea0>]}


============================== 05:09:28.079436 | bc66736d-840f-4012-9b80-cc013dc70994 ==============================
[0m05:09:28.079436 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:09:28.081582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:09:28.110005 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.512 seconds
[0m05:09:28.113745 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:09:28.226187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eac6a58a-cd43-4357-bd2c-735a1e905554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb70d81130>]}
[0m05:09:28.228882 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:09:28.231438 [info ] [MainThread]: 
[0m05:09:28.269500 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.moving_averages
[0m05:09:28.271875 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.moving_averages .......................... [RUN]
[0m05:09:28.273850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.moving_averages)
[0m05:09:28.277847 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.moving_averages
[0m05:09:28.302434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.moving_averages"
[0m05:09:28.304667 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.moving_averages
[0m05:09:28.352542 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.moving_averages"
[0m05:09:28.355774 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.moving_averages"
[0m05:09:28.357024 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.moving_averages"} */
create or replace   view dev.analytics.moving_averages
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
FROM base_data
ORDER BY symbol, date
  );
[0m05:09:28.358033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:29.128557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m05:09:29.166875 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: Close
[0m05:09:29.299493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eac6a58a-cd43-4357-bd2c-735a1e905554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb711951f0>]}
[0m05:09:29.302325 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.moving_averages ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m05:09:29.304518 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.moving_averages
[0m05:09:29.306299 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.price_momentum
[0m05:09:29.309973 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.price_momentum ........................... [RUN]
[0m05:09:29.313586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.moving_averages, now model.dbt_proj_lab2.price_momentum)
[0m05:09:29.315504 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.price_momentum
[0m05:09:29.321486 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.price_momentum"
[0m05:09:29.326575 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.price_momentum
[0m05:09:29.344308 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.price_momentum"
[0m05:09:29.349698 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.price_momentum"
[0m05:09:29.351956 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.price_momentum"} */
create or replace   view dev.analytics.price_momentum
  
   as (
    -- models/price_momentum.sql

WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    previous_close,
    close - previous_close AS price_momentum
FROM base_data
WHERE previous_close IS NOT NULL
ORDER BY symbol, date
  );
[0m05:09:29.353482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:29.411862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc66736d-840f-4012-9b80-cc013dc70994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fe54dc70>]}
[0m05:09:29.528110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc66736d-840f-4012-9b80-cc013dc70994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fad5fd70>]}
[0m05:09:29.529441 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:09:29.683388 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:09:29.820445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:29.821519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:29.830349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m05:09:29.870893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc66736d-840f-4012-9b80-cc013dc70994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e70f8650>]}
[0m05:09:30.006465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc66736d-840f-4012-9b80-cc013dc70994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e6c08740>]}
[0m05:09:30.007616 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m05:09:30.009035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc66736d-840f-4012-9b80-cc013dc70994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e70d6c90>]}
[0m05:09:30.011549 [info ] [MainThread]: 
[0m05:09:30.013181 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:09:30.016565 [debug] [MainThread]: Command end result
[0m05:09:30.072595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m05:09:30.078571 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.1598363, "process_user_time": 4.549422, "process_kernel_time": 0.497891, "process_mem_max_rss": "204864", "process_out_blocks": "1791", "process_in_blocks": "0"}
[0m05:09:30.079765 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: Close
[0m05:09:30.080387 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:09:30.080198 after 2.16 seconds
[0m05:09:30.081456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ff031a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7febc3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e703a000>]}
[0m05:09:30.082659 [debug] [MainThread]: Flushing usage events
[0m05:09:30.210525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eac6a58a-cd43-4357-bd2c-735a1e905554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb70b0a150>]}
[0m05:09:30.212365 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.price_momentum ...................... [[32mSUCCESS 1[0m in 0.90s]
[0m05:09:30.213976 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.price_momentum
[0m05:09:30.215389 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.rsi
[0m05:09:30.217406 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi ...................................... [RUN]
[0m05:09:30.218992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.price_momentum, now model.dbt_proj_lab2.rsi)
[0m05:09:30.220156 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.rsi
[0m05:09:30.225752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.rsi"
[0m05:09:30.228957 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.rsi
[0m05:09:30.234974 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.rsi"
[0m05:09:30.240818 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.rsi"
[0m05:09:30.243167 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.rsi"} */
create or replace   view dev.analytics.rsi
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

gains_and_losses AS (
    SELECT
        date,
        symbol,
        close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
)

SELECT
    date,
    symbol,
    avg_gain,
    avg_loss,
    CASE 
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM averages
ORDER BY symbol, date
  );
[0m05:09:30.244867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:09:30.963438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.718 seconds
[0m05:09:30.971555 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: Close
[0m05:09:31.111957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eac6a58a-cd43-4357-bd2c-735a1e905554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb70ad7140>]}
[0m05:09:31.113750 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi ................................. [[32mSUCCESS 1[0m in 0.89s]
[0m05:09:31.116120 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.rsi
[0m05:09:31.119280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:09:31.120470 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.rsi' was properly closed.
[0m05:09:31.121650 [info ] [MainThread]: 
[0m05:09:31.122896 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.14 seconds (4.14s).
[0m05:09:31.125459 [debug] [MainThread]: Command end result
[0m05:09:31.201664 [info ] [MainThread]: 
[0m05:09:31.203100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:09:31.205198 [info ] [MainThread]: 
[0m05:09:31.206777 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:09:31.209242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7379227, "process_user_time": 5.739837, "process_kernel_time": 0.575209, "process_mem_max_rss": "212876", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m05:09:31.210804 [debug] [MainThread]: Command `dbt run` succeeded at 05:09:31.210588 after 6.74 seconds
[0m05:09:31.212483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb87484800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb871ae630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb70d57140>]}
[0m05:09:31.214279 [debug] [MainThread]: Flushing usage events
[0m05:09:34.995624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ac2127b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5a98965d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5acc0baa0>]}


============================== 05:09:35.003799 | 0b4675f5-6e98-4041-b609-bd2c0f317218 ==============================
[0m05:09:35.003799 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:09:35.005527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m05:09:36.251647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b4675f5-6e98-4041-b609-bd2c0f317218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5967e1e80>]}
[0m05:09:36.327236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b4675f5-6e98-4041-b609-bd2c0f317218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5aae8c320>]}
[0m05:09:36.328908 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:09:36.486622 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:09:36.661450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:36.662449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:36.670702 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m05:09:36.711029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b4675f5-6e98-4041-b609-bd2c0f317218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc596201b20>]}
[0m05:09:36.846827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ab087f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ac7d8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ab1a7920>]}


============================== 05:09:36.855774 | 27e71603-89b5-4334-b7c8-aad85bbe3841 ==============================
[0m05:09:36.855774 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:09:36.857234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:09:36.875571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b4675f5-6e98-4041-b609-bd2c0f317218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc595af2f60>]}
[0m05:09:36.877225 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m05:09:36.879006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b4675f5-6e98-4041-b609-bd2c0f317218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5977d34d0>]}
[0m05:09:36.881606 [info ] [MainThread]: 
[0m05:09:36.882697 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:09:36.885871 [debug] [MainThread]: Command end result
[0m05:09:36.940749 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0693398, "process_user_time": 4.636464, "process_kernel_time": 0.48789, "process_mem_max_rss": "207176", "process_out_blocks": "1791", "process_in_blocks": "0"}
[0m05:09:36.942350 [debug] [MainThread]: Command `dbt test` succeeded at 05:09:36.942176 after 2.07 seconds
[0m05:09:36.943747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5ac2127b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5aa11e720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59615dd60>]}
[0m05:09:36.945358 [debug] [MainThread]: Flushing usage events
[0m05:09:38.166776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27e71603-89b5-4334-b7c8-aad85bbe3841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2aacacb00>]}
[0m05:09:38.237200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27e71603-89b5-4334-b7c8-aad85bbe3841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa293db48f0>]}
[0m05:09:38.238687 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:09:38.386505 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:09:38.530331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:38.531292 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:38.538697 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m05:09:38.575927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27e71603-89b5-4334-b7c8-aad85bbe3841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2937aa510>]}
[0m05:09:38.726379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27e71603-89b5-4334-b7c8-aad85bbe3841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa293538ad0>]}
[0m05:09:38.728147 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m05:09:38.729194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e71603-89b5-4334-b7c8-aad85bbe3841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2981dfc80>]}
[0m05:09:38.731723 [info ] [MainThread]: 
[0m05:09:38.733916 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:09:38.738391 [debug] [MainThread]: Command end result
[0m05:09:38.806938 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.0793676, "process_user_time": 4.578585, "process_kernel_time": 0.48132, "process_mem_max_rss": "205180", "process_out_blocks": "1791", "process_in_blocks": "0"}
[0m05:09:38.808619 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:09:38.808406 after 2.08 seconds
[0m05:09:38.810471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ab16c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2ab0c9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2aecd6fc0>]}
[0m05:09:38.811811 [debug] [MainThread]: Flushing usage events
[0m05:09:43.608681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402361a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4023619f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402432f8f0>]}


============================== 05:09:43.618528 | 578caa41-0aea-4a9f-8142-2af230785e45 ==============================
[0m05:09:43.618528 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:09:43.620265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m05:09:45.115889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '578caa41-0aea-4a9f-8142-2af230785e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4012259b50>]}
[0m05:09:45.222233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '578caa41-0aea-4a9f-8142-2af230785e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f400bf5b710>]}
[0m05:09:45.223690 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:09:45.419705 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:09:45.558841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:09:45.559846 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:09:45.566831 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m05:09:45.606862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '578caa41-0aea-4a9f-8142-2af230785e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f400bd38080>]}
[0m05:09:45.764214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '578caa41-0aea-4a9f-8142-2af230785e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f400b7ea8d0>]}
[0m05:09:45.765374 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m05:09:45.766417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '578caa41-0aea-4a9f-8142-2af230785e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f400ba473e0>]}
[0m05:09:45.769725 [info ] [MainThread]: 
[0m05:09:45.770841 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:09:45.774094 [debug] [MainThread]: Command end result
[0m05:09:45.836777 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.3596816, "process_user_time": 4.754165, "process_kernel_time": 0.536351, "process_mem_max_rss": "207340", "process_out_blocks": "1791", "process_in_blocks": "0"}
[0m05:09:45.838616 [debug] [MainThread]: Command `dbt test` succeeded at 05:09:45.838379 after 2.36 seconds
[0m05:09:45.840266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f402366bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4027267050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4023e787a0>]}
[0m05:09:45.842451 [debug] [MainThread]: Flushing usage events
[0m02:08:44.459932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5a6c0>]}


============================== 02:08:44.467179 | 6355ce71-630e-4c27-9800-25d2783f7300 ==============================
[0m02:08:44.467179 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:08:44.468090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:08:46.743868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6355ce71-630e-4c27-9800-25d2783f7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168755b0>]}
[0m02:08:46.811637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6355ce71-630e-4c27-9800-25d2783f7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11748cc50>]}
[0m02:08:46.814766 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:08:46.840689 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:08:47.071777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:08:47.072290 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:08:47.079215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m02:08:47.119243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6355ce71-630e-4c27-9800-25d2783f7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1178f8c20>]}
[0m02:08:47.248163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6355ce71-630e-4c27-9800-25d2783f7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ba4ec0>]}
[0m02:08:47.248845 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m02:08:47.249352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6355ce71-630e-4c27-9800-25d2783f7300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11797e960>]}
[0m02:08:47.251511 [info ] [MainThread]: 
[0m02:08:47.251987 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:08:47.254131 [debug] [MainThread]: Command end result
[0m02:08:47.295010 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.919108, "process_user_time": 3.665418, "process_kernel_time": 0.889835, "process_mem_max_rss": "170041344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:08:47.295873 [debug] [MainThread]: Command `dbt snapshot` succeeded at 02:08:47.295731 after 2.92 seconds
[0m02:08:47.296407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f4320>]}
[0m02:08:47.296861 [debug] [MainThread]: Flushing usage events
[0m02:09:01.847568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551aab0>]}


============================== 02:09:01.852550 | 6fbc5721-f1b9-410e-9d2c-462fea62d107 ==============================
[0m02:09:01.852550 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:09:01.853536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:09:02.987086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fbc5721-f1b9-410e-9d2c-462fea62d107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116d0bd70>]}
[0m02:09:03.055449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fbc5721-f1b9-410e-9d2c-462fea62d107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac3ccb0>]}
[0m02:09:03.056542 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:09:03.079877 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:09:03.275966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:09:03.276463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:09:03.282789 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m02:09:03.319839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fbc5721-f1b9-410e-9d2c-462fea62d107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fea480>]}
[0m02:09:03.470707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fbc5721-f1b9-410e-9d2c-462fea62d107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183ce4e0>]}
[0m02:09:03.471312 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m02:09:03.471767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fbc5721-f1b9-410e-9d2c-462fea62d107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181e3fb0>]}
[0m02:09:03.473890 [info ] [MainThread]: 
[0m02:09:03.474626 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:09:03.477490 [debug] [MainThread]: Command end result
[0m02:09:03.512622 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7364733, "process_user_time": 3.214718, "process_kernel_time": 0.442605, "process_mem_max_rss": "172097536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:09:03.513477 [debug] [MainThread]: Command `dbt test` succeeded at 02:09:03.513333 after 1.74 seconds
[0m02:09:03.514018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183b6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181f6060>]}
[0m02:09:03.514482 [debug] [MainThread]: Flushing usage events
[0m02:09:17.300661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe79e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab6a80>]}


============================== 02:09:17.305522 | e7ac4e19-2e6a-4eae-b492-534ec6f16b58 ==============================
[0m02:09:17.305522 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:09:17.306293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:09:19.291582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7ac4e19-2e6a-4eae-b492-534ec6f16b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188013d0>]}
[0m02:09:19.366851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7ac4e19-2e6a-4eae-b492-534ec6f16b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a24d1f0>]}
[0m02:09:19.368275 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:09:19.394613 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:09:19.606795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:09:19.607289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:09:19.614261 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m02:09:19.652644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7ac4e19-2e6a-4eae-b492-534ec6f16b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3bce90>]}
[0m02:09:19.779158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7ac4e19-2e6a-4eae-b492-534ec6f16b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8309e0>]}
[0m02:09:19.779730 [info ] [MainThread]: Found 3 models, 1 source, 459 macros
[0m02:09:19.780181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ac4e19-2e6a-4eae-b492-534ec6f16b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a606300>]}
[0m02:09:19.782447 [info ] [MainThread]: 
[0m02:09:19.783222 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:09:19.790050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m02:09:19.810762 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m02:09:19.811263 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m02:09:19.811643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:20.482703 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.671 seconds
[0m02:09:20.485490 [debug] [ThreadPool]: On list_dev: Close
[0m02:09:20.591241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m02:09:20.605259 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m02:09:20.605863 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m02:09:20.606344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:20.999946 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.394 seconds
[0m02:09:21.003152 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m02:09:21.115324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ac4e19-2e6a-4eae-b492-534ec6f16b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b8230>]}
[0m02:09:21.116176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:09:21.116745 [info ] [MainThread]: 
[0m02:09:21.121939 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.moving_averages
[0m02:09:21.122716 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.moving_averages .......................... [RUN]
[0m02:09:21.123321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.moving_averages)
[0m02:09:21.123797 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.moving_averages
[0m02:09:21.138462 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.moving_averages"
[0m02:09:21.140045 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.moving_averages
[0m02:09:21.189190 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.moving_averages"
[0m02:09:21.190679 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.moving_averages"
[0m02:09:21.191184 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.moving_averages"} */
create or replace   view dev.analytics.moving_averages
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
FROM base_data
ORDER BY symbol, date
  );
[0m02:09:21.192051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:21.916478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.724 seconds
[0m02:09:21.949943 [debug] [Thread-1 (]: On model.dbt_proj_lab2.moving_averages: Close
[0m02:09:22.112336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ac4e19-2e6a-4eae-b492-534ec6f16b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a420680>]}
[0m02:09:22.113282 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.moving_averages ..................... [[32mSUCCESS 1[0m in 0.99s]
[0m02:09:22.114293 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.moving_averages
[0m02:09:22.115208 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.price_momentum
[0m02:09:22.116571 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.price_momentum ........................... [RUN]
[0m02:09:22.117415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.moving_averages, now model.dbt_proj_lab2.price_momentum)
[0m02:09:22.118048 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.price_momentum
[0m02:09:22.122392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.price_momentum"
[0m02:09:22.123909 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.price_momentum
[0m02:09:22.132198 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.price_momentum"
[0m02:09:22.134076 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.price_momentum"
[0m02:09:22.134857 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.price_momentum"} */
create or replace   view dev.analytics.price_momentum
  
   as (
    -- models/price_momentum.sql

WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
)

SELECT
    date,
    symbol,
    close,
    previous_close,
    close - previous_close AS price_momentum
FROM base_data
WHERE previous_close IS NOT NULL
ORDER BY symbol, date
  );
[0m02:09:22.135506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:22.964832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.829 seconds
[0m02:09:22.968269 [debug] [Thread-1 (]: On model.dbt_proj_lab2.price_momentum: Close
[0m02:09:23.327962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ac4e19-2e6a-4eae-b492-534ec6f16b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab76f30>]}
[0m02:09:23.328939 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.price_momentum ...................... [[32mSUCCESS 1[0m in 1.21s]
[0m02:09:23.329907 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.price_momentum
[0m02:09:23.330585 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.rsi
[0m02:09:23.331422 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi ...................................... [RUN]
[0m02:09:23.332169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_proj_lab2.price_momentum, now model.dbt_proj_lab2.rsi)
[0m02:09:23.332769 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.rsi
[0m02:09:23.337652 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.rsi"
[0m02:09:23.339231 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.rsi
[0m02:09:23.344854 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.rsi"
[0m02:09:23.347595 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.rsi"
[0m02:09:23.348278 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.rsi"} */
create or replace   view dev.analytics.rsi
  
   as (
    WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

gains_and_losses AS (
    SELECT
        date,
        symbol,
        close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
)

SELECT
    date,
    symbol,
    avg_gain,
    avg_loss,
    CASE 
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM averages
ORDER BY symbol, date
  );
[0m02:09:23.348880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:24.167657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.819 seconds
[0m02:09:24.170350 [debug] [Thread-1 (]: On model.dbt_proj_lab2.rsi: Close
[0m02:09:24.286907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ac4e19-2e6a-4eae-b492-534ec6f16b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa0eff0>]}
[0m02:09:24.287879 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi ................................. [[32mSUCCESS 1[0m in 0.95s]
[0m02:09:24.288806 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.rsi
[0m02:09:24.290522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:24.291018 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.rsi' was properly closed.
[0m02:09:24.291568 [info ] [MainThread]: 
[0m02:09:24.292119 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m02:09:24.293596 [debug] [MainThread]: Command end result
[0m02:09:24.336881 [info ] [MainThread]: 
[0m02:09:24.337725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:09:24.338223 [info ] [MainThread]: 
[0m02:09:24.338732 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:09:24.342722 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.12115, "process_user_time": 3.973975, "process_kernel_time": 0.647775, "process_mem_max_rss": "178974720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m02:09:24.344335 [debug] [MainThread]: Command `dbt run` succeeded at 02:09:24.344062 after 7.12 seconds
[0m02:09:24.345104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0ddee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab6a80>]}
[0m02:09:24.345814 [debug] [MainThread]: Flushing usage events
[0m03:49:38.858311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffb5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015e9c0>]}


============================== 03:49:38.865549 | c8aa8801-5ec5-4547-a5ad-25abf71b198d ==============================
[0m03:49:38.865549 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:49:38.866515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m03:49:41.279847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8aa8801-5ec5-4547-a5ad-25abf71b198d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110134560>]}
[0m03:49:41.351510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8aa8801-5ec5-4547-a5ad-25abf71b198d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106b1880>]}
[0m03:49:41.354416 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:49:41.382531 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:49:41.494275 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:49:41.494984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8aa8801-5ec5-4547-a5ad-25abf71b198d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6b1010>]}
[0m03:49:42.805618 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "stockprice') }}
      ),
  
      price_changes AS (
          SELECT
              date,
              symbol,
              close,
              close - previous_close AS price_change
          FROM base_data
          WHERE previous_close IS NOT NULL
      ),
  
      gains_and_losses AS (
          SELECT
              date,
              symbol,
              close,
              CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
              CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
          FROM price_changes
      ),
  
      averages AS (
          SELECT
              date,
              symbol,
              AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
              AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
          FROM gains_and_losses
      )
  
      SELECT
          date,
          symbol,
          close,
          close - previous_close AS price_momentum,
          CASE 
              WHEN avg_loss = 0 THEN 100
              ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
          END AS rsi,
          AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
      FROM averages
      JOIN base_data USING (date, symbol)
      ORDER BY symbol, date;
  
  {% endsnapshot %}"
[0m03:49:42.810795 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.0393124, "process_user_time": 4.363053, "process_kernel_time": 0.652095, "process_mem_max_rss": "169431040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:49:42.811787 [debug] [MainThread]: Command `dbt run` failed at 03:49:42.811602 after 4.04 seconds
[0m03:49:42.812363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff73f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122cb6de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122cbc1d0>]}
[0m03:49:42.812822 [debug] [MainThread]: Flushing usage events
[0m03:50:57.699552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102860c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11062ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110676ba0>]}


============================== 03:50:57.705886 | 66ec5d2c-a2ab-466e-8b45-298b7c58253e ==============================
[0m03:50:57.705886 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:50:57.706654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:50:59.888185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66ec5d2c-a2ab-466e-8b45-298b7c58253e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d17f80>]}
[0m03:50:59.953866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66ec5d2c-a2ab-466e-8b45-298b7c58253e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110653800>]}
[0m03:50:59.956970 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:50:59.985377 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:51:00.092276 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:51:00.092993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '66ec5d2c-a2ab-466e-8b45-298b7c58253e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122cc6240>]}
[0m03:51:01.321584 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "stockprice') }}
      ),
  
      price_changes AS (
          SELECT
              date,
              symbol,
              close,
              close - previous_close AS price_change
          FROM base_data
          WHERE previous_close IS NOT NULL
      ),
  
      gains_and_losses AS (
          SELECT
              date,
              symbol,
              close,
              CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
              CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
          FROM price_changes
      ),
  
      averages AS (
          SELECT
              date,
              symbol,
              AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
              AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
          FROM gains_and_losses
      )
  
      SELECT
          date,
          symbol,
          close,
          close - previous_close AS price_momentum,
          CASE 
              WHEN avg_loss = 0 THEN 100
              ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
          END AS rsi,
          AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
      FROM averages
      JOIN base_data USING (date, symbol)
      ORDER BY symbol, date;
  
  {% endsnapshot %}"
[0m03:51:01.326935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7052915, "process_user_time": 4.471548, "process_kernel_time": 0.710988, "process_mem_max_rss": "169775104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:51:01.327863 [debug] [MainThread]: Command `dbt run` failed at 03:51:01.327690 after 3.71 seconds
[0m03:51:01.328480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102860c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12318a720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11118cad0>]}
[0m03:51:01.329164 [debug] [MainThread]: Flushing usage events
[0m03:52:23.058378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d33da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee6b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee6900>]}


============================== 03:52:23.064712 | c1d3fa11-989c-45a4-827f-24d42ac5e5e1 ==============================
[0m03:52:23.064712 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:52:23.065663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:52:25.723712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1d3fa11-989c-45a4-827f-24d42ac5e5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187abd40>]}
[0m03:52:25.792038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1d3fa11-989c-45a4-827f-24d42ac5e5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ca360>]}
[0m03:52:25.795154 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:52:25.825861 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:52:25.935946 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:52:25.936641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1d3fa11-989c-45a4-827f-24d42ac5e5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b5eab0>]}
[0m03:52:27.187167 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "stockprice') }}
      ),
  
      price_changes AS (
          SELECT
              date,
              symbol,
              close,
              close - previous_close AS price_change
          FROM base_data
          WHERE previous_close IS NOT NULL
      ),
  
      gains_and_losses AS (
          SELECT
              date,
              symbol,
              close,
              CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
              CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
          FROM price_changes
      ),
  
      averages AS (
          SELECT
              date,
              symbol,
              AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
              AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
          FROM gains_and_losses
      )
  
      SELECT
          date,
          symbol,
          close,
          close - previous_close AS price_momentum,
          CASE 
              WHEN avg_loss = 0 THEN 100
              ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
          END AS rsi,
          AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
      FROM averages
      JOIN base_data USING (date, symbol)
      ORDER BY symbol, date;
  
  {% endsnapshot %}"
[0m03:52:27.191407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.209446, "process_user_time": 4.587518, "process_kernel_time": 0.842664, "process_mem_max_rss": "169820160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:52:27.192241 [debug] [MainThread]: Command `dbt run` failed at 03:52:27.192096 after 4.21 seconds
[0m03:52:27.192795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10206aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118bac980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d31a60>]}
[0m03:52:27.193244 [debug] [MainThread]: Flushing usage events
[0m03:56:20.498528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060565a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106129dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061728d0>]}


============================== 03:56:20.505302 | d626918d-8a87-4bb2-9c30-93865ccb3101 ==============================
[0m03:56:20.505302 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:56:20.506503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m03:56:22.930166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd626918d-8a87-4bb2-9c30-93865ccb3101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189a0830>]}
[0m03:56:22.996439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd626918d-8a87-4bb2-9c30-93865ccb3101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e1af0>]}
[0m03:56:23.000139 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:56:23.028520 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:56:23.131092 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:56:23.131769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd626918d-8a87-4bb2-9c30-93865ccb3101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d9b140>]}
[0m03:56:24.362956 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "stockprice') }}
      ),
  
      price_changes AS (
          SELECT
              date,
              symbol,
              close,
              close - previous_close AS price_change
          FROM base_data
          WHERE previous_close IS NOT NULL
      ),
  
      gains_and_losses AS (
          SELECT
              date,
              symbol,
              close,
              CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
              CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
          FROM price_changes
      ),
  
      averages AS (
          SELECT
              date,
              symbol,
              AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
              AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
          FROM gains_and_losses
      )
  
      SELECT
          date,
          symbol,
          close,
          close - previous_close AS price_momentum,
          CASE 
              WHEN avg_loss = 0 THEN 100
              ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
          END AS rsi,
          AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
      FROM averages
      JOIN base_data USING (date, symbol)
      ORDER BY symbol, date;
  
  {% endsnapshot %}"
[0m03:56:24.368829 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.9572988, "process_user_time": 4.594872, "process_kernel_time": 0.867933, "process_mem_max_rss": "169533440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:56:24.369846 [debug] [MainThread]: Command `dbt snapshot` failed at 03:56:24.369587 after 3.96 seconds
[0m03:56:24.371131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d92510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118db6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614e540>]}
[0m03:56:24.372704 [debug] [MainThread]: Flushing usage events
[0m03:57:27.710179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d937e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0b2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea6ddc0>]}


============================== 03:57:27.714972 | 08b47a6c-a9c2-4d64-b4d1-a4a0e7b93082 ==============================
[0m03:57:27.714972 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:57:27.715824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'version_check': 'True', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:57:29.217532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08b47a6c-a9c2-4d64-b4d1-a4a0e7b93082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205b6ba0>]}
[0m03:57:29.286759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08b47a6c-a9c2-4d64-b4d1-a4a0e7b93082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efe3d40>]}
[0m03:57:29.293123 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:57:29.322941 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:57:29.432488 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:57:29.433223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '08b47a6c-a9c2-4d64-b4d1-a4a0e7b93082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217a3080>]}
[0m03:57:30.835517 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m03:57:30.844718 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.2108026, "process_user_time": 4.418786, "process_kernel_time": 0.475318, "process_mem_max_rss": "172576768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m03:57:30.845745 [debug] [MainThread]: Command `dbt snapshot` failed at 03:57:30.845559 after 3.21 seconds
[0m03:57:30.846618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de34b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc0f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121844080>]}
[0m03:57:30.847239 [debug] [MainThread]: Flushing usage events
[0m04:00:10.800048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e11bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb5ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb5a9c0>]}


============================== 04:00:10.806087 | b6382307-4973-468a-a640-8bcfd91a6645 ==============================
[0m04:00:10.806087 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:00:10.806846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:00:13.317144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6382307-4973-468a-a640-8bcfd91a6645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d442090>]}
[0m04:00:13.383510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6382307-4973-468a-a640-8bcfd91a6645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120854170>]}
[0m04:00:13.386610 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:00:13.413660 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:00:13.515966 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:00:13.516613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6382307-4973-468a-a640-8bcfd91a6645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e118ce0>]}
[0m04:00:14.849303 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got "stockprice') }}
      ),
  
      price_changes AS (
          SELECT
              date,
              symbol,
              close,
              close - previous_close AS price_change
          FROM base_data
          WHERE previous_close IS NOT NULL
      ),
  
      gains_and_losses AS (
          SELECT
              date,
              symbol,
              close,
              CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
              CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
          FROM price_changes
      ),
  
      averages AS (
          SELECT
              date,
              symbol,
              AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
              AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
          FROM gains_and_losses
      )
  
      SELECT
          date,
          symbol,
          close,
          close - previous_close AS price_momentum,
          CASE 
              WHEN avg_loss = 0 THEN 100
              ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
          END AS rsi,
          AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
      FROM averages
      JOIN base_data USING (date, symbol)
      ORDER BY symbol, date;
  
  {% endsnapshot %}"
[0m04:00:14.853789 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.1380687, "process_user_time": 4.683988, "process_kernel_time": 0.903778, "process_mem_max_rss": "169242624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:00:14.854613 [debug] [MainThread]: Command `dbt snapshot` failed at 04:00:14.854461 after 4.14 seconds
[0m04:00:14.855498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea24b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121920b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9e1ac0>]}
[0m04:00:14.856728 [debug] [MainThread]: Flushing usage events
[0m04:14:57.164477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cf2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c62cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c62a50>]}


============================== 04:14:57.171496 | 107a2af5-5362-46d7-8b5e-deeef3ba81f5 ==============================
[0m04:14:57.171496 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:14:57.172483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:14:59.784882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '107a2af5-5362-46d7-8b5e-deeef3ba81f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c62d20>]}
[0m04:14:59.857117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '107a2af5-5362-46d7-8b5e-deeef3ba81f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109740cb0>]}
[0m04:14:59.860605 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:14:59.890676 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:14:59.992329 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:14:59.992945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '107a2af5-5362-46d7-8b5e-deeef3ba81f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b943350>]}
[0m04:15:01.292700 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m04:15:01.307487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '107a2af5-5362-46d7-8b5e-deeef3ba81f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8504d0>]}
[0m04:15:01.430850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '107a2af5-5362-46d7-8b5e-deeef3ba81f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba6de20>]}
[0m04:15:01.431558 [info ] [MainThread]: Found 1 source, 459 macros
[0m04:15:01.432346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '107a2af5-5362-46d7-8b5e-deeef3ba81f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba329c0>]}
[0m04:15:01.434470 [info ] [MainThread]: 
[0m04:15:01.434954 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:15:01.435714 [debug] [MainThread]: Command end result
[0m04:15:01.476454 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.395334, "process_user_time": 4.774283, "process_kernel_time": 0.943116, "process_mem_max_rss": "170893312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:15:01.477821 [debug] [MainThread]: Command `dbt run` succeeded at 04:15:01.477421 after 4.40 seconds
[0m04:15:01.478856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c62750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba2c830>]}
[0m04:15:01.479722 [debug] [MainThread]: Flushing usage events
[0m04:20:35.070865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107081040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c76c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c76960>]}


============================== 04:20:35.077585 | 9818e475-2c62-4835-b165-2e847971ab3a ==============================
[0m04:20:35.077585 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:20:35.078513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m04:20:37.450193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9818e475-2c62-4835-b165-2e847971ab3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108765df0>]}
[0m04:20:37.520540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9818e475-2c62-4835-b165-2e847971ab3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc4a540>]}
[0m04:20:37.523537 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:20:37.552471 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:20:37.641701 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:20:37.642510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9818e475-2c62-4835-b165-2e847971ab3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8eaa20>]}
[0m04:20:38.895036 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2.example
[0m04:20:38.911075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9818e475-2c62-4835-b165-2e847971ab3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a9791c0>]}
[0m04:20:39.023106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9818e475-2c62-4835-b165-2e847971ab3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a883890>]}
[0m04:20:39.023678 [info ] [MainThread]: Found 1 source, 459 macros
[0m04:20:39.024100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9818e475-2c62-4835-b165-2e847971ab3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8457f0>]}
[0m04:20:39.026139 [info ] [MainThread]: 
[0m04:20:39.026654 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:20:39.027857 [debug] [MainThread]: Command end result
[0m04:20:39.065505 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.07465, "process_user_time": 4.628443, "process_kernel_time": 0.875659, "process_mem_max_rss": "171495424", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:20:39.066559 [debug] [MainThread]: Command `dbt run` succeeded at 04:20:39.066356 after 4.08 seconds
[0m04:20:39.067160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a98b0e0>]}
[0m04:20:39.067824 [debug] [MainThread]: Flushing usage events
[0m04:22:03.581040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085da9f0>]}


============================== 04:22:03.587931 | 98e37cb4-18b0-478f-bf1c-0560bf99ab44 ==============================
[0m04:22:03.587931 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:22:03.588745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:22:05.835949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98e37cb4-18b0-478f-bf1c-0560bf99ab44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11999ce30>]}
[0m04:22:05.901395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98e37cb4-18b0-478f-bf1c-0560bf99ab44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b016d20>]}
[0m04:22:05.904452 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:22:05.930964 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:22:06.007131 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:22:06.007786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98e37cb4-18b0-478f-bf1c-0560bf99ab44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2368d0>]}
[0m04:22:07.232722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_proj_lab2
[0m04:22:07.250329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98e37cb4-18b0-478f-bf1c-0560bf99ab44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1a8230>]}
[0m04:22:07.365218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98e37cb4-18b0-478f-bf1c-0560bf99ab44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1d8b60>]}
[0m04:22:07.365911 [info ] [MainThread]: Found 1 source, 459 macros
[0m04:22:07.366367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98e37cb4-18b0-478f-bf1c-0560bf99ab44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b0290>]}
[0m04:22:07.368377 [info ] [MainThread]: 
[0m04:22:07.368846 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:22:07.369517 [debug] [MainThread]: Command end result
[0m04:22:07.410274 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9037468, "process_user_time": 4.595708, "process_kernel_time": 0.779923, "process_mem_max_rss": "170569728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:22:07.411187 [debug] [MainThread]: Command `dbt run` succeeded at 04:22:07.411037 after 3.90 seconds
[0m04:22:07.411813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10845eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1910d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f87d70>]}
[0m04:22:07.412523 [debug] [MainThread]: Flushing usage events
[0m04:25:19.273409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c10f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccf2b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccf2900>]}


============================== 04:25:19.280380 | 1f836ade-90de-4491-abeb-dc99384325e1 ==============================
[0m04:25:19.280380 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:25:19.281137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:25:21.716046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f836ade-90de-4491-abeb-dc99384325e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7ff350>]}
[0m04:25:21.788844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f836ade-90de-4491-abeb-dc99384325e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c784ec0>]}
[0m04:25:21.790121 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:25:21.816121 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:25:22.006323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:25:22.006928 [debug] [MainThread]: Partial parsing: added file: dbt_proj_lab2://models/analysis.sql
[0m04:25:22.313568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f836ade-90de-4491-abeb-dc99384325e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eaa9cd0>]}
[0m04:25:22.431751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f836ade-90de-4491-abeb-dc99384325e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8cc4a0>]}
[0m04:25:22.432347 [info ] [MainThread]: Found 1 model, 1 source, 459 macros
[0m04:25:22.432803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f836ade-90de-4491-abeb-dc99384325e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fba30e0>]}
[0m04:25:22.434932 [info ] [MainThread]: 
[0m04:25:22.435651 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:25:22.436802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:25:22.460635 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:25:22.463134 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:25:22.464008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:25:23.196033 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.732 seconds
[0m04:25:23.199414 [debug] [ThreadPool]: On list_dev: Close
[0m04:25:23.307906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:25:23.321532 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:25:23.322129 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:25:23.322596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:25:23.852467 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.530 seconds
[0m04:25:23.855795 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:25:24.002757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f836ade-90de-4491-abeb-dc99384325e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0967e0>]}
[0m04:25:24.003521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:25:24.003996 [info ] [MainThread]: 
[0m04:25:24.007033 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.analysis
[0m04:25:24.008003 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.analysis ................................ [RUN]
[0m04:25:24.009100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.analysis)
[0m04:25:24.009838 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.analysis
[0m04:25:24.023752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.analysis"
[0m04:25:24.025646 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.analysis
[0m04:25:24.077657 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.analysis"
[0m04:25:24.080830 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.analysis"
[0m04:25:24.081378 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.analysis"} */
create or replace transient table dev.analytics.analysis
         as
        (WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

-- Calculate price momentum
price_momentum_data AS (
    SELECT
        date,
        symbol,
        close,
        previous_close,
        close - previous_close AS price_momentum
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate price change (used for RSI calculation)
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate gains and losses
gains_and_losses AS (
    SELECT
        date,
        symbol,
        close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

-- Calculate the average gains and losses for RSI calculation
averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),

-- Calculate RSI based on average gains and losses
rsi_data AS (
    SELECT
        date,
        symbol,
        avg_gain,
        avg_loss,
        CASE 
            WHEN avg_loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
        END AS rsi
    FROM averages
),

-- Calculate the 7-day moving average
moving_avg_data AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
    FROM base_data
)

-- Final SELECT combining all metrics into a single table
SELECT
    rsi_data.date,
    rsi_data.symbol,
    rsi_data.rsi,
    price_momentum_data.price_momentum,
    moving_avg_data.moving_avg_7d
FROM rsi_data
JOIN price_momentum_data
    ON rsi_data.date = price_momentum_data.date AND rsi_data.symbol = price_momentum_data.symbol
JOIN moving_avg_data
    ON rsi_data.date = moving_avg_data.date AND rsi_data.symbol = moving_avg_data.symbol
ORDER BY rsi_data.symbol, rsi_data.date
        );
[0m04:25:24.081951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:25:25.768376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.686 seconds
[0m04:25:25.802507 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: Close
[0m04:25:25.949797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f836ade-90de-4491-abeb-dc99384325e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fe5deb0>]}
[0m04:25:25.950673 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.analysis ........................... [[32mSUCCESS 1[0m in 1.94s]
[0m04:25:25.951491 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.analysis
[0m04:25:25.952957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:25:25.953355 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.analysis' was properly closed.
[0m04:25:25.953753 [info ] [MainThread]: 
[0m04:25:25.954220 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m04:25:25.955099 [debug] [MainThread]: Command end result
[0m04:25:25.991823 [info ] [MainThread]: 
[0m04:25:25.992525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:25:25.992986 [info ] [MainThread]: 
[0m04:25:25.993493 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:25:25.997843 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8110094, "process_user_time": 4.235286, "process_kernel_time": 0.907934, "process_mem_max_rss": "182419456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:25:25.998848 [debug] [MainThread]: Command `dbt run` succeeded at 04:25:25.998690 after 6.81 seconds
[0m04:25:25.999410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f8cf9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa91070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fc91940>]}
[0m04:25:25.999988 [debug] [MainThread]: Flushing usage events
[0m04:28:12.803067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109319d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ca990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ca750>]}


============================== 04:28:12.809069 | 10820f07-44ec-40ab-a5f5-ba1dcb3bb9ab ==============================
[0m04:28:12.809069 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:28:12.809808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:28:15.319854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10820f07-44ec-40ab-a5f5-ba1dcb3bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba55670>]}
[0m04:28:15.391820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10820f07-44ec-40ab-a5f5-ba1dcb3bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df5070>]}
[0m04:28:15.393531 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:28:15.422627 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:28:15.638732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:28:15.639381 [debug] [MainThread]: Partial parsing: added file: dbt_proj_lab2://snapshots/stock_prices_snapshot.sql
[0m04:28:15.803102 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot stock_metrics_snapshot (snapshots/stock_prices_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m04:28:15.808966 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.0886261, "process_user_time": 3.610858, "process_kernel_time": 0.900316, "process_mem_max_rss": "168357888", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:28:15.810289 [debug] [MainThread]: Command `dbt snapshot` failed at 04:28:15.810047 after 3.09 seconds
[0m04:28:15.811652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ca720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bfdad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c206f30>]}
[0m04:28:15.812334 [debug] [MainThread]: Flushing usage events
[0m04:29:08.818674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b636840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c03e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c03e720>]}


============================== 04:29:08.823189 | ad59250d-6a3b-4761-aea5-fc5e664f1c33 ==============================
[0m04:29:08.823189 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:29:08.824051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:29:09.937432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad59250d-6a3b-4761-aea5-fc5e664f1c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8d6330>]}
[0m04:29:10.016825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad59250d-6a3b-4761-aea5-fc5e664f1c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e398a70>]}
[0m04:29:10.018274 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:29:10.045745 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:29:10.263010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:29:10.263648 [debug] [MainThread]: Partial parsing: added file: dbt_proj_lab2://snapshots/stock_prices_snapshot.sql
[0m04:29:10.422163 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot stock_metrics_snapshot (snapshots/stock_prices_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m04:29:10.427407 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.6782829, "process_user_time": 3.085445, "process_kernel_time": 0.393406, "process_mem_max_rss": "169582592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:29:10.428608 [debug] [MainThread]: Command `dbt snapshot` failed at 04:29:10.428269 after 1.68 seconds
[0m04:29:10.429310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd4dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eb33e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be99c70>]}
[0m04:29:10.429871 [debug] [MainThread]: Flushing usage events
[0m04:31:03.519289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123e3020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fdea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fde7e0>]}


============================== 04:31:03.525450 | d27be11b-5ea0-4953-acdc-987fd7dcd84c ==============================
[0m04:31:03.525450 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:31:03.526254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m04:31:05.945076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd27be11b-5ea0-4953-acdc-987fd7dcd84c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12585ddf0>]}
[0m04:31:06.011310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd27be11b-5ea0-4953-acdc-987fd7dcd84c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12595cad0>]}
[0m04:31:06.014280 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:31:06.040826 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:31:06.258298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:31:06.258936 [debug] [MainThread]: Partial parsing: added file: dbt_proj_lab2://snapshots/stock_prices_snapshot.sql
[0m04:31:06.414915 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot stock_metrics_snapshot (snapshots/stock_prices_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m04:31:06.418958 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 2.9889884, "process_user_time": 3.575904, "process_kernel_time": 0.871909, "process_mem_max_rss": "169619456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:31:06.419888 [debug] [MainThread]: Command `dbt snapshot` failed at 04:31:06.419724 after 2.99 seconds
[0m04:31:06.420462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b32990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b33860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b335f0>]}
[0m04:31:06.420981 [debug] [MainThread]: Flushing usage events
[0m04:34:34.656127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6dd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b832ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dba2930>]}


============================== 04:34:34.663332 | 09caabef-f257-4199-9648-a6e5f429b346 ==============================
[0m04:34:34.663332 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:34:34.664315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:34:37.138797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09caabef-f257-4199-9648-a6e5f429b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200205c0>]}
[0m04:34:37.208777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09caabef-f257-4199-9648-a6e5f429b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d604b00>]}
[0m04:34:37.212808 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:34:37.240828 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:34:37.456545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:34:37.457202 [debug] [MainThread]: Partial parsing: added file: dbt_proj_lab2://snapshots/stock_prices_snapshot.sql
[0m04:34:37.804887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09caabef-f257-4199-9648-a6e5f429b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a059a0>]}
[0m04:34:37.951621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09caabef-f257-4199-9648-a6e5f429b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a28980>]}
[0m04:34:37.952233 [info ] [MainThread]: Found 1 model, 1 snapshot, 1 source, 459 macros
[0m04:34:37.952674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09caabef-f257-4199-9648-a6e5f429b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca9fb00>]}
[0m04:34:37.955024 [info ] [MainThread]: 
[0m04:34:37.955778 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:34:37.956736 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:34:37.975756 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:34:37.976282 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:34:37.976687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:34:38.750101 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.773 seconds
[0m04:34:38.753353 [debug] [ThreadPool]: On list_dev: Close
[0m04:34:38.889847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_snapshot)
[0m04:34:38.890781 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "snapshot"
"
[0m04:34:38.898240 [debug] [ThreadPool]: Using snowflake connection "create_dev_snapshot"
[0m04:34:38.898842 [debug] [ThreadPool]: On create_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "create_dev_snapshot"} */
create schema if not exists dev.snapshot
[0m04:34:38.899320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:39.450508 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.551 seconds
[0m04:34:39.452472 [debug] [ThreadPool]: On create_dev_snapshot: Close
[0m04:34:39.558986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_snapshot, now list_dev_analytics)
[0m04:34:39.570815 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:34:39.571302 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:34:39.571670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:40.070524 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.499 seconds
[0m04:34:40.073948 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:34:40.239304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:34:40.243939 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:34:40.244599 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:34:40.245137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:40.702880 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.458 seconds
[0m04:34:40.705576 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:34:40.817509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09caabef-f257-4199-9648-a6e5f429b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120647d70>]}
[0m04:34:40.818517 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:34:40.819143 [info ] [MainThread]: 
[0m04:34:40.828511 [debug] [Thread-1 (]: Began running node snapshot.dbt_proj_lab2.snapshot_session_summary
[0m04:34:40.829571 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m04:34:40.830603 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.dbt_proj_lab2.snapshot_session_summary'
[0m04:34:40.831283 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_proj_lab2.snapshot_session_summary
[0m04:34:40.843669 [debug] [Thread-1 (]: Began executing node snapshot.dbt_proj_lab2.snapshot_session_summary
[0m04:34:40.965407 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.snapshot_session_summary"
[0m04:34:40.965976 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.analysis

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m04:34:40.966436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:34:41.432573 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86332-0004-2cf4-0002-70730001468e
[0m04:34:41.433386 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 26
invalid identifier 'SESSIONID'
[0m04:34:41.434252 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.snapshot_session_summary: Close
[0m04:34:41.555939 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/stock_prices_snapshot.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'SESSIONID'
[0m04:34:41.558064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09caabef-f257-4199-9648-a6e5f429b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d13e000>]}
[0m04:34:41.559168 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 0.73s]
[0m04:34:41.560158 [debug] [Thread-1 (]: Finished running node snapshot.dbt_proj_lab2.snapshot_session_summary
[0m04:34:41.562976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:34:41.563524 [debug] [MainThread]: Connection 'list_dev_snapshot' was properly closed.
[0m04:34:41.563971 [debug] [MainThread]: Connection 'snapshot.dbt_proj_lab2.snapshot_session_summary' was properly closed.
[0m04:34:41.564461 [info ] [MainThread]: 
[0m04:34:41.565011 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m04:34:41.566325 [debug] [MainThread]: Command end result
[0m04:34:41.609717 [info ] [MainThread]: 
[0m04:34:41.610585 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:34:41.612254 [info ] [MainThread]: 
[0m04:34:41.612999 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/stock_prices_snapshot.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'SESSIONID'
[0m04:34:41.613538 [info ] [MainThread]: 
[0m04:34:41.614137 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:34:41.618810 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.0470324, "process_user_time": 4.515398, "process_kernel_time": 0.975003, "process_mem_max_rss": "183914496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:34:41.619713 [debug] [MainThread]: Command `dbt snapshot` failed at 04:34:41.619562 after 7.05 seconds
[0m04:34:41.620277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da25040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf36f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c97fb00>]}
[0m04:34:41.620771 [debug] [MainThread]: Flushing usage events
[0m04:35:13.335755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10985de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a2a870>]}


============================== 04:35:13.341099 | bcdcc43d-d29d-4242-aedc-029bc1528469 ==============================
[0m04:35:13.341099 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:35:13.341915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'version_check': 'True', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:35:14.597946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcdcc43d-d29d-4242-aedc-029bc1528469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083162a0>]}
[0m04:35:14.685725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcdcc43d-d29d-4242-aedc-029bc1528469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c201ee0>]}
[0m04:35:14.688915 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:35:14.713625 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:35:14.975730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:35:14.976459 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://snapshots/stock_prices_snapshot.sql
[0m04:35:15.278413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcdcc43d-d29d-4242-aedc-029bc1528469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c4af260>]}
[0m04:35:15.407335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcdcc43d-d29d-4242-aedc-029bc1528469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c868b30>]}
[0m04:35:15.407921 [info ] [MainThread]: Found 1 model, 1 snapshot, 1 source, 459 macros
[0m04:35:15.408794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcdcc43d-d29d-4242-aedc-029bc1528469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c4afda0>]}
[0m04:35:15.410912 [info ] [MainThread]: 
[0m04:35:15.411664 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:35:15.412739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:35:15.431420 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:35:15.431932 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:35:15.432325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:35:15.995391 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.563 seconds
[0m04:35:15.998398 [debug] [ThreadPool]: On list_dev: Close
[0m04:35:16.101454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:35:16.113647 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:35:16.114183 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:35:16.114577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:35:16.591957 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.477 seconds
[0m04:35:16.594316 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:35:16.702536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:35:16.708115 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:35:16.708653 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:35:16.709198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:35:17.311810 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.603 seconds
[0m04:35:17.314679 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:35:17.442096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcdcc43d-d29d-4242-aedc-029bc1528469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c42bd40>]}
[0m04:35:17.442970 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:35:17.443494 [info ] [MainThread]: 
[0m04:35:17.447606 [debug] [Thread-1 (]: Began running node snapshot.dbt_proj_lab2.snapshot_session_summary
[0m04:35:17.448454 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m04:35:17.449158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.dbt_proj_lab2.snapshot_session_summary)
[0m04:35:17.449858 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_proj_lab2.snapshot_session_summary
[0m04:35:17.461513 [debug] [Thread-1 (]: Began executing node snapshot.dbt_proj_lab2.snapshot_session_summary
[0m04:35:17.558532 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.snapshot_session_summary"
[0m04:35:17.559242 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.analysis

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m04:35:17.559755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:35:18.030984 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86333-0004-3223-0002-70730001a066
[0m04:35:18.031831 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 26
invalid identifier 'SYMBOL_DATE'
[0m04:35:18.032714 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.snapshot_session_summary: Close
[0m04:35:18.159180 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/stock_prices_snapshot.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'SYMBOL_DATE'
[0m04:35:18.161399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcdcc43d-d29d-4242-aedc-029bc1528469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe9ee0>]}
[0m04:35:18.162643 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 0.71s]
[0m04:35:18.163715 [debug] [Thread-1 (]: Finished running node snapshot.dbt_proj_lab2.snapshot_session_summary
[0m04:35:18.166432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:35:18.166970 [debug] [MainThread]: Connection 'snapshot.dbt_proj_lab2.snapshot_session_summary' was properly closed.
[0m04:35:18.167460 [info ] [MainThread]: 
[0m04:35:18.168018 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m04:35:18.169508 [debug] [MainThread]: Command end result
[0m04:35:18.210258 [info ] [MainThread]: 
[0m04:35:18.210872 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:35:18.211437 [info ] [MainThread]: 
[0m04:35:18.212176 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/stock_prices_snapshot.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'SYMBOL_DATE'
[0m04:35:18.212730 [info ] [MainThread]: 
[0m04:35:18.213293 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:35:18.217420 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.9593997, "process_user_time": 4.218386, "process_kernel_time": 0.623198, "process_mem_max_rss": "182607872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:35:18.218367 [debug] [MainThread]: Command `dbt snapshot` failed at 04:35:18.218217 after 4.96 seconds
[0m04:35:18.219129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109067800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c89be30>]}
[0m04:35:18.219732 [debug] [MainThread]: Flushing usage events
[0m04:36:51.988753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063633e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106435dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647e810>]}


============================== 04:36:51.994961 | 5c516372-6805-473d-ba4d-4aac5f3bcbf0 ==============================
[0m04:36:51.994961 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:36:51.995768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m04:36:54.392382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c516372-6805-473d-ba4d-4aac5f3bcbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183049b0>]}
[0m04:36:54.456936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c516372-6805-473d-ba4d-4aac5f3bcbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117975af0>]}
[0m04:36:54.460100 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:36:54.488144 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:36:54.733982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:36:54.734858 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://snapshots/stock_prices_snapshot.sql
[0m04:36:55.041985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c516372-6805-473d-ba4d-4aac5f3bcbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11937d970>]}
[0m04:36:55.185128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c516372-6805-473d-ba4d-4aac5f3bcbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11932cbf0>]}
[0m04:36:55.185751 [info ] [MainThread]: Found 1 model, 1 snapshot, 1 source, 459 macros
[0m04:36:55.186667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c516372-6805-473d-ba4d-4aac5f3bcbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119364c20>]}
[0m04:36:55.188772 [info ] [MainThread]: 
[0m04:36:55.189515 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:36:55.190586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:36:55.209846 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:36:55.210552 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:36:55.211125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:56.205401 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.994 seconds
[0m04:36:56.208422 [debug] [ThreadPool]: On list_dev: Close
[0m04:36:56.321310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:36:56.334314 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:36:56.334903 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:36:56.335373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:56.876229 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.541 seconds
[0m04:36:56.879666 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:36:56.995075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:36:57.001172 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:36:57.001770 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:36:57.002274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:57.709645 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.707 seconds
[0m04:36:57.712158 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:36:57.837420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c516372-6805-473d-ba4d-4aac5f3bcbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106826630>]}
[0m04:36:57.838436 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:36:57.839070 [info ] [MainThread]: 
[0m04:36:57.848470 [debug] [Thread-1 (]: Began running node snapshot.dbt_proj_lab2.snapshot_session_summary
[0m04:36:57.849501 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m04:36:57.850371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.dbt_proj_lab2.snapshot_session_summary)
[0m04:36:57.851066 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_proj_lab2.snapshot_session_summary
[0m04:36:57.864425 [debug] [Thread-1 (]: Began executing node snapshot.dbt_proj_lab2.snapshot_session_summary
[0m04:36:57.959644 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.snapshot_session_summary"
[0m04:36:57.960273 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.analysis

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m04:36:57.960726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:58.487115 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86334-0004-2cf4-0002-70730001469e
[0m04:36:58.487944 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 33
invalid identifier 'TS'
[0m04:36:58.488816 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.snapshot_session_summary: Close
[0m04:36:58.613983 [debug] [Thread-1 (]: Database Error in snapshot snapshot_session_summary (snapshots/stock_prices_snapshot.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m04:36:58.615976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c516372-6805-473d-ba4d-4aac5f3bcbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3de50>]}
[0m04:36:58.616980 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_session_summary .................... [[31mERROR[0m in 0.76s]
[0m04:36:58.617921 [debug] [Thread-1 (]: Finished running node snapshot.dbt_proj_lab2.snapshot_session_summary
[0m04:36:58.620487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:58.620986 [debug] [MainThread]: Connection 'snapshot.dbt_proj_lab2.snapshot_session_summary' was properly closed.
[0m04:36:58.621480 [info ] [MainThread]: 
[0m04:36:58.622025 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m04:36:58.623334 [debug] [MainThread]: Command end result
[0m04:36:58.660530 [info ] [MainThread]: 
[0m04:36:58.661977 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:36:58.662728 [info ] [MainThread]: 
[0m04:36:58.663361 [error] [MainThread]:   Database Error in snapshot snapshot_session_summary (snapshots/stock_prices_snapshot.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m04:36:58.663942 [info ] [MainThread]: 
[0m04:36:58.664492 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:36:58.668378 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 6.757333, "process_user_time": 4.309355, "process_kernel_time": 0.861666, "process_mem_max_rss": "182296576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:36:58.669413 [debug] [MainThread]: Command `dbt snapshot` failed at 04:36:58.669220 after 6.76 seconds
[0m04:36:58.670049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1c230>]}
[0m04:36:58.670731 [debug] [MainThread]: Flushing usage events
[0m04:38:12.681978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095eff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a29ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a29a780>]}


============================== 04:38:12.688472 | 4f4f6547-731f-4069-8f47-22e3a7c0ef1f ==============================
[0m04:38:12.688472 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:38:12.689210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:38:14.823715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f4f6547-731f-4069-8f47-22e3a7c0ef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11befd790>]}
[0m04:38:14.890667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f4f6547-731f-4069-8f47-22e3a7c0ef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cbe8b90>]}
[0m04:38:14.892199 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:38:14.920890 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:38:15.166630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:38:15.167356 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://snapshots/stock_prices_snapshot.sql
[0m04:38:15.461258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f4f6547-731f-4069-8f47-22e3a7c0ef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d105b20>]}
[0m04:38:15.590761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f4f6547-731f-4069-8f47-22e3a7c0ef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d100a10>]}
[0m04:38:15.591348 [info ] [MainThread]: Found 1 model, 1 snapshot, 1 source, 459 macros
[0m04:38:15.591807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f4f6547-731f-4069-8f47-22e3a7c0ef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d153830>]}
[0m04:38:15.593968 [info ] [MainThread]: 
[0m04:38:15.594670 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:38:15.595887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:38:15.618530 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:38:15.619047 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:38:15.619468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:38:16.234732 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.615 seconds
[0m04:38:16.237750 [debug] [ThreadPool]: On list_dev: Close
[0m04:38:16.377846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m04:38:16.391344 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:38:16.391923 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:38:16.392406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:38:16.881387 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.489 seconds
[0m04:38:16.884163 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:38:16.997046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m04:38:17.001870 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:38:17.002449 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:38:17.002940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:38:17.446444 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.443 seconds
[0m04:38:17.449580 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:38:17.572658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f4f6547-731f-4069-8f47-22e3a7c0ef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cfd0aa0>]}
[0m04:38:17.573602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:38:17.574151 [info ] [MainThread]: 
[0m04:38:17.582638 [debug] [Thread-1 (]: Began running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:38:17.583766 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.stock_metrics_snapshot .......................... [RUN]
[0m04:38:17.584640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.dbt_proj_lab2.stock_metrics_snapshot)
[0m04:38:17.585629 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:38:17.599455 [debug] [Thread-1 (]: Began executing node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:38:17.702279 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m04:38:17.702832 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        
  
  coalesce(nullif(ts, ts), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.analysis

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m04:38:17.703313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:38:18.176148 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86336-0004-2cf5-0002-7073000182ce
[0m04:38:18.176976 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 33
invalid identifier 'TS'
[0m04:38:18.177853 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: Close
[0m04:38:18.305575 [debug] [Thread-1 (]: Database Error in snapshot stock_metrics_snapshot (snapshots/stock_prices_snapshot.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m04:38:18.307723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f4f6547-731f-4069-8f47-22e3a7c0ef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109835e80>]}
[0m04:38:18.308823 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.stock_metrics_snapshot ...................... [[31mERROR[0m in 0.72s]
[0m04:38:18.309808 [debug] [Thread-1 (]: Finished running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:38:18.312156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:38:18.312581 [debug] [MainThread]: Connection 'snapshot.dbt_proj_lab2.stock_metrics_snapshot' was properly closed.
[0m04:38:18.312990 [info ] [MainThread]: 
[0m04:38:18.313439 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m04:38:18.314293 [debug] [MainThread]: Command end result
[0m04:38:18.353651 [info ] [MainThread]: 
[0m04:38:18.354320 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:38:18.354844 [info ] [MainThread]: 
[0m04:38:18.355507 [error] [MainThread]:   Database Error in snapshot stock_metrics_snapshot (snapshots/stock_prices_snapshot.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TS'
[0m04:38:18.356033 [info ] [MainThread]: 
[0m04:38:18.356672 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:38:18.360095 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 5.75991, "process_user_time": 4.393802, "process_kernel_time": 0.820842, "process_mem_max_rss": "182853632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:38:18.361235 [debug] [MainThread]: Command `dbt snapshot` failed at 04:38:18.360906 after 5.76 seconds
[0m04:38:18.361928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce4bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cdce330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a29aab0>]}
[0m04:38:18.362443 [debug] [MainThread]: Flushing usage events
[0m04:39:01.015945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11306ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11306a900>]}


============================== 04:39:01.021008 | 7bf7b2a2-edcc-4a64-8f85-f59f622f8357 ==============================
[0m04:39:01.021008 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:39:01.021744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:39:02.255621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bf7b2a2-edcc-4a64-8f85-f59f622f8357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12579be30>]}
[0m04:39:02.331001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bf7b2a2-edcc-4a64-8f85-f59f622f8357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e38590>]}
[0m04:39:02.332266 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:39:02.355034 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:39:02.562837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:39:02.564833 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://snapshots/stock_prices_snapshot.sql
[0m04:39:02.878256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bf7b2a2-edcc-4a64-8f85-f59f622f8357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f81730>]}
[0m04:39:03.056785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bf7b2a2-edcc-4a64-8f85-f59f622f8357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f2cc80>]}
[0m04:39:03.057416 [info ] [MainThread]: Found 1 model, 1 snapshot, 1 source, 459 macros
[0m04:39:03.057960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bf7b2a2-edcc-4a64-8f85-f59f622f8357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125bffb00>]}
[0m04:39:03.060349 [info ] [MainThread]: 
[0m04:39:03.061125 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:39:03.062307 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:39:03.081962 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:39:03.082495 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:39:03.082932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:39:03.701520 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.619 seconds
[0m04:39:03.704557 [debug] [ThreadPool]: On list_dev: Close
[0m04:39:03.819559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:39:03.832990 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:39:03.833580 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:39:03.834058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:39:04.312396 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.478 seconds
[0m04:39:04.315641 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:39:04.436319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:39:04.442299 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:39:04.442863 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:39:04.443356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:39:04.852872 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.409 seconds
[0m04:39:04.855583 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:39:04.972429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bf7b2a2-edcc-4a64-8f85-f59f622f8357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125bffb00>]}
[0m04:39:04.973160 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:39:04.973756 [info ] [MainThread]: 
[0m04:39:04.979504 [debug] [Thread-1 (]: Began running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:39:04.980369 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.stock_metrics_snapshot .......................... [RUN]
[0m04:39:04.981395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.dbt_proj_lab2.stock_metrics_snapshot)
[0m04:39:04.982007 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:39:04.995216 [debug] [Thread-1 (]: Began executing node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:39:05.091362 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m04:39:05.091920 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(last_updated as varchar ), '')
        ) as dbt_scd_id,
        last_updated as dbt_updated_at,
        last_updated as dbt_valid_from,
        
  
  coalesce(nullif(last_updated, last_updated), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.analysis

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m04:39:05.092374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:39:05.597494 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86337-0004-2cec-0002-707300017672
[0m04:39:05.598347 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 33
invalid identifier 'LAST_UPDATED'
[0m04:39:05.599221 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: Close
[0m04:39:05.726506 [debug] [Thread-1 (]: Database Error in snapshot stock_metrics_snapshot (snapshots/stock_prices_snapshot.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'LAST_UPDATED'
[0m04:39:05.728814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bf7b2a2-edcc-4a64-8f85-f59f622f8357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126264b0>]}
[0m04:39:05.729867 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.stock_metrics_snapshot ...................... [[31mERROR[0m in 0.75s]
[0m04:39:05.730828 [debug] [Thread-1 (]: Finished running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:39:05.733413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:39:05.733892 [debug] [MainThread]: Connection 'snapshot.dbt_proj_lab2.stock_metrics_snapshot' was properly closed.
[0m04:39:05.734339 [info ] [MainThread]: 
[0m04:39:05.734833 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m04:39:05.735893 [debug] [MainThread]: Command end result
[0m04:39:05.775135 [info ] [MainThread]: 
[0m04:39:05.775757 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:39:05.776184 [info ] [MainThread]: 
[0m04:39:05.776718 [error] [MainThread]:   Database Error in snapshot stock_metrics_snapshot (snapshots/stock_prices_snapshot.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'LAST_UPDATED'
[0m04:39:05.777124 [info ] [MainThread]: 
[0m04:39:05.777562 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:39:05.781272 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.845342, "process_user_time": 3.940344, "process_kernel_time": 0.494886, "process_mem_max_rss": "184074240", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:39:05.782195 [debug] [MainThread]: Command `dbt snapshot` failed at 04:39:05.781991 after 4.85 seconds
[0m04:39:05.782828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e9cc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f83140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11306a900>]}
[0m04:39:05.783315 [debug] [MainThread]: Flushing usage events
[0m04:44:52.821331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9cdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daeabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daea960>]}


============================== 04:44:52.828416 | 106f9091-9019-4eb8-a6a1-5c6bc887587c ==============================
[0m04:44:52.828416 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:44:52.829222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:44:55.360496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '106f9091-9019-4eb8-a6a1-5c6bc887587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7ab3b0>]}
[0m04:44:55.431336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '106f9091-9019-4eb8-a6a1-5c6bc887587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204990a0>]}
[0m04:44:55.432744 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:44:55.463325 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:44:55.710590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:44:55.711394 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://snapshots/stock_prices_snapshot.sql
[0m04:44:56.019746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '106f9091-9019-4eb8-a6a1-5c6bc887587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120921820>]}
[0m04:44:56.154199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '106f9091-9019-4eb8-a6a1-5c6bc887587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120940860>]}
[0m04:44:56.154896 [info ] [MainThread]: Found 1 model, 1 snapshot, 1 source, 459 macros
[0m04:44:56.155392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '106f9091-9019-4eb8-a6a1-5c6bc887587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120923320>]}
[0m04:44:56.157596 [info ] [MainThread]: 
[0m04:44:56.158313 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:44:56.159446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:44:56.177826 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:44:56.178327 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:44:56.178710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:56.889821 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.710 seconds
[0m04:44:56.893305 [debug] [ThreadPool]: On list_dev: Close
[0m04:44:57.019383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:44:57.033116 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:44:57.033679 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:44:57.034160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:57.571967 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.538 seconds
[0m04:44:57.574882 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:44:57.706500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:44:57.712367 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:44:57.712938 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:44:57.713436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:58.126610 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.413 seconds
[0m04:44:58.129302 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:44:58.235432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '106f9091-9019-4eb8-a6a1-5c6bc887587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12059b200>]}
[0m04:44:58.236445 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:44:58.237075 [info ] [MainThread]: 
[0m04:44:58.240489 [debug] [Thread-1 (]: Began running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:44:58.241374 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.stock_metrics_snapshot .......................... [RUN]
[0m04:44:58.242110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.dbt_proj_lab2.stock_metrics_snapshot)
[0m04:44:58.243095 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:44:58.256964 [debug] [Thread-1 (]: Began executing node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:44:58.352097 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m04:44:58.352733 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(PRICE_MOMENTUM, RSI, MOVING_AVG_7D as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.analysis

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m04:44:58.353356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:58.832998 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8633c-0004-2cf3-0002-7073000116f2
[0m04:44:58.833586 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 40 unexpected ','.
syntax error line 6 at position 61 unexpected 'as'.
syntax error line 6 at position 77 unexpected ')'.
[0m04:44:58.834214 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: Close
[0m04:44:59.009594 [debug] [Thread-1 (]: Database Error in snapshot stock_metrics_snapshot (snapshots/stock_prices_snapshot.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 40 unexpected ','.
  syntax error line 6 at position 61 unexpected 'as'.
  syntax error line 6 at position 77 unexpected ')'.
[0m04:44:59.011913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '106f9091-9019-4eb8-a6a1-5c6bc887587c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d089f10>]}
[0m04:44:59.013017 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.stock_metrics_snapshot ...................... [[31mERROR[0m in 0.77s]
[0m04:44:59.014018 [debug] [Thread-1 (]: Finished running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:44:59.016490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:44:59.016978 [debug] [MainThread]: Connection 'snapshot.dbt_proj_lab2.stock_metrics_snapshot' was properly closed.
[0m04:44:59.017454 [info ] [MainThread]: 
[0m04:44:59.017981 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m04:44:59.019019 [debug] [MainThread]: Command end result
[0m04:44:59.062922 [info ] [MainThread]: 
[0m04:44:59.063760 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:44:59.064415 [info ] [MainThread]: 
[0m04:44:59.065251 [error] [MainThread]:   Database Error in snapshot stock_metrics_snapshot (snapshots/stock_prices_snapshot.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 40 unexpected ','.
  syntax error line 6 at position 61 unexpected 'as'.
  syntax error line 6 at position 77 unexpected ')'.
[0m04:44:59.065825 [info ] [MainThread]: 
[0m04:44:59.066382 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:44:59.071535 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 6.331864, "process_user_time": 4.379003, "process_kernel_time": 0.989394, "process_mem_max_rss": "183771136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:44:59.072552 [debug] [MainThread]: Command `dbt snapshot` failed at 04:44:59.072375 after 6.33 seconds
[0m04:44:59.073155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daeaae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d14b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120555b50>]}
[0m04:44:59.073747 [debug] [MainThread]: Flushing usage events
[0m04:46:04.967485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107817ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109386ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109386810>]}


============================== 04:46:04.973883 | d095400a-f6ae-43df-ba3a-49ed91daa58d ==============================
[0m04:46:04.973883 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:46:04.974769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m04:46:07.177842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd095400a-f6ae-43df-ba3a-49ed91daa58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba567e0>]}
[0m04:46:07.247348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd095400a-f6ae-43df-ba3a-49ed91daa58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935ebd0>]}
[0m04:46:07.249910 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:46:07.276373 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:46:07.515459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:46:07.516205 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://snapshots/stock_prices_snapshot.sql
[0m04:46:07.838397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd095400a-f6ae-43df-ba3a-49ed91daa58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c219850>]}
[0m04:46:07.983302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd095400a-f6ae-43df-ba3a-49ed91daa58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1c4c20>]}
[0m04:46:07.984250 [info ] [MainThread]: Found 1 model, 1 snapshot, 1 source, 459 macros
[0m04:46:07.984885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd095400a-f6ae-43df-ba3a-49ed91daa58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bdc2a50>]}
[0m04:46:07.987338 [info ] [MainThread]: 
[0m04:46:07.988209 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:46:07.989503 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:46:08.005958 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:46:08.006936 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:46:08.008122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:08.672861 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.664 seconds
[0m04:46:08.676373 [debug] [ThreadPool]: On list_dev: Close
[0m04:46:08.826645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m04:46:08.840338 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:46:08.840940 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:46:08.841419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:46:09.226345 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.385 seconds
[0m04:46:09.229106 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:46:09.344360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m04:46:09.349153 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:46:09.349727 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:46:09.350237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:46:09.855933 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.506 seconds
[0m04:46:09.858959 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:46:10.351257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd095400a-f6ae-43df-ba3a-49ed91daa58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11be89e20>]}
[0m04:46:10.352169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:46:10.352697 [info ] [MainThread]: 
[0m04:46:10.355924 [debug] [Thread-1 (]: Began running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:46:10.356742 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.stock_metrics_snapshot .......................... [RUN]
[0m04:46:10.357432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.dbt_proj_lab2.stock_metrics_snapshot)
[0m04:46:10.358043 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:46:10.368292 [debug] [Thread-1 (]: Began executing node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:46:10.464425 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m04:46:10.464976 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.analysis

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m04:46:10.465420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:10.943692 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.478 seconds
[0m04:46:10.954542 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m04:46:10.955212 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:46:11.043424 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.087 seconds
[0m04:46:11.044717 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m04:46:11.046882 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m04:46:11.047576 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
create or replace transient table dev.snapshot.stock_metrics_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.analysis

    ) sbq



        );
[0m04:46:12.182490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.134 seconds
[0m04:46:12.221472 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: Close
[0m04:46:12.325682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd095400a-f6ae-43df-ba3a-49ed91daa58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bcb4cb0>]}
[0m04:46:12.326833 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.stock_metrics_snapshot .......................... [[32mSUCCESS 1[0m in 1.97s]
[0m04:46:12.327820 [debug] [Thread-1 (]: Finished running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m04:46:12.329538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:46:12.329994 [debug] [MainThread]: Connection 'snapshot.dbt_proj_lab2.stock_metrics_snapshot' was properly closed.
[0m04:46:12.330456 [info ] [MainThread]: 
[0m04:46:12.331037 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m04:46:12.332039 [debug] [MainThread]: Command end result
[0m04:46:12.368909 [info ] [MainThread]: 
[0m04:46:12.370063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:46:12.370920 [info ] [MainThread]: 
[0m04:46:12.373006 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:46:12.378695 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.496066, "process_user_time": 4.365893, "process_kernel_time": 0.843908, "process_mem_max_rss": "182816768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:46:12.379720 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:46:12.379540 after 7.50 seconds
[0m04:46:12.380506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10908dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dae090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920a9f0>]}
[0m04:46:12.381073 [debug] [MainThread]: Flushing usage events
[0m04:46:27.323279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105719d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112676d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112676a80>]}


============================== 04:46:27.329690 | 69d0175e-83e2-4bd2-88d2-143d9acd5fde ==============================
[0m04:46:27.329690 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:46:27.330890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:46:28.512687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69d0175e-83e2-4bd2-88d2-143d9acd5fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124d248f0>]}
[0m04:46:28.575754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69d0175e-83e2-4bd2-88d2-143d9acd5fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bdf3e0>]}
[0m04:46:28.576687 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:46:28.598273 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:46:28.750219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:46:28.750839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:46:28.800396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69d0175e-83e2-4bd2-88d2-143d9acd5fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1253c3c80>]}
[0m04:46:28.956742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69d0175e-83e2-4bd2-88d2-143d9acd5fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1255ad070>]}
[0m04:46:28.957348 [info ] [MainThread]: Found 1 model, 1 snapshot, 1 source, 459 macros
[0m04:46:28.957822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69d0175e-83e2-4bd2-88d2-143d9acd5fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125194200>]}
[0m04:46:28.959896 [info ] [MainThread]: 
[0m04:46:28.960412 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:46:28.962648 [debug] [MainThread]: Command end result
[0m04:46:28.997369 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7498457, "process_user_time": 3.381107, "process_kernel_time": 0.539675, "process_mem_max_rss": "170954752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:46:28.998183 [debug] [MainThread]: Command `dbt test` succeeded at 04:46:28.998043 after 1.75 seconds
[0m04:46:28.998714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112555b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112383b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125574e90>]}
[0m04:46:28.999162 [debug] [MainThread]: Flushing usage events
[0m04:52:03.365414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107596a80>]}


============================== 04:52:03.371696 | b410d481-573a-44e0-8cb7-6fbdbedb8ec3 ==============================
[0m04:52:03.371696 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:52:03.372534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:52:05.655983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b410d481-573a-44e0-8cb7-6fbdbedb8ec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f8aba0>]}
[0m04:52:05.723051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b410d481-573a-44e0-8cb7-6fbdbedb8ec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192d4e00>]}
[0m04:52:05.726317 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:52:05.753836 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:52:05.983113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m04:52:05.983762 [debug] [MainThread]: Partial parsing: added file: dbt_proj_lab2://models/source.yml
[0m04:52:05.984483 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/schema.yml
[0m04:52:06.755383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b410d481-573a-44e0-8cb7-6fbdbedb8ec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a63e390>]}
[0m04:52:06.924793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b410d481-573a-44e0-8cb7-6fbdbedb8ec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a92e1e0>]}
[0m04:52:06.925388 [info ] [MainThread]: Found 1 model, 1 snapshot, 2 data tests, 1 source, 459 macros
[0m04:52:06.925871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b410d481-573a-44e0-8cb7-6fbdbedb8ec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a63e360>]}
[0m04:52:06.928100 [info ] [MainThread]: 
[0m04:52:06.928948 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:52:06.930044 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m04:52:06.954928 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:52:06.955489 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:52:06.955907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:52:07.881008 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.924 seconds
[0m04:52:07.885211 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:52:08.014831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:52:08.020767 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:52:08.021349 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:52:08.021907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:52:08.542891 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.521 seconds
[0m04:52:08.545039 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:52:08.678405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b410d481-573a-44e0-8cb7-6fbdbedb8ec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4c93a0>]}
[0m04:52:08.679397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:52:08.679936 [info ] [MainThread]: 
[0m04:52:08.685373 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m04:52:08.686342 [info ] [Thread-1 (]: 1 of 2 START test not_null_analysis_date ....................................... [RUN]
[0m04:52:08.687474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.dbt_proj_lab2.not_null_analysis_date.82ab678f33)
[0m04:52:08.688250 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m04:52:08.719115 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m04:52:08.720550 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m04:52:08.750064 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m04:52:08.751559 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m04:52:08.752148 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.analysis
where date is null



      
    ) dbt_internal_test
[0m04:52:08.752656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:52:09.563657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.811 seconds
[0m04:52:09.585108 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: Close
[0m04:52:09.731780 [info ] [Thread-1 (]: 1 of 2 PASS not_null_analysis_date ............................................. [[32mPASS[0m in 1.04s]
[0m04:52:09.732867 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m04:52:09.733561 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m04:52:09.734249 [info ] [Thread-1 (]: 2 of 2 START test unique_analysis_date ......................................... [RUN]
[0m04:52:09.734956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_date.82ab678f33, now test.dbt_proj_lab2.unique_analysis_date.9fe96713fa)
[0m04:52:09.735527 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m04:52:09.747408 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m04:52:09.748479 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m04:52:09.751975 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m04:52:09.753447 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m04:52:09.754295 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.analysis
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m04:52:09.755242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:52:10.422925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m04:52:10.426348 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: Close
[0m04:52:10.548317 [error] [Thread-1 (]: 2 of 2 FAIL 100 unique_analysis_date ........................................... [[31mFAIL 100[0m in 0.81s]
[0m04:52:10.549539 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m04:52:10.551326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:52:10.551808 [debug] [MainThread]: Connection 'test.dbt_proj_lab2.unique_analysis_date.9fe96713fa' was properly closed.
[0m04:52:10.552312 [info ] [MainThread]: 
[0m04:52:10.552862 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m04:52:10.554153 [debug] [MainThread]: Command end result
[0m04:52:10.716257 [info ] [MainThread]: 
[0m04:52:10.717198 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:52:10.718222 [info ] [MainThread]: 
[0m04:52:10.719053 [error] [MainThread]: [31mFailure in test unique_analysis_date (models/schema.yml)[0m
[0m04:52:10.719830 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m04:52:10.720425 [info ] [MainThread]: 
[0m04:52:10.721041 [info ] [MainThread]:   compiled code at target/compiled/dbt_proj_lab2/models/schema.yml/unique_analysis_date.sql
[0m04:52:10.721699 [info ] [MainThread]: 
[0m04:52:10.722346 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m04:52:10.727395 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 7.444704, "process_user_time": 4.933316, "process_kernel_time": 0.934175, "process_mem_max_rss": "190029824", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:52:10.730346 [debug] [MainThread]: Command `dbt test` failed at 04:52:10.729711 after 7.45 seconds
[0m04:52:10.731825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a695670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a72ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acc8890>]}
[0m04:52:10.732658 [debug] [MainThread]: Flushing usage events
[0m05:01:25.508554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c269f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2f6b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2f67e0>]}


============================== 05:01:25.514893 | 44444795-d58b-465f-becb-c6a4f8a01861 ==============================
[0m05:01:25.514893 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:01:25.515630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:01:28.116404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44444795-d58b-465f-becb-c6a4f8a01861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abe2120>]}
[0m05:01:28.188695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44444795-d58b-465f-becb-c6a4f8a01861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c5ad20>]}
[0m05:01:28.191711 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:01:28.217484 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:01:28.477859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m05:01:28.478777 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/schema.yml
[0m05:01:28.479250 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/analysis.sql
[0m05:01:28.747903 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:01:28.748634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '44444795-d58b-465f-becb-c6a4f8a01861', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ee44890>]}
[0m05:01:28.999394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44444795-d58b-465f-becb-c6a4f8a01861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f312b70>]}
[0m05:01:29.150248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44444795-d58b-465f-becb-c6a4f8a01861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f0e61b0>]}
[0m05:01:29.150919 [info ] [MainThread]: Found 1 snapshot, 1 model, 7 data tests, 1 source, 459 macros
[0m05:01:29.151366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44444795-d58b-465f-becb-c6a4f8a01861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f1f0a10>]}
[0m05:01:29.153692 [info ] [MainThread]: 
[0m05:01:29.154451 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:01:29.156033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:01:29.176314 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:01:29.176802 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:01:29.177172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:01:30.030656 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.853 seconds
[0m05:01:30.033088 [debug] [ThreadPool]: On list_dev: Close
[0m05:01:30.156890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:01:30.170023 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:01:30.170595 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:01:30.171052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:01:30.611700 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.441 seconds
[0m05:01:30.614869 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:01:30.747793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:01:30.752226 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:01:30.752759 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:01:30.753253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:01:31.313993 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.561 seconds
[0m05:01:31.317815 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:01:31.443087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44444795-d58b-465f-becb-c6a4f8a01861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f39b470>]}
[0m05:01:31.444028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:01:31.444584 [info ] [MainThread]: 
[0m05:01:31.449661 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.analysis
[0m05:01:31.450714 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.analysis ................................ [RUN]
[0m05:01:31.451524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.dbt_proj_lab2.analysis)
[0m05:01:31.452140 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.analysis
[0m05:01:31.465318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.analysis"
[0m05:01:31.467157 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.analysis
[0m05:01:31.519131 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.analysis"
[0m05:01:31.523126 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.analysis"
[0m05:01:31.523770 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.analysis"} */
create or replace transient table dev.analytics.analysis
         as
        (WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

-- Calculate price momentum
price_momentum_data AS (
    SELECT
        date,
        symbol,
        close - previous_close AS price_momentum
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate price change (used for RSI calculation)
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate gains and losses
gains_and_losses AS (
    SELECT
        date,
        symbol,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

-- Calculate the average gains and losses for RSI calculation
averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),

-- Calculate RSI based on average gains and losses
rsi_data AS (
    SELECT
        date,
        symbol,
        CASE 
            WHEN avg_loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
        END AS rsi
    FROM averages
),

-- Calculate the 7-day moving average
moving_avg_data AS (
    SELECT
        date,
        symbol,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
    FROM base_data
),

-- Combine all metrics ensuring uniqueness of dates
final_data AS (
    SELECT
        base_data.date,
        base_data.symbol,
        rsi_data.rsi,
        price_momentum_data.price_momentum,
        moving_avg_data.moving_avg_7d
    FROM base_data
    LEFT JOIN rsi_data
        ON base_data.date = rsi_data.date AND base_data.symbol = rsi_data.symbol
    LEFT JOIN price_momentum_data
        ON base_data.date = price_momentum_data.date AND base_data.symbol = price_momentum_data.symbol
    LEFT JOIN moving_avg_data
        ON base_data.date = moving_avg_data.date AND base_data.symbol = moving_avg_data.symbol
)

SELECT DISTINCT
    date,
    symbol,
    rsi,
    price_momentum,
    moving_avg_7d
FROM final_data
ORDER BY symbol, date;
[0m05:01:31.524408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:01:32.011693 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8634d-0004-2cec-0002-7073000176a6
[0m05:01:32.012558 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 98 at position 21 unexpected ';'.
[0m05:01:32.013401 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: Close
[0m05:01:32.150938 [debug] [Thread-1 (]: Database Error in model analysis (models/analysis.sql)
  001003 (42000): SQL compilation error:
  syntax error line 98 at position 21 unexpected ';'.
  compiled code at target/run/dbt_proj_lab2/models/analysis.sql
[0m05:01:32.153307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44444795-d58b-465f-becb-c6a4f8a01861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8b1e50>]}
[0m05:01:32.154251 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.analysis ....................... [[31mERROR[0m in 0.70s]
[0m05:01:32.155257 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.analysis
[0m05:01:32.157872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:01:32.158357 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.analysis' was properly closed.
[0m05:01:32.158854 [info ] [MainThread]: 
[0m05:01:32.159396 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m05:01:32.160857 [debug] [MainThread]: Command end result
[0m05:01:32.210046 [info ] [MainThread]: 
[0m05:01:32.210770 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:01:32.211291 [info ] [MainThread]: 
[0m05:01:32.212011 [error] [MainThread]:   Database Error in model analysis (models/analysis.sql)
  001003 (42000): SQL compilation error:
  syntax error line 98 at position 21 unexpected ';'.
  compiled code at target/run/dbt_proj_lab2/models/analysis.sql
[0m05:01:32.212647 [info ] [MainThread]: 
[0m05:01:32.213427 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:01:32.218144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.7886953, "process_user_time": 4.63226, "process_kernel_time": 1.004827, "process_mem_max_rss": "185884672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:01:32.219200 [debug] [MainThread]: Command `dbt run` failed at 05:01:32.218997 after 6.79 seconds
[0m05:01:32.219878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be91610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f02b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c12b800>]}
[0m05:01:32.220432 [debug] [MainThread]: Flushing usage events
[0m05:03:08.386406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111415c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c2ab0>]}


============================== 05:03:08.392201 | b7061611-aa7f-497b-8480-bdd861f38387 ==============================
[0m05:03:08.392201 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:03:08.392983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'debug': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:03:09.953282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7061611-aa7f-497b-8480-bdd861f38387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ee5790>]}
[0m05:03:10.017720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7061611-aa7f-497b-8480-bdd861f38387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c2f30>]}
[0m05:03:10.024983 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:03:10.048198 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:03:10.289899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:03:10.290716 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/analysis.sql
[0m05:03:10.595337 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:03:10.596492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b7061611-aa7f-497b-8480-bdd861f38387', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243e3380>]}
[0m05:03:10.857437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7061611-aa7f-497b-8480-bdd861f38387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244b09e0>]}
[0m05:03:11.026713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7061611-aa7f-497b-8480-bdd861f38387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124196f30>]}
[0m05:03:11.027464 [info ] [MainThread]: Found 1 snapshot, 1 model, 7 data tests, 1 source, 459 macros
[0m05:03:11.027927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7061611-aa7f-497b-8480-bdd861f38387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12454bb60>]}
[0m05:03:11.031127 [info ] [MainThread]: 
[0m05:03:11.032042 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:03:11.033913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:03:11.052300 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:03:11.052808 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:03:11.053199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:03:11.643834 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.590 seconds
[0m05:03:11.646895 [debug] [ThreadPool]: On list_dev: Close
[0m05:03:11.764076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m05:03:11.777465 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:03:11.778112 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:03:11.778592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:03:12.253394 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.475 seconds
[0m05:03:12.256637 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:03:12.368590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m05:03:12.372533 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:03:12.373073 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:03:12.373568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:03:12.835992 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.462 seconds
[0m05:03:12.838924 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:03:12.947750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7061611-aa7f-497b-8480-bdd861f38387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244b3ec0>]}
[0m05:03:12.948619 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:03:12.949148 [info ] [MainThread]: 
[0m05:03:12.957757 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.analysis
[0m05:03:12.958782 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.analysis ................................ [RUN]
[0m05:03:12.959816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.analysis)
[0m05:03:12.960438 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.analysis
[0m05:03:12.973974 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.analysis"
[0m05:03:12.975104 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.analysis
[0m05:03:13.024353 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.analysis"
[0m05:03:13.028200 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.analysis"
[0m05:03:13.028838 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.analysis"} */
create or replace transient table dev.analytics.analysis
         as
        (WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

-- Calculate price momentum
price_momentum_data AS (
    SELECT
        date,
        symbol,
        close - previous_close AS price_momentum
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate price change (used for RSI calculation)
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate gains and losses
gains_and_losses AS (
    SELECT
        date,
        symbol,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

-- Calculate the average gains and losses for RSI calculation
averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),

-- Calculate RSI based on average gains and losses
rsi_data AS (
    SELECT
        date,
        symbol,
        CASE 
            WHEN avg_loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
        END AS rsi
    FROM averages
),

-- Calculate the 7-day moving average
moving_avg_data AS (
    SELECT
        date,
        symbol,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
    FROM base_data
),

-- Combine all metrics ensuring uniqueness of dates
final_data AS (
    SELECT
        base_data.date,
        base_data.symbol,
        rsi_data.rsi,
        price_momentum_data.price_momentum,
        moving_avg_data.moving_avg_7d
    FROM base_data
    LEFT JOIN rsi_data
        ON base_data.date = rsi_data.date AND base_data.symbol = rsi_data.symbol
    LEFT JOIN price_momentum_data
        ON base_data.date = price_momentum_data.date AND base_data.symbol = price_momentum_data.symbol
    LEFT JOIN moving_avg_data
        ON base_data.date = moving_avg_data.date AND base_data.symbol = moving_avg_data.symbol
)

SELECT DISTINCT
    date,
    symbol,
    rsi,
    price_momentum,
    moving_avg_7d
FROM final_data
ORDER BY symbol, date
        );
[0m05:03:13.029577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:14.770790 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.741 seconds
[0m05:03:14.801346 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: Close
[0m05:03:14.927542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7061611-aa7f-497b-8480-bdd861f38387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b5e1b0>]}
[0m05:03:14.928602 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.analysis ........................... [[32mSUCCESS 1[0m in 1.97s]
[0m05:03:14.929584 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.analysis
[0m05:03:14.931311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:03:14.931800 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.analysis' was properly closed.
[0m05:03:14.932290 [info ] [MainThread]: 
[0m05:03:14.932829 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m05:03:14.933866 [debug] [MainThread]: Command end result
[0m05:03:14.975973 [info ] [MainThread]: 
[0m05:03:14.976592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:03:14.977026 [info ] [MainThread]: 
[0m05:03:14.977573 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:03:14.980810 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.677638, "process_user_time": 4.574924, "process_kernel_time": 0.705574, "process_mem_max_rss": "186126336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:03:14.982131 [debug] [MainThread]: Command `dbt run` succeeded at 05:03:14.981892 after 6.68 seconds
[0m05:03:14.982734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124340890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111050ec0>]}
[0m05:03:14.983212 [debug] [MainThread]: Flushing usage events
[0m05:07:13.186896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f68cf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101dab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101da8d0>]}


============================== 05:07:13.201835 | 8b1afccd-d20a-46ea-9cc3-e4143d8b3582 ==============================
[0m05:07:13.201835 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:07:13.202663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:07:15.497134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b1afccd-d20a-46ea-9cc3-e4143d8b3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228aafc0>]}
[0m05:07:15.562644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b1afccd-d20a-46ea-9cc3-e4143d8b3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e2ec00>]}
[0m05:07:15.565609 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:07:15.589623 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:07:15.857554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:07:15.858349 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/analysis.sql
[0m05:07:16.126818 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:07:16.127631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b1afccd-d20a-46ea-9cc3-e4143d8b3582', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f7c8c0>]}
[0m05:07:16.380060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b1afccd-d20a-46ea-9cc3-e4143d8b3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ff4680>]}
[0m05:07:16.535700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b1afccd-d20a-46ea-9cc3-e4143d8b3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123166db0>]}
[0m05:07:16.536317 [info ] [MainThread]: Found 1 snapshot, 1 model, 7 data tests, 1 source, 459 macros
[0m05:07:16.536775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b1afccd-d20a-46ea-9cc3-e4143d8b3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f991f0>]}
[0m05:07:16.539113 [info ] [MainThread]: 
[0m05:07:16.539821 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:07:16.541415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:07:16.563212 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:07:16.563716 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:07:16.564093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:07:17.232707 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.668 seconds
[0m05:07:17.235819 [debug] [ThreadPool]: On list_dev: Close
[0m05:07:17.351782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:07:17.365358 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:07:17.365942 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:07:17.366481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:07:17.838124 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.472 seconds
[0m05:07:17.841311 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:07:17.987083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:07:17.991514 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:07:17.992048 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:07:17.992541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:07:18.493982 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.501 seconds
[0m05:07:18.496876 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:07:18.632077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b1afccd-d20a-46ea-9cc3-e4143d8b3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123263890>]}
[0m05:07:18.633125 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:07:18.633687 [info ] [MainThread]: 
[0m05:07:18.636932 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.analysis
[0m05:07:18.637782 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.analysis ................................ [RUN]
[0m05:07:18.638551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.dbt_proj_lab2.analysis)
[0m05:07:18.639239 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.analysis
[0m05:07:18.650988 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.analysis"
[0m05:07:18.652370 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.analysis
[0m05:07:18.699987 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.analysis"
[0m05:07:18.703277 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.analysis"
[0m05:07:18.703886 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.analysis"} */
create or replace transient table dev.analytics.analysis
         as
        (WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

-- Calculate price change (used for RSI calculation)
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate gains and losses
gains_and_losses AS (
    SELECT
        date,
        symbol,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

-- Calculate the average gains and losses for RSI calculation
averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),

-- Calculate RSI based on average gains and losses
rsi_data AS (
    SELECT
        date,
        symbol,
        CASE 
            WHEN avg_loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
        END AS rsi
    FROM averages
),

-- Calculate the 7-day moving average
moving_avg_data AS (
    SELECT
        date,
        symbol,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
    FROM base_data
)

-- Combine the RSI and moving average into the final dataset
SELECT DISTINCT
    rsi_data.date,
    rsi_data.symbol,
    rsi_data.rsi,
    moving_avg_data.moving_avg_7d
FROM rsi_data
JOIN moving_avg_data
    ON rsi_data.date = moving_avg_data.date AND rsi_data.symbol = moving_avg_data.symbol
ORDER BY rsi_data.symbol, rsi_data.date;
[0m05:07:18.704477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:07:19.121752 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86353-0004-2ceb-0002-70730001271e
[0m05:07:19.122416 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 73 at position 39 unexpected ';'.
[0m05:07:19.123154 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: Close
[0m05:07:19.248855 [debug] [Thread-1 (]: Database Error in model analysis (models/analysis.sql)
  001003 (42000): SQL compilation error:
  syntax error line 73 at position 39 unexpected ';'.
  compiled code at target/run/dbt_proj_lab2/models/analysis.sql
[0m05:07:19.250756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b1afccd-d20a-46ea-9cc3-e4143d8b3582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f771e50>]}
[0m05:07:19.251636 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.analysis ....................... [[31mERROR[0m in 0.61s]
[0m05:07:19.252583 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.analysis
[0m05:07:19.255017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:07:19.255508 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.analysis' was properly closed.
[0m05:07:19.255953 [info ] [MainThread]: 
[0m05:07:19.256459 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m05:07:19.258360 [debug] [MainThread]: Command end result
[0m05:07:19.306857 [info ] [MainThread]: 
[0m05:07:19.308091 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:07:19.309507 [info ] [MainThread]: 
[0m05:07:19.310536 [error] [MainThread]:   Database Error in model analysis (models/analysis.sql)
  001003 (42000): SQL compilation error:
  syntax error line 73 at position 39 unexpected ';'.
  compiled code at target/run/dbt_proj_lab2/models/analysis.sql
[0m05:07:19.311064 [info ] [MainThread]: 
[0m05:07:19.311546 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:07:19.314861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.2890954, "process_user_time": 4.72823, "process_kernel_time": 1.010107, "process_mem_max_rss": "185712640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:07:19.315699 [debug] [MainThread]: Command `dbt run` failed at 05:07:19.315558 after 6.29 seconds
[0m05:07:19.316222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec58380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ae6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101dab10>]}
[0m05:07:19.316678 [debug] [MainThread]: Flushing usage events
[0m05:07:33.262210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030dc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104196d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104196b10>]}


============================== 05:07:33.266701 | cf9a2508-c667-4c74-be03-0139c11cb764 ==============================
[0m05:07:33.266701 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:07:33.267503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:07:34.402101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf9a2508-c667-4c74-be03-0139c11cb764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c67350>]}
[0m05:07:34.465087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf9a2508-c667-4c74-be03-0139c11cb764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115714cb0>]}
[0m05:07:34.466055 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:07:34.486680 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:07:34.658785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:07:34.659608 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/analysis.sql
[0m05:07:34.931046 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:07:34.931794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cf9a2508-c667-4c74-be03-0139c11cb764', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f86000>]}
[0m05:07:35.174799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf9a2508-c667-4c74-be03-0139c11cb764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117157260>]}
[0m05:07:35.311341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf9a2508-c667-4c74-be03-0139c11cb764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116e68740>]}
[0m05:07:35.311924 [info ] [MainThread]: Found 1 snapshot, 1 model, 7 data tests, 1 source, 459 macros
[0m05:07:35.312366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf9a2508-c667-4c74-be03-0139c11cb764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117227140>]}
[0m05:07:35.314649 [info ] [MainThread]: 
[0m05:07:35.315393 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:07:35.317009 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:07:35.336356 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:07:35.336923 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:07:35.337413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:07:35.899860 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.562 seconds
[0m05:07:35.903030 [debug] [ThreadPool]: On list_dev: Close
[0m05:07:36.013480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m05:07:36.026494 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:07:36.027100 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:07:36.027560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:07:36.503249 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.476 seconds
[0m05:07:36.506459 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:07:36.628517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m05:07:36.632284 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:07:36.632795 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:07:36.633266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:07:37.042574 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.409 seconds
[0m05:07:37.045157 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:07:37.185660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf9a2508-c667-4c74-be03-0139c11cb764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116cafec0>]}
[0m05:07:37.186632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:07:37.187196 [info ] [MainThread]: 
[0m05:07:37.189818 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.analysis
[0m05:07:37.190645 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.analysis ................................ [RUN]
[0m05:07:37.191358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.analysis)
[0m05:07:37.191967 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.analysis
[0m05:07:37.204678 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.analysis"
[0m05:07:37.206259 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.analysis
[0m05:07:37.253456 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.analysis"
[0m05:07:37.256245 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.analysis"
[0m05:07:37.256804 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.analysis"} */
create or replace transient table dev.analytics.analysis
         as
        (WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

-- Calculate price change (used for RSI calculation)
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate gains and losses
gains_and_losses AS (
    SELECT
        date,
        symbol,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

-- Calculate the average gains and losses for RSI calculation
averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),

-- Calculate RSI based on average gains and losses
rsi_data AS (
    SELECT
        date,
        symbol,
        CASE 
            WHEN avg_loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
        END AS rsi
    FROM averages
),

-- Calculate the 7-day moving average
moving_avg_data AS (
    SELECT
        date,
        symbol,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
    FROM base_data
)

-- Combine the RSI and moving average into the final dataset
SELECT DISTINCT
    rsi_data.date,
    rsi_data.symbol,
    rsi_data.rsi,
    moving_avg_data.moving_avg_7d
FROM rsi_data
JOIN moving_avg_data
    ON rsi_data.date = moving_avg_data.date AND rsi_data.symbol = moving_avg_data.symbol
ORDER BY rsi_data.symbol, rsi_data.date
        );
[0m05:07:37.257340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:07:38.801750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.544 seconds
[0m05:07:38.835080 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: Close
[0m05:07:38.953258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf9a2508-c667-4c74-be03-0139c11cb764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10375a030>]}
[0m05:07:38.954343 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.analysis ........................... [[32mSUCCESS 1[0m in 1.76s]
[0m05:07:38.955379 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.analysis
[0m05:07:38.957339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:07:38.957905 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.analysis' was properly closed.
[0m05:07:38.958428 [info ] [MainThread]: 
[0m05:07:38.959016 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m05:07:38.960368 [debug] [MainThread]: Command end result
[0m05:07:39.009091 [info ] [MainThread]: 
[0m05:07:39.009768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:07:39.010283 [info ] [MainThread]: 
[0m05:07:39.010949 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:07:39.013633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.820907, "process_user_time": 4.059651, "process_kernel_time": 0.417613, "process_mem_max_rss": "186097664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:07:39.014537 [debug] [MainThread]: Command `dbt run` succeeded at 05:07:39.014383 after 5.82 seconds
[0m05:07:39.015199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c641d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104196e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104196e40>]}
[0m05:07:39.015777 [debug] [MainThread]: Flushing usage events
[0m05:10:03.463532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10823f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108736b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087368d0>]}


============================== 05:10:03.468068 | f2910b22-dd5e-4e01-be90-5fbeacb9c58e ==============================
[0m05:10:03.468068 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:10:03.468838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:10:04.639341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2910b22-dd5e-4e01-be90-5fbeacb9c58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b02e630>]}
[0m05:10:04.703911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2910b22-dd5e-4e01-be90-5fbeacb9c58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a65af00>]}
[0m05:10:04.704835 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:10:04.727403 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:10:04.896138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:10:04.897324 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/analysis.sql
[0m05:10:05.156389 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:10:05.157257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f2910b22-dd5e-4e01-be90-5fbeacb9c58e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b5ef470>]}
[0m05:10:05.391502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2910b22-dd5e-4e01-be90-5fbeacb9c58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2a5c10>]}
[0m05:10:05.535106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2910b22-dd5e-4e01-be90-5fbeacb9c58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b26c350>]}
[0m05:10:05.535776 [info ] [MainThread]: Found 1 snapshot, 1 model, 7 data tests, 1 source, 459 macros
[0m05:10:05.536321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2910b22-dd5e-4e01-be90-5fbeacb9c58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3d8e60>]}
[0m05:10:05.538910 [info ] [MainThread]: 
[0m05:10:05.539814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:10:05.541690 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:10:05.569942 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:10:05.570591 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:10:05.571117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:10:06.262489 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.691 seconds
[0m05:10:06.265595 [debug] [ThreadPool]: On list_dev: Close
[0m05:10:06.392707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:10:06.405984 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:10:06.406569 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:10:06.407032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:06.891975 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.485 seconds
[0m05:10:06.895319 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:10:06.998676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:10:07.004251 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:10:07.005074 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:10:07.005953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:07.465685 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.460 seconds
[0m05:10:07.467749 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:10:07.592715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2910b22-dd5e-4e01-be90-5fbeacb9c58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b76e630>]}
[0m05:10:07.593704 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:10:07.594318 [info ] [MainThread]: 
[0m05:10:07.596925 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.analysis
[0m05:10:07.597734 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.analysis ................................ [RUN]
[0m05:10:07.598453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.dbt_proj_lab2.analysis)
[0m05:10:07.599014 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.analysis
[0m05:10:07.611065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.analysis"
[0m05:10:07.612160 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.analysis
[0m05:10:07.660853 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.analysis"
[0m05:10:07.663982 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.analysis"
[0m05:10:07.664559 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.analysis"} */
create or replace transient table dev.analytics.analysis
         as
        (WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

-- Calculate price change (used for RSI calculation)
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate gains and losses
gains_and_losses AS (
    SELECT
        date,
        symbol,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

-- Calculate the average gains and losses for RSI calculation
averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),

-- Calculate RSI based on average gains and losses
rsi_data AS (
    SELECT
        date,
        symbol,
        CASE 
            WHEN avg_loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
        END AS rsi
    FROM averages
),

-- Calculate the 7-day moving average
moving_avg_data AS (
    SELECT
        date,
        symbol,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
    FROM base_data
),

-- Use ROW_NUMBER to ensure we only take the first row per symbol and date
ranked_data AS (
    SELECT
        rsi_data.date,
        rsi_data.symbol,
        rsi_data.rsi,
        moving_avg_data.moving_avg_7d,
        ROW_NUMBER() OVER (PARTITION BY rsi_data.symbol, rsi_data.date ORDER BY rsi_data.date) AS rn
    FROM rsi_data
    JOIN moving_avg_data
        ON rsi_data.date = moving_avg_data.date AND rsi_data.symbol = moving_avg_data.symbol
)

-- Select only the rows with rank 1 (the first occurrence per symbol and date)
SELECT 
    date,
    symbol,
    rsi,
    moving_avg_7d
FROM ranked_data
WHERE rn = 1
ORDER BY symbol, date;
[0m05:10:07.665143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:10:08.127757 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86356-0004-2cf4-0002-7073000146f6
[0m05:10:08.128460 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 85 at position 21 unexpected ';'.
[0m05:10:08.129194 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: Close
[0m05:10:08.267521 [debug] [Thread-1 (]: Database Error in model analysis (models/analysis.sql)
  001003 (42000): SQL compilation error:
  syntax error line 85 at position 21 unexpected ';'.
  compiled code at target/run/dbt_proj_lab2/models/analysis.sql
[0m05:10:08.269644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2910b22-dd5e-4e01-be90-5fbeacb9c58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd5fd0>]}
[0m05:10:08.270557 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.analysis ....................... [[31mERROR[0m in 0.67s]
[0m05:10:08.271533 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.analysis
[0m05:10:08.274040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:10:08.274526 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.analysis' was properly closed.
[0m05:10:08.275018 [info ] [MainThread]: 
[0m05:10:08.275560 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m05:10:08.276794 [debug] [MainThread]: Command end result
[0m05:10:08.321203 [info ] [MainThread]: 
[0m05:10:08.321879 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:10:08.322417 [info ] [MainThread]: 
[0m05:10:08.323054 [error] [MainThread]:   Database Error in model analysis (models/analysis.sql)
  001003 (42000): SQL compilation error:
  syntax error line 85 at position 21 unexpected ';'.
  compiled code at target/run/dbt_proj_lab2/models/analysis.sql
[0m05:10:08.323543 [info ] [MainThread]: 
[0m05:10:08.324302 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:10:08.326616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.9340744, "process_user_time": 4.019687, "process_kernel_time": 0.42934, "process_mem_max_rss": "185929728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:10:08.328263 [debug] [MainThread]: Command `dbt run` failed at 05:10:08.327992 after 4.94 seconds
[0m05:10:08.329076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c43b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b424a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108736b10>]}
[0m05:10:08.329709 [debug] [MainThread]: Flushing usage events
[0m05:10:16.701650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b122d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b56b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b56870>]}


============================== 05:10:16.706238 | 9064d838-5b29-4345-9713-7655eafcfaae ==============================
[0m05:10:16.706238 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:10:16.707087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:10:17.813236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9064d838-5b29-4345-9713-7655eafcfaae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123532ab0>]}
[0m05:10:17.875269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9064d838-5b29-4345-9713-7655eafcfaae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122841760>]}
[0m05:10:17.876192 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:10:17.899974 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:10:18.070447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:10:18.071249 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/analysis.sql
[0m05:10:18.322947 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:10:18.323755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9064d838-5b29-4345-9713-7655eafcfaae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239b9340>]}
[0m05:10:18.563261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9064d838-5b29-4345-9713-7655eafcfaae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a25910>]}
[0m05:10:18.695229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9064d838-5b29-4345-9713-7655eafcfaae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237d8440>]}
[0m05:10:18.695842 [info ] [MainThread]: Found 1 snapshot, 1 model, 7 data tests, 1 source, 459 macros
[0m05:10:18.696343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9064d838-5b29-4345-9713-7655eafcfaae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238ee5a0>]}
[0m05:10:18.698589 [info ] [MainThread]: 
[0m05:10:18.699351 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:10:18.700913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:10:18.719872 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:10:18.720370 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:10:18.720748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:10:19.264783 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.544 seconds
[0m05:10:19.267094 [debug] [ThreadPool]: On list_dev: Close
[0m05:10:19.373969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m05:10:19.387312 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:10:19.387866 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:10:19.388336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:19.831460 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.443 seconds
[0m05:10:19.834679 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:10:19.939606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m05:10:19.943539 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:10:19.944081 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:10:19.944579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:20.409933 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.465 seconds
[0m05:10:20.412998 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:10:20.534940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9064d838-5b29-4345-9713-7655eafcfaae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122843530>]}
[0m05:10:20.535919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:10:20.536477 [info ] [MainThread]: 
[0m05:10:20.539003 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.analysis
[0m05:10:20.539830 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.analysis ................................ [RUN]
[0m05:10:20.540605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.analysis)
[0m05:10:20.541249 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.analysis
[0m05:10:20.552900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.analysis"
[0m05:10:20.553958 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.analysis
[0m05:10:20.601722 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.analysis"
[0m05:10:20.605010 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.analysis"
[0m05:10:20.605626 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.analysis"} */
create or replace transient table dev.analytics.analysis
         as
        (WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

-- Calculate price change (used for RSI calculation)
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate gains and losses
gains_and_losses AS (
    SELECT
        date,
        symbol,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

-- Calculate the average gains and losses for RSI calculation
averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),

-- Calculate RSI based on average gains and losses
rsi_data AS (
    SELECT
        date,
        symbol,
        CASE 
            WHEN avg_loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
        END AS rsi
    FROM averages
),

-- Calculate the 7-day moving average
moving_avg_data AS (
    SELECT
        date,
        symbol,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
    FROM base_data
),

-- Use ROW_NUMBER to ensure we only take the first row per symbol and date
ranked_data AS (
    SELECT
        rsi_data.date,
        rsi_data.symbol,
        rsi_data.rsi,
        moving_avg_data.moving_avg_7d,
        ROW_NUMBER() OVER (PARTITION BY rsi_data.symbol, rsi_data.date ORDER BY rsi_data.date) AS rn
    FROM rsi_data
    JOIN moving_avg_data
        ON rsi_data.date = moving_avg_data.date AND rsi_data.symbol = moving_avg_data.symbol
)

-- Select only the rows with rank 1 (the first occurrence per symbol and date)
SELECT 
    date,
    symbol,
    rsi,
    moving_avg_7d
FROM ranked_data
WHERE rn = 1
ORDER BY symbol, date
        );
[0m05:10:20.606247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:10:22.197016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.591 seconds
[0m05:10:22.231096 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: Close
[0m05:10:22.371018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9064d838-5b29-4345-9713-7655eafcfaae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f5dc0>]}
[0m05:10:22.371871 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.analysis ........................... [[32mSUCCESS 1[0m in 1.83s]
[0m05:10:22.372682 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.analysis
[0m05:10:22.374218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:10:22.374603 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.analysis' was properly closed.
[0m05:10:22.374993 [info ] [MainThread]: 
[0m05:10:22.375602 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m05:10:22.376574 [debug] [MainThread]: Command end result
[0m05:10:22.418940 [info ] [MainThread]: 
[0m05:10:22.420233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:10:22.420790 [info ] [MainThread]: 
[0m05:10:22.421336 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:10:22.423744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.796384, "process_user_time": 4.013847, "process_kernel_time": 0.411713, "process_mem_max_rss": "184741888", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:10:22.424934 [debug] [MainThread]: Command `dbt run` succeeded at 05:10:22.424597 after 5.80 seconds
[0m05:10:22.425563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11079b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12358fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f4800>]}
[0m05:10:22.426041 [debug] [MainThread]: Flushing usage events
[0m05:25:29.792026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c69f0>]}


============================== 05:25:29.799513 | 6935b369-dd64-40ca-9d27-7c95e1c39add ==============================
[0m05:25:29.799513 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:25:29.800410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m05:25:32.197419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6935b369-dd64-40ca-9d27-7c95e1c39add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb2030>]}
[0m05:25:32.263602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6935b369-dd64-40ca-9d27-7c95e1c39add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ff8c0>]}
[0m05:25:32.265743 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:25:32.294831 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:25:32.564321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:25:32.565162 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/analysis.sql
[0m05:25:32.836769 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:25:32.837539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6935b369-dd64-40ca-9d27-7c95e1c39add', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119fecef0>]}
[0m05:25:33.083270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6935b369-dd64-40ca-9d27-7c95e1c39add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2ac7a0>]}
[0m05:25:33.237609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6935b369-dd64-40ca-9d27-7c95e1c39add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a283470>]}
[0m05:25:33.238197 [info ] [MainThread]: Found 1 snapshot, 1 model, 7 data tests, 1 source, 459 macros
[0m05:25:33.238627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6935b369-dd64-40ca-9d27-7c95e1c39add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068853d0>]}
[0m05:25:33.240923 [info ] [MainThread]: 
[0m05:25:33.241745 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:25:33.243332 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:25:33.263320 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:25:33.264287 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:25:33.264717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:33.892660 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.627 seconds
[0m05:25:33.896302 [debug] [ThreadPool]: On list_dev: Close
[0m05:25:34.015060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:25:34.028307 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:25:34.028880 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:25:34.029352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:34.486164 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.457 seconds
[0m05:25:34.489530 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:25:34.612835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:25:34.617311 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:25:34.617951 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:25:34.618477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:35.096084 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.478 seconds
[0m05:25:35.098846 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:25:35.216108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6935b369-dd64-40ca-9d27-7c95e1c39add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a188290>]}
[0m05:25:35.217088 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:25:35.217717 [info ] [MainThread]: 
[0m05:25:35.221070 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.analysis
[0m05:25:35.221943 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.analysis ................................ [RUN]
[0m05:25:35.222655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.dbt_proj_lab2.analysis)
[0m05:25:35.223347 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.analysis
[0m05:25:35.236977 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.analysis"
[0m05:25:35.240053 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.analysis
[0m05:25:35.285960 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.analysis"
[0m05:25:35.291440 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.analysis"
[0m05:25:35.292168 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.analysis"} */
create or replace transient table dev.analytics.analysis
         as
        (WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

-- Calculate price change (used for RSI calculation)
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate gains and losses for RSI calculation
gains_and_losses AS (
    SELECT
        date,
        symbol,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

-- Calculate the average gains and losses for RSI calculation (14-day period)
averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),

-- Calculate RSI based on average gains and losses
rsi_data AS (
    SELECT
        date,
        symbol,
        CASE 
            WHEN avg_loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
        END AS rsi
    FROM averages
),

-- Calculate the 7-day moving average for CLOSE prices
moving_avg_data AS (
    SELECT
        date,
        symbol,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
    FROM base_data
)

-- Final SELECT: Combine the RSI and Moving Average data
SELECT
    rsi_data.date,
    rsi_data.symbol,
    rsi_data.rsi,
    moving_avg_data.moving_avg_7d
FROM rsi_data
JOIN moving_avg_data
    ON rsi_data.date = moving_avg_data.date AND rsi_data.symbol = moving_avg_data.symbol
ORDER BY rsi_data.symbol, rsi_data.date
        );
[0m05:25:35.292805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:25:36.440468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.147 seconds
[0m05:25:36.475141 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: Close
[0m05:25:36.591388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6935b369-dd64-40ca-9d27-7c95e1c39add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5d18e0>]}
[0m05:25:36.592266 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.analysis ........................... [[32mSUCCESS 1[0m in 1.37s]
[0m05:25:36.593092 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.analysis
[0m05:25:36.594573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:25:36.594966 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.analysis' was properly closed.
[0m05:25:36.595361 [info ] [MainThread]: 
[0m05:25:36.595804 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m05:25:36.596657 [debug] [MainThread]: Command end result
[0m05:25:36.633156 [info ] [MainThread]: 
[0m05:25:36.633919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:25:36.634393 [info ] [MainThread]: 
[0m05:25:36.634889 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:25:36.638307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9321804, "process_user_time": 4.622024, "process_kernel_time": 0.948742, "process_mem_max_rss": "185159680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:25:36.639332 [debug] [MainThread]: Command `dbt run` succeeded at 05:25:36.639130 after 6.93 seconds
[0m05:25:36.640236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d32cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c6c60>]}
[0m05:25:36.640718 [debug] [MainThread]: Flushing usage events
[0m05:26:41.937249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5835f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d876c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d876a20>]}


============================== 05:26:41.943723 | 4df16563-f510-48f7-acc3-f9357d077865 ==============================
[0m05:26:41.943723 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:26:41.944444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:26:44.202167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4df16563-f510-48f7-acc3-f9357d077865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8771a0>]}
[0m05:26:44.266732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4df16563-f510-48f7-acc3-f9357d077865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c774920>]}
[0m05:26:44.270588 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:26:44.297014 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:26:44.553767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:26:44.554619 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/analysis.sql
[0m05:26:44.832429 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:26:44.833186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4df16563-f510-48f7-acc3-f9357d077865', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205e5430>]}
[0m05:26:45.079538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4df16563-f510-48f7-acc3-f9357d077865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207f9910>]}
[0m05:26:45.234450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4df16563-f510-48f7-acc3-f9357d077865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204b67e0>]}
[0m05:26:45.235051 [info ] [MainThread]: Found 1 snapshot, 1 model, 7 data tests, 1 source, 459 macros
[0m05:26:45.235507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4df16563-f510-48f7-acc3-f9357d077865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120601b80>]}
[0m05:26:45.237789 [info ] [MainThread]: 
[0m05:26:45.238501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:26:45.240084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:26:45.257393 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:26:45.257876 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:26:45.258248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:26:45.934973 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.675 seconds
[0m05:26:45.938552 [debug] [ThreadPool]: On list_dev: Close
[0m05:26:46.072844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:26:46.086294 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:26:46.086874 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:26:46.087365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:26:46.608545 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.521 seconds
[0m05:26:46.611567 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:26:46.733360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:26:46.737170 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:26:46.737710 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:26:46.738142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:26:47.420553 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.682 seconds
[0m05:26:47.423466 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:26:47.550507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4df16563-f510-48f7-acc3-f9357d077865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a239e0>]}
[0m05:26:47.551560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:26:47.552187 [info ] [MainThread]: 
[0m05:26:47.560657 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.analysis
[0m05:26:47.561661 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.analysis ................................ [RUN]
[0m05:26:47.562653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.dbt_proj_lab2.analysis)
[0m05:26:47.563671 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.analysis
[0m05:26:47.577897 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.analysis"
[0m05:26:47.581299 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.analysis
[0m05:26:47.632878 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.analysis"
[0m05:26:47.636142 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.analysis"
[0m05:26:47.636735 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.analysis"} */
create or replace transient table dev.analytics.analysis
         as
        (WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

-- Calculate price change (used for RSI calculation)
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate gains and losses
gains_and_losses AS (
    SELECT
        date,
        symbol,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

-- Calculate the average gains and losses for RSI calculation
averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),

-- Calculate RSI based on average gains and losses
rsi_data AS (
    SELECT
        date,
        symbol,
        CASE 
            WHEN avg_loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
        END AS rsi
    FROM averages
),

-- Calculate the 7-day moving average
moving_avg_data AS (
    SELECT
        date,
        symbol,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
    FROM base_data
),

-- Use ROW_NUMBER to ensure we only take the first row per symbol and date
ranked_data AS (
    SELECT
        rsi_data.date,
        rsi_data.symbol,
        rsi_data.rsi,
        moving_avg_data.moving_avg_7d,
        ROW_NUMBER() OVER (PARTITION BY rsi_data.symbol, rsi_data.date ORDER BY rsi_data.date) AS rn
    FROM rsi_data
    JOIN moving_avg_data
        ON rsi_data.date = moving_avg_data.date AND rsi_data.symbol = moving_avg_data.symbol
)

-- Select only the rows with rank 1 (the first occurrence per symbol and date)
SELECT 
    date,
    symbol,
    rsi,
    moving_avg_7d
FROM ranked_data
WHERE rn = 1
ORDER BY symbol, date
        );
[0m05:26:47.637308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:26:48.734510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.097 seconds
[0m05:26:48.764579 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: Close
[0m05:26:48.879898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4df16563-f510-48f7-acc3-f9357d077865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce0e1e0>]}
[0m05:26:48.881063 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.analysis ........................... [[32mSUCCESS 1[0m in 1.32s]
[0m05:26:48.882071 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.analysis
[0m05:26:48.883824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:26:48.884325 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.analysis' was properly closed.
[0m05:26:48.884808 [info ] [MainThread]: 
[0m05:26:48.885316 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m05:26:48.886181 [debug] [MainThread]: Command end result
[0m05:26:48.928531 [info ] [MainThread]: 
[0m05:26:48.929311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:26:48.929974 [info ] [MainThread]: 
[0m05:26:48.931416 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:26:48.936741 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0814705, "process_user_time": 4.685565, "process_kernel_time": 0.903196, "process_mem_max_rss": "184455168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:26:48.937699 [debug] [MainThread]: Command `dbt run` succeeded at 05:26:48.937537 after 7.08 seconds
[0m05:26:48.938430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205a1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d876b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d876c60>]}
[0m05:26:48.939236 [debug] [MainThread]: Flushing usage events
[0m05:28:03.687270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112edf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111496c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111496960>]}


============================== 05:28:03.693993 | fdee61c8-48c0-4852-97fa-b693b6556c64 ==============================
[0m05:28:03.693993 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:28:03.694913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:28:05.899905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdee61c8-48c0-4852-97fa-b693b6556c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f1b560>]}
[0m05:28:05.968291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdee61c8-48c0-4852-97fa-b693b6556c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d6fb60>]}
[0m05:28:05.969799 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:28:05.993678 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:28:06.235610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:28:06.236085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:28:06.302024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdee61c8-48c0-4852-97fa-b693b6556c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f9e5a0>]}
[0m05:28:06.470622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdee61c8-48c0-4852-97fa-b693b6556c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124092f90>]}
[0m05:28:06.471244 [info ] [MainThread]: Found 1 snapshot, 1 model, 7 data tests, 1 source, 459 macros
[0m05:28:06.471717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdee61c8-48c0-4852-97fa-b693b6556c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112000ef0>]}
[0m05:28:06.474377 [info ] [MainThread]: 
[0m05:28:06.475190 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:28:06.476356 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m05:28:06.501763 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:28:06.502296 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:28:06.502725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:28:07.264442 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.762 seconds
[0m05:28:07.268268 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:28:07.383646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:28:07.389168 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:28:07.389714 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:28:07.390174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:28:07.859125 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.469 seconds
[0m05:28:07.861846 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:28:07.986503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdee61c8-48c0-4852-97fa-b693b6556c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f9f050>]}
[0m05:28:07.987489 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:28:07.988107 [info ] [MainThread]: 
[0m05:28:07.997298 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.expression_is_true_analysis_rsi__rsi_BETWEEN_0_AND_100.58e799c211
[0m05:28:07.998194 [info ] [Thread-1 (]: 1 of 7 START test expression_is_true_analysis_rsi__rsi_BETWEEN_0_AND_100 ....... [RUN]
[0m05:28:07.999481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.dbt_proj_lab2.expression_is_true_analysis_rsi__rsi_BETWEEN_0_AND_100.58e799c211)
[0m05:28:08.000800 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.expression_is_true_analysis_rsi__rsi_BETWEEN_0_AND_100.58e799c211
[0m05:28:08.042282 [debug] [Thread-1 (]: Compilation Error in test expression_is_true_analysis_rsi__rsi_BETWEEN_0_AND_100 (models/schema.yml)
  'test_expression_is_true' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:28:08.043496 [error] [Thread-1 (]: 1 of 7 ERROR expression_is_true_analysis_rsi__rsi_BETWEEN_0_AND_100 ............ [[31mERROR[0m in 0.04s]
[0m05:28:08.044821 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.expression_is_true_analysis_rsi__rsi_BETWEEN_0_AND_100.58e799c211
[0m05:28:08.045667 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:28:08.047315 [info ] [Thread-1 (]: 2 of 7 START test not_null_analysis_date ....................................... [RUN]
[0m05:28:08.048202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.expression_is_true_analysis_rsi__rsi_BETWEEN_0_AND_100.58e799c211, now test.dbt_proj_lab2.not_null_analysis_date.82ab678f33)
[0m05:28:08.048801 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:28:08.067223 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:28:08.069085 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:28:08.097422 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:28:08.098697 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:28:08.099190 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.analysis
where date is null



      
    ) dbt_internal_test
[0m05:28:08.099650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:28:08.622774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m05:28:08.641895 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: Close
[0m05:28:08.785168 [info ] [Thread-1 (]: 2 of 7 PASS not_null_analysis_date ............................................. [[32mPASS[0m in 0.74s]
[0m05:28:08.786508 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:28:08.787303 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_moving_avg_7d.965e898456
[0m05:28:08.787939 [info ] [Thread-1 (]: 3 of 7 START test not_null_analysis_moving_avg_7d .............................. [RUN]
[0m05:28:08.788784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_date.82ab678f33, now test.dbt_proj_lab2.not_null_analysis_moving_avg_7d.965e898456)
[0m05:28:08.789444 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_moving_avg_7d.965e898456
[0m05:28:08.796797 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_moving_avg_7d.965e898456"
[0m05:28:08.797982 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_moving_avg_7d.965e898456
[0m05:28:08.801729 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_moving_avg_7d.965e898456"
[0m05:28:08.803246 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_moving_avg_7d.965e898456"
[0m05:28:08.803891 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_moving_avg_7d.965e898456: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_moving_avg_7d.965e898456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_7d
from dev.analytics.analysis
where moving_avg_7d is null



      
    ) dbt_internal_test
[0m05:28:08.804478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:28:09.427465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m05:28:09.430745 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_moving_avg_7d.965e898456: Close
[0m05:28:09.571669 [info ] [Thread-1 (]: 3 of 7 PASS not_null_analysis_moving_avg_7d .................................... [[32mPASS[0m in 0.78s]
[0m05:28:09.572957 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_moving_avg_7d.965e898456
[0m05:28:09.573668 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_price_momentum.ebb19a24ff
[0m05:28:09.574252 [info ] [Thread-1 (]: 4 of 7 START test not_null_analysis_price_momentum ............................. [RUN]
[0m05:28:09.575011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_moving_avg_7d.965e898456, now test.dbt_proj_lab2.not_null_analysis_price_momentum.ebb19a24ff)
[0m05:28:09.575609 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_price_momentum.ebb19a24ff
[0m05:28:09.584276 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_price_momentum.ebb19a24ff"
[0m05:28:09.585650 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_price_momentum.ebb19a24ff
[0m05:28:09.589364 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_price_momentum.ebb19a24ff"
[0m05:28:09.590817 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_price_momentum.ebb19a24ff"
[0m05:28:09.591401 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_price_momentum.ebb19a24ff: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_price_momentum.ebb19a24ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_momentum
from dev.analytics.analysis
where price_momentum is null



      
    ) dbt_internal_test
[0m05:28:09.591954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:28:10.057121 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86368-0004-2cec-0002-70730001774a
[0m05:28:10.058015 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'PRICE_MOMENTUM'
[0m05:28:10.058855 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_price_momentum.ebb19a24ff: Close
[0m05:28:10.183557 [debug] [Thread-1 (]: Database Error in test not_null_analysis_price_momentum (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'PRICE_MOMENTUM'
  compiled code at target/run/dbt_proj_lab2/models/schema.yml/not_null_analysis_price_momentum.sql
[0m05:28:10.184354 [error] [Thread-1 (]: 4 of 7 ERROR not_null_analysis_price_momentum .................................. [[31mERROR[0m in 0.61s]
[0m05:28:10.185319 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_price_momentum.ebb19a24ff
[0m05:28:10.185967 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_rsi.ed61ffb3c8
[0m05:28:10.186549 [info ] [Thread-1 (]: 5 of 7 START test not_null_analysis_rsi ........................................ [RUN]
[0m05:28:10.187217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_price_momentum.ebb19a24ff, now test.dbt_proj_lab2.not_null_analysis_rsi.ed61ffb3c8)
[0m05:28:10.187696 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_rsi.ed61ffb3c8
[0m05:28:10.193149 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_rsi.ed61ffb3c8"
[0m05:28:10.194122 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_rsi.ed61ffb3c8
[0m05:28:10.197069 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_rsi.ed61ffb3c8"
[0m05:28:10.198276 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_rsi.ed61ffb3c8"
[0m05:28:10.198721 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_rsi.ed61ffb3c8: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_rsi.ed61ffb3c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from dev.analytics.analysis
where rsi is null



      
    ) dbt_internal_test
[0m05:28:10.199186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:28:10.613299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m05:28:10.616879 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_rsi.ed61ffb3c8: Close
[0m05:28:10.732316 [info ] [Thread-1 (]: 5 of 7 PASS not_null_analysis_rsi .............................................. [[32mPASS[0m in 0.54s]
[0m05:28:10.733359 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_rsi.ed61ffb3c8
[0m05:28:10.733988 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb
[0m05:28:10.734546 [info ] [Thread-1 (]: 6 of 7 START test not_null_analysis_symbol ..................................... [RUN]
[0m05:28:10.735281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_rsi.ed61ffb3c8, now test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb)
[0m05:28:10.735863 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb
[0m05:28:10.741306 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb"
[0m05:28:10.742221 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb
[0m05:28:10.745773 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb"
[0m05:28:10.747532 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb"
[0m05:28:10.748315 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.analysis
where symbol is null



      
    ) dbt_internal_test
[0m05:28:10.748770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:28:11.680686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.932 seconds
[0m05:28:11.683995 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb: Close
[0m05:28:11.796290 [info ] [Thread-1 (]: 6 of 7 PASS not_null_analysis_symbol ........................................... [[32mPASS[0m in 1.06s]
[0m05:28:11.797472 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb
[0m05:28:11.798226 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:28:11.798783 [info ] [Thread-1 (]: 7 of 7 START test unique_analysis_date ......................................... [RUN]
[0m05:28:11.799539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb, now test.dbt_proj_lab2.unique_analysis_date.9fe96713fa)
[0m05:28:11.800094 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:28:11.809094 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:28:11.815947 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:28:11.821512 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:28:11.823267 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:28:11.824490 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.analysis
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m05:28:11.825474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:28:12.435910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m05:28:12.445042 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: Close
[0m05:28:12.561788 [info ] [Thread-1 (]: 7 of 7 PASS unique_analysis_date ............................................... [[32mPASS[0m in 0.76s]
[0m05:28:12.562985 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:28:12.564807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:28:12.565312 [debug] [MainThread]: Connection 'test.dbt_proj_lab2.unique_analysis_date.9fe96713fa' was properly closed.
[0m05:28:12.565833 [info ] [MainThread]: 
[0m05:28:12.566405 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 6.09 seconds (6.09s).
[0m05:28:12.569396 [debug] [MainThread]: Command end result
[0m05:28:12.620107 [info ] [MainThread]: 
[0m05:28:12.620699 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m05:28:12.621119 [info ] [MainThread]: 
[0m05:28:12.621649 [error] [MainThread]:   Compilation Error in test expression_is_true_analysis_rsi__rsi_BETWEEN_0_AND_100 (models/schema.yml)
  'test_expression_is_true' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:28:12.622180 [info ] [MainThread]: 
[0m05:28:12.622765 [error] [MainThread]:   Database Error in test not_null_analysis_price_momentum (models/schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'PRICE_MOMENTUM'
  compiled code at target/run/dbt_proj_lab2/models/schema.yml/not_null_analysis_price_momentum.sql
[0m05:28:12.623360 [info ] [MainThread]: 
[0m05:28:12.623859 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m05:28:12.627006 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 9.020384, "process_user_time": 4.487459, "process_kernel_time": 0.865657, "process_mem_max_rss": "183361536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:28:12.627981 [debug] [MainThread]: Command `dbt test` failed at 05:28:12.627805 after 9.02 seconds
[0m05:28:12.628610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fededb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110975ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12383fbc0>]}
[0m05:28:12.629255 [debug] [MainThread]: Flushing usage events
[0m05:29:50.637268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512a7b0>]}


============================== 05:29:50.644052 | 3ac9c759-a772-4364-90a1-7820ccd9af7b ==============================
[0m05:29:50.644052 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:29:50.644803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:29:53.247056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ac9c759-a772-4364-90a1-7820ccd9af7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039be570>]}
[0m05:29:53.314693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ac9c759-a772-4364-90a1-7820ccd9af7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf05f0>]}
[0m05:29:53.317841 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:29:53.349298 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:29:53.590154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:29:53.591032 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/schema.yml
[0m05:29:53.863990 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:29:53.864743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ac9c759-a772-4364-90a1-7820ccd9af7b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9e540>]}
[0m05:29:54.095714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ac9c759-a772-4364-90a1-7820ccd9af7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117e92420>]}
[0m05:29:54.272105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ac9c759-a772-4364-90a1-7820ccd9af7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182dbc50>]}
[0m05:29:54.272806 [info ] [MainThread]: Found 1 snapshot, 1 model, 2 data tests, 1 source, 459 macros
[0m05:29:54.273280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ac9c759-a772-4364-90a1-7820ccd9af7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117be7ef0>]}
[0m05:29:54.275641 [info ] [MainThread]: 
[0m05:29:54.276358 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:29:54.277525 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m05:29:54.301125 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:29:54.301688 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:29:54.302094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:29:54.946103 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.643 seconds
[0m05:29:54.950269 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:29:55.065287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m05:29:55.069218 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:29:55.069764 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:29:55.070315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:29:55.567490 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.497 seconds
[0m05:29:55.570524 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:29:55.692928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ac9c759-a772-4364-90a1-7820ccd9af7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b87290>]}
[0m05:29:55.693859 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:29:55.694417 [info ] [MainThread]: 
[0m05:29:55.697855 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:29:55.698586 [info ] [Thread-1 (]: 1 of 2 START test not_null_analysis_date ....................................... [RUN]
[0m05:29:55.699452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.dbt_proj_lab2.not_null_analysis_date.82ab678f33)
[0m05:29:55.700280 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:29:55.727261 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:29:55.730264 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:29:55.762288 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:29:55.763607 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:29:55.764114 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.analysis
where date is null



      
    ) dbt_internal_test
[0m05:29:55.764591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:56.208624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m05:29:56.229781 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: Close
[0m05:29:56.347815 [info ] [Thread-1 (]: 1 of 2 PASS not_null_analysis_date ............................................. [[32mPASS[0m in 0.65s]
[0m05:29:56.349060 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:29:56.349822 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:29:56.350535 [info ] [Thread-1 (]: 2 of 2 START test unique_analysis_date ......................................... [RUN]
[0m05:29:56.351262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_date.82ab678f33, now test.dbt_proj_lab2.unique_analysis_date.9fe96713fa)
[0m05:29:56.351861 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:29:56.362805 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:29:56.363959 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:29:56.367442 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:29:56.368880 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:29:56.369495 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.analysis
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m05:29:56.370124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:56.758440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m05:29:56.761832 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: Close
[0m05:29:56.885468 [info ] [Thread-1 (]: 2 of 2 PASS unique_analysis_date ............................................... [[32mPASS[0m in 0.53s]
[0m05:29:56.886674 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:29:56.888427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:29:56.888932 [debug] [MainThread]: Connection 'test.dbt_proj_lab2.unique_analysis_date.9fe96713fa' was properly closed.
[0m05:29:56.889447 [info ] [MainThread]: 
[0m05:29:56.890017 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m05:29:56.891346 [debug] [MainThread]: Command end result
[0m05:29:56.939328 [info ] [MainThread]: 
[0m05:29:56.940107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:29:56.940604 [info ] [MainThread]: 
[0m05:29:56.941126 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:29:56.946153 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.395596, "process_user_time": 4.617073, "process_kernel_time": 0.989272, "process_mem_max_rss": "186408960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:29:56.947126 [debug] [MainThread]: Command `dbt test` succeeded at 05:29:56.946969 after 6.40 seconds
[0m05:29:56.947690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f77dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512aae0>]}
[0m05:29:56.948187 [debug] [MainThread]: Flushing usage events
[0m05:33:27.324358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6aa20>]}


============================== 05:33:27.331180 | 52f83864-5a60-4056-81db-8b3464d3ae5e ==============================
[0m05:33:27.331180 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:33:27.332039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:33:29.704325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52f83864-5a60-4056-81db-8b3464d3ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184e5010>]}
[0m05:33:29.769535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52f83864-5a60-4056-81db-8b3464d3ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118446c00>]}
[0m05:33:29.776158 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:33:29.802289 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:33:30.066752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:33:30.067595 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/schema.yml
[0m05:33:30.344536 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:33:30.345286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '52f83864-5a60-4056-81db-8b3464d3ae5e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189b4320>]}
[0m05:33:30.578884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52f83864-5a60-4056-81db-8b3464d3ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188dcf20>]}
[0m05:33:30.750905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52f83864-5a60-4056-81db-8b3464d3ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b8dcd0>]}
[0m05:33:30.751458 [info ] [MainThread]: Found 1 snapshot, 1 model, 4 data tests, 1 source, 459 macros
[0m05:33:30.751921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52f83864-5a60-4056-81db-8b3464d3ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11899dfa0>]}
[0m05:33:30.754236 [info ] [MainThread]: 
[0m05:33:30.755128 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:33:30.756304 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m05:33:30.779153 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:33:30.779656 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:33:30.780045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:33:31.514392 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.733 seconds
[0m05:33:31.518550 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:33:31.647695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:33:31.651937 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:33:31.652431 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:33:31.652880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:33:32.111515 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.459 seconds
[0m05:33:32.114415 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:33:32.221687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52f83864-5a60-4056-81db-8b3464d3ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118aaaf90>]}
[0m05:33:32.222672 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:33:32.223306 [info ] [MainThread]: 
[0m05:33:32.232449 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.idempotent_data_analysis_date__symbol.476d65ab99
[0m05:33:32.233384 [info ] [Thread-1 (]: 1 of 4 START test idempotent_data_analysis_date__symbol ........................ [RUN]
[0m05:33:32.234259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.dbt_proj_lab2.idempotent_data_analysis_date__symbol.476d65ab99)
[0m05:33:32.234986 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.idempotent_data_analysis_date__symbol.476d65ab99
[0m05:33:32.268068 [debug] [Thread-1 (]: Compilation Error in test idempotent_data_analysis_date__symbol (models/schema.yml)
  'test_idempotent_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:33:32.269157 [error] [Thread-1 (]: 1 of 4 ERROR idempotent_data_analysis_date__symbol ............................. [[31mERROR[0m in 0.03s]
[0m05:33:32.270348 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.idempotent_data_analysis_date__symbol.476d65ab99
[0m05:33:32.270929 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:33:32.272393 [info ] [Thread-1 (]: 2 of 4 START test not_null_analysis_date ....................................... [RUN]
[0m05:33:32.273193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.idempotent_data_analysis_date__symbol.476d65ab99, now test.dbt_proj_lab2.not_null_analysis_date.82ab678f33)
[0m05:33:32.273792 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:33:32.286967 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:33:32.288009 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:33:32.318601 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:33:32.319876 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:33:32.320376 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.analysis
where date is null



      
    ) dbt_internal_test
[0m05:33:32.320837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:33:32.700105 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.379 seconds
[0m05:33:32.714681 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: Close
[0m05:33:32.826921 [info ] [Thread-1 (]: 2 of 4 PASS not_null_analysis_date ............................................. [[32mPASS[0m in 0.55s]
[0m05:33:32.828349 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:33:32.829119 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb
[0m05:33:32.829822 [info ] [Thread-1 (]: 3 of 4 START test not_null_analysis_symbol ..................................... [RUN]
[0m05:33:32.830563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_date.82ab678f33, now test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb)
[0m05:33:32.831163 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb
[0m05:33:32.837582 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb"
[0m05:33:32.838844 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb
[0m05:33:32.843554 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb"
[0m05:33:32.845121 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb"
[0m05:33:32.845734 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.analysis
where symbol is null



      
    ) dbt_internal_test
[0m05:33:32.846303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:33:33.211516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.365 seconds
[0m05:33:33.214907 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb: Close
[0m05:33:33.369465 [info ] [Thread-1 (]: 3 of 4 PASS not_null_analysis_symbol ........................................... [[32mPASS[0m in 0.54s]
[0m05:33:33.370660 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb
[0m05:33:33.371437 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:33:33.372124 [info ] [Thread-1 (]: 4 of 4 START test unique_analysis_date ......................................... [RUN]
[0m05:33:33.372902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb, now test.dbt_proj_lab2.unique_analysis_date.9fe96713fa)
[0m05:33:33.373486 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:33:33.384111 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:33:33.385297 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:33:33.388835 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:33:33.390413 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:33:33.391090 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.analysis
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m05:33:33.391883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:33:33.774337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m05:33:33.777514 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: Close
[0m05:33:33.908143 [info ] [Thread-1 (]: 4 of 4 PASS unique_analysis_date ............................................... [[32mPASS[0m in 0.54s]
[0m05:33:33.909338 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:33:33.911141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:33:33.911647 [debug] [MainThread]: Connection 'test.dbt_proj_lab2.unique_analysis_date.9fe96713fa' was properly closed.
[0m05:33:33.912162 [info ] [MainThread]: 
[0m05:33:33.912810 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m05:33:33.914712 [debug] [MainThread]: Command end result
[0m05:33:33.963910 [info ] [MainThread]: 
[0m05:33:33.964493 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:33:33.965095 [info ] [MainThread]: 
[0m05:33:33.965775 [error] [MainThread]:   Compilation Error in test idempotent_data_analysis_date__symbol (models/schema.yml)
  'test_idempotent_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:33:33.966403 [info ] [MainThread]: 
[0m05:33:33.967218 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m05:33:33.971747 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 6.801204, "process_user_time": 4.768969, "process_kernel_time": 0.945833, "process_mem_max_rss": "187101184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:33:33.972792 [debug] [MainThread]: Command `dbt test` failed at 05:33:33.972603 after 6.80 seconds
[0m05:33:33.973443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b23fb0>]}
[0m05:33:33.973971 [debug] [MainThread]: Flushing usage events
[0m05:37:31.636947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6e900>]}


============================== 05:37:31.643265 | 00ca1dd1-b07c-4803-9850-28653dc38246 ==============================
[0m05:37:31.643265 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:37:31.644106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:37:33.901915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00ca1dd1-b07c-4803-9850-28653dc38246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0c170>]}
[0m05:37:33.967231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00ca1dd1-b07c-4803-9850-28653dc38246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186433e0>]}
[0m05:37:33.973749 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:37:33.999056 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:37:34.152997 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_proj_lab2: schema.yml - Runtime Error
    Syntax error near line 14
    ------------------------------
    11 |         description: "The stock symbol for which the metrics are calculated"
    12 |         tests:
    13 |           - not_null  
    14 |       columns: ["date", "symbol"]  
    15 |         tests:
    16 |         - idempotent_data:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 5, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 14, column 7
[0m05:37:34.160106 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.6038976, "process_user_time": 3.474437, "process_kernel_time": 0.693148, "process_mem_max_rss": "168923136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:37:34.161297 [debug] [MainThread]: Command `dbt test` failed at 05:37:34.161102 after 2.61 seconds
[0m05:37:34.161976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117927b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186a0e60>]}
[0m05:37:34.162588 [debug] [MainThread]: Flushing usage events
[0m05:38:15.156750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df6870>]}


============================== 05:38:15.164454 | 2779c854-6a9b-41a2-8b7b-58d757821525 ==============================
[0m05:38:15.164454 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:38:15.165405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m05:38:16.884173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2779c854-6a9b-41a2-8b7b-58d757821525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c95d00>]}
[0m05:38:16.949490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2779c854-6a9b-41a2-8b7b-58d757821525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf46e0>]}
[0m05:38:16.956217 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:38:16.987255 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:38:17.251568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:38:17.252509 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/schema.yml
[0m05:38:17.522321 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:38:17.522979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2779c854-6a9b-41a2-8b7b-58d757821525', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118acda90>]}
[0m05:38:17.767451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2779c854-6a9b-41a2-8b7b-58d757821525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cd8f20>]}
[0m05:38:17.932342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2779c854-6a9b-41a2-8b7b-58d757821525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f50350>]}
[0m05:38:17.932935 [info ] [MainThread]: Found 1 snapshot, 1 model, 4 data tests, 1 source, 459 macros
[0m05:38:17.933504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2779c854-6a9b-41a2-8b7b-58d757821525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c81fd0>]}
[0m05:38:17.935798 [info ] [MainThread]: 
[0m05:38:17.936602 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:38:17.937725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m05:38:17.961438 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:38:17.962246 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:38:17.962635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:38:18.670428 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.708 seconds
[0m05:38:18.673666 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:38:18.790325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m05:38:18.794300 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:38:18.794990 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:38:18.795493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:38:19.235870 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.440 seconds
[0m05:38:19.238312 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:38:19.357054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2779c854-6a9b-41a2-8b7b-58d757821525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188a2b10>]}
[0m05:38:19.357905 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:38:19.358432 [info ] [MainThread]: 
[0m05:38:19.366895 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e
[0m05:38:19.367551 [info ] [Thread-1 (]: 1 of 4 START test idempotent_data_analysis_date ................................ [RUN]
[0m05:38:19.369024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e)
[0m05:38:19.369791 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e
[0m05:38:19.395643 [debug] [Thread-1 (]: Compilation Error in test idempotent_data_analysis_date (models/schema.yml)
  'test_idempotent_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:38:19.396372 [error] [Thread-1 (]: 1 of 4 ERROR idempotent_data_analysis_date ..................................... [[31mERROR[0m in 0.03s]
[0m05:38:19.397074 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e
[0m05:38:19.397601 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:38:19.398843 [info ] [Thread-1 (]: 2 of 4 START test not_null_analysis_date ....................................... [RUN]
[0m05:38:19.399427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e, now test.dbt_proj_lab2.not_null_analysis_date.82ab678f33)
[0m05:38:19.399882 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:38:19.411968 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:38:19.413211 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:38:19.443281 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:38:19.444763 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:38:19.445305 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.analysis
where date is null



      
    ) dbt_internal_test
[0m05:38:19.445774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:38:19.837247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m05:38:19.857504 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: Close
[0m05:38:19.963143 [info ] [Thread-1 (]: 2 of 4 PASS not_null_analysis_date ............................................. [[32mPASS[0m in 0.56s]
[0m05:38:19.964212 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:38:19.964876 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb
[0m05:38:19.965464 [info ] [Thread-1 (]: 3 of 4 START test not_null_analysis_symbol ..................................... [RUN]
[0m05:38:19.966188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_date.82ab678f33, now test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb)
[0m05:38:19.966732 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb
[0m05:38:19.972555 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb"
[0m05:38:19.973600 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb
[0m05:38:19.977595 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb"
[0m05:38:19.979075 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb"
[0m05:38:19.979664 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.analysis
where symbol is null



      
    ) dbt_internal_test
[0m05:38:19.980345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:38:20.338541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.358 seconds
[0m05:38:20.341941 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb: Close
[0m05:38:20.486670 [info ] [Thread-1 (]: 3 of 4 PASS not_null_analysis_symbol ........................................... [[32mPASS[0m in 0.52s]
[0m05:38:20.487798 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb
[0m05:38:20.488476 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:38:20.489075 [info ] [Thread-1 (]: 4 of 4 START test unique_analysis_date ......................................... [RUN]
[0m05:38:20.489836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_symbol.daa73e64bb, now test.dbt_proj_lab2.unique_analysis_date.9fe96713fa)
[0m05:38:20.490479 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:38:20.501534 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:38:20.502621 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:38:20.506136 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:38:20.507562 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:38:20.508285 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.analysis
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m05:38:20.508869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:38:20.923604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.415 seconds
[0m05:38:20.926231 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: Close
[0m05:38:21.039068 [info ] [Thread-1 (]: 4 of 4 PASS unique_analysis_date ............................................... [[32mPASS[0m in 0.55s]
[0m05:38:21.040247 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:38:21.042024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:38:21.042533 [debug] [MainThread]: Connection 'test.dbt_proj_lab2.unique_analysis_date.9fe96713fa' was properly closed.
[0m05:38:21.043126 [info ] [MainThread]: 
[0m05:38:21.043890 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m05:38:21.045762 [debug] [MainThread]: Command end result
[0m05:38:21.091675 [info ] [MainThread]: 
[0m05:38:21.092317 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:38:21.092984 [info ] [MainThread]: 
[0m05:38:21.094059 [error] [MainThread]:   Compilation Error in test idempotent_data_analysis_date (models/schema.yml)
  'test_idempotent_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:38:21.094991 [info ] [MainThread]: 
[0m05:38:21.095794 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m05:38:21.099676 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 6.0276833, "process_user_time": 4.516843, "process_kernel_time": 0.62731, "process_mem_max_rss": "187338752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:38:21.101097 [debug] [MainThread]: Command `dbt test` failed at 05:38:21.100739 after 6.03 seconds
[0m05:38:21.101884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d8da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d8daf0>]}
[0m05:38:21.102457 [debug] [MainThread]: Flushing usage events
[0m05:39:10.699837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2305f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc92ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc92930>]}


============================== 05:39:10.705805 | 86b00867-049c-4727-b690-e0479dd40f3d ==============================
[0m05:39:10.705805 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:39:10.706608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:39:12.972411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86b00867-049c-4727-b690-e0479dd40f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ffbc0e0>]}
[0m05:39:13.037030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86b00867-049c-4727-b690-e0479dd40f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11efd8b60>]}
[0m05:39:13.043748 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:39:13.072065 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:39:13.314342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:39:13.315242 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/schema.yml
[0m05:39:13.592364 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:39:13.593032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '86b00867-049c-4727-b690-e0479dd40f3d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a0b650>]}
[0m05:39:13.836319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86b00867-049c-4727-b690-e0479dd40f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bd37a0>]}
[0m05:39:14.017352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86b00867-049c-4727-b690-e0479dd40f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e3fe30>]}
[0m05:39:14.017940 [info ] [MainThread]: Found 1 snapshot, 1 model, 3 data tests, 1 source, 459 macros
[0m05:39:14.018464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b00867-049c-4727-b690-e0479dd40f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209ef140>]}
[0m05:39:14.021255 [info ] [MainThread]: 
[0m05:39:14.022358 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:39:14.023947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m05:39:14.046168 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:39:14.046892 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:39:14.047343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:39:14.736952 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.689 seconds
[0m05:39:14.740586 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:39:14.855843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:39:14.860516 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:39:14.861034 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:39:14.861548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:39:15.347944 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.486 seconds
[0m05:39:15.350829 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:39:15.456478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b00867-049c-4727-b690-e0479dd40f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b76180>]}
[0m05:39:15.457479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:39:15.458121 [info ] [MainThread]: 
[0m05:39:15.467479 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e
[0m05:39:15.468331 [info ] [Thread-1 (]: 1 of 3 START test idempotent_data_analysis_date ................................ [RUN]
[0m05:39:15.469284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e)
[0m05:39:15.470013 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e
[0m05:39:15.502561 [debug] [Thread-1 (]: Compilation Error in test idempotent_data_analysis_date (models/schema.yml)
  'test_idempotent_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:39:15.503481 [error] [Thread-1 (]: 1 of 3 ERROR idempotent_data_analysis_date ..................................... [[31mERROR[0m in 0.03s]
[0m05:39:15.504463 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e
[0m05:39:15.505157 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:39:15.506727 [info ] [Thread-1 (]: 2 of 3 START test not_null_analysis_date ....................................... [RUN]
[0m05:39:15.507495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e, now test.dbt_proj_lab2.not_null_analysis_date.82ab678f33)
[0m05:39:15.508188 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:39:15.522844 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:39:15.524049 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:39:15.563850 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:39:15.565218 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m05:39:15.565774 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.analysis
where date is null



      
    ) dbt_internal_test
[0m05:39:15.566288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:39:15.963834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m05:39:15.979417 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: Close
[0m05:39:16.093614 [info ] [Thread-1 (]: 2 of 3 PASS not_null_analysis_date ............................................. [[32mPASS[0m in 0.59s]
[0m05:39:16.094820 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m05:39:16.095566 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:39:16.096314 [info ] [Thread-1 (]: 3 of 3 START test unique_analysis_date ......................................... [RUN]
[0m05:39:16.097045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_date.82ab678f33, now test.dbt_proj_lab2.unique_analysis_date.9fe96713fa)
[0m05:39:16.097632 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:39:16.108425 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:39:16.109496 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:39:16.112963 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:39:16.114358 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m05:39:16.114948 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.analysis
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m05:39:16.115516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:39:16.526845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m05:39:16.530159 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: Close
[0m05:39:16.657974 [info ] [Thread-1 (]: 3 of 3 PASS unique_analysis_date ............................................... [[32mPASS[0m in 0.56s]
[0m05:39:16.659152 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m05:39:16.660943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:39:16.661443 [debug] [MainThread]: Connection 'test.dbt_proj_lab2.unique_analysis_date.9fe96713fa' was properly closed.
[0m05:39:16.661956 [info ] [MainThread]: 
[0m05:39:16.662519 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.64 seconds (2.64s).
[0m05:39:16.664128 [debug] [MainThread]: Command end result
[0m05:39:16.714069 [info ] [MainThread]: 
[0m05:39:16.714889 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:39:16.715476 [info ] [MainThread]: 
[0m05:39:16.716328 [error] [MainThread]:   Compilation Error in test idempotent_data_analysis_date (models/schema.yml)
  'test_idempotent_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m05:39:16.716947 [info ] [MainThread]: 
[0m05:39:16.717511 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m05:39:16.723230 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 6.10152, "process_user_time": 4.698817, "process_kernel_time": 0.943342, "process_mem_max_rss": "186875904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:39:16.724303 [debug] [MainThread]: Command `dbt test` failed at 05:39:16.724116 after 6.10 seconds
[0m05:39:16.724985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce48770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120050b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7bea20>]}
[0m05:39:16.725537 [debug] [MainThread]: Flushing usage events
[0m13:40:33.933464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d8783aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d86fce5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d8746c9e0>]}


============================== 13:40:33.942900 | c8e9577e-7c51-490f-8a2a-584f33fd4e63 ==============================
[0m13:40:33.942900 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:40:33.944493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:40:35.268649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8e9577e-7c51-490f-8a2a-584f33fd4e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d744a6030>]}
[0m13:40:35.339289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8e9577e-7c51-490f-8a2a-584f33fd4e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6fafb560>]}
[0m13:40:35.341042 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:40:35.495369 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:40:35.699531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:35.700514 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:35.771445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8e9577e-7c51-490f-8a2a-584f33fd4e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d8746c4a0>]}
[0m13:40:35.950984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8e9577e-7c51-490f-8a2a-584f33fd4e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6f523140>]}
[0m13:40:35.952056 [info ] [MainThread]: Found 1 snapshot, 1 model, 3 data tests, 1 source, 459 macros
[0m13:40:35.953061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8e9577e-7c51-490f-8a2a-584f33fd4e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6f710740>]}
[0m13:40:35.955624 [info ] [MainThread]: 
[0m13:40:35.957124 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:40:35.959005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m13:40:35.981430 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m13:40:35.982448 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m13:40:35.983547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:36.502177 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.519 seconds
[0m13:40:36.505523 [debug] [ThreadPool]: On list_dev: Close
[0m13:40:36.624361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m13:40:36.641377 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m13:40:36.642493 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m13:40:36.643669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:37.154846 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.511 seconds
[0m13:40:37.158694 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m13:40:37.267286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m13:40:37.271752 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m13:40:37.272832 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m13:40:37.273636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:37.762525 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.489 seconds
[0m13:40:37.766527 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m13:40:37.878268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8e9577e-7c51-490f-8a2a-584f33fd4e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d6f6f00b0>]}
[0m13:40:37.880048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:37.881365 [info ] [MainThread]: 
[0m13:40:37.898093 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.analysis
[0m13:40:37.899579 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.analysis ................................ [RUN]
[0m13:40:37.901076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.analysis)
[0m13:40:37.902202 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.analysis
[0m13:40:37.914535 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.analysis"
[0m13:40:37.918639 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.analysis
[0m13:40:37.961609 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.analysis"
[0m13:40:37.967142 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.analysis"
[0m13:40:37.968363 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.analysis"} */
create or replace transient table dev.analytics.analysis
         as
        (WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

-- Calculate price change (used for RSI calculation)
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate gains and losses
gains_and_losses AS (
    SELECT
        date,
        symbol,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

-- Calculate the average gains and losses for RSI calculation
averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),

-- Calculate RSI based on average gains and losses
rsi_data AS (
    SELECT
        date,
        symbol,
        CASE 
            WHEN avg_loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
        END AS rsi
    FROM averages
),

-- Calculate the 7-day moving average
moving_avg_data AS (
    SELECT
        date,
        symbol,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
    FROM base_data
),

-- Use ROW_NUMBER to ensure we only take the first row per symbol and date
ranked_data AS (
    SELECT
        rsi_data.date,
        rsi_data.symbol,
        rsi_data.rsi,
        moving_avg_data.moving_avg_7d,
        ROW_NUMBER() OVER (PARTITION BY rsi_data.symbol, rsi_data.date ORDER BY rsi_data.date) AS rn
    FROM rsi_data
    JOIN moving_avg_data
        ON rsi_data.date = moving_avg_data.date AND rsi_data.symbol = moving_avg_data.symbol
)

-- Select only the rows with rank 1 (the first occurrence per symbol and date)
SELECT 
    date,
    symbol,
    rsi,
    moving_avg_7d
FROM ranked_data
WHERE rn = 1
ORDER BY symbol, date
        );
[0m13:40:37.969919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:39.447705 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.478 seconds
[0m13:40:39.491363 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: Close
[0m13:40:39.600639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8e9577e-7c51-490f-8a2a-584f33fd4e63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d87812b10>]}
[0m13:40:39.602483 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.analysis ........................... [[32mSUCCESS 1[0m in 1.70s]
[0m13:40:39.604247 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.analysis
[0m13:40:39.608244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:39.609209 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.analysis' was properly closed.
[0m13:40:39.610113 [info ] [MainThread]: 
[0m13:40:39.611076 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m13:40:39.612486 [debug] [MainThread]: Command end result
[0m13:40:39.678448 [info ] [MainThread]: 
[0m13:40:39.679683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:39.680956 [info ] [MainThread]: 
[0m13:40:39.682497 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:40:39.684629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.882249, "process_user_time": 4.98177, "process_kernel_time": 0.985943, "process_mem_max_rss": "213176", "process_out_blocks": "1856", "process_in_blocks": "0"}
[0m13:40:39.686015 [debug] [MainThread]: Command `dbt run` succeeded at 13:40:39.685847 after 5.88 seconds
[0m13:40:39.687117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d8abbaff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d87f5ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d87f5ff80>]}
[0m13:40:39.688751 [debug] [MainThread]: Flushing usage events
[0m13:40:44.932727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2a84d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2cffab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2a84ef60>]}


============================== 13:40:44.940914 | 96434141-8fb9-4daa-8bbe-f3d33fd53f3d ==============================
[0m13:40:44.940914 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:40:44.942143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:40:46.147456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96434141-8fb9-4daa-8bbe-f3d33fd53f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde137b2600>]}
[0m13:40:46.241128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96434141-8fb9-4daa-8bbe-f3d33fd53f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde131f5f70>]}
[0m13:40:46.243035 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:40:46.454946 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:40:46.770093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:46.771145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:46.852274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96434141-8fb9-4daa-8bbe-f3d33fd53f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde12f07a40>]}
[0m13:40:47.272567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96434141-8fb9-4daa-8bbe-f3d33fd53f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde12f06720>]}
[0m13:40:47.274836 [info ] [MainThread]: Found 1 snapshot, 1 model, 3 data tests, 1 source, 459 macros
[0m13:40:47.278025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96434141-8fb9-4daa-8bbe-f3d33fd53f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde12c44fe0>]}
[0m13:40:47.284339 [info ] [MainThread]: 
[0m13:40:47.286440 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:40:47.289051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m13:40:47.336761 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m13:40:47.338138 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m13:40:47.339321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:47.895382 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.556 seconds
[0m13:40:47.899120 [debug] [ThreadPool]: On list_dev: Close
[0m13:40:48.020062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m13:40:48.036563 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m13:40:48.037694 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m13:40:48.038591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:48.513643 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.475 seconds
[0m13:40:48.517982 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m13:40:48.669209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m13:40:48.676017 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m13:40:48.677100 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m13:40:48.678295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:49.220846 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.542 seconds
[0m13:40:49.224708 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m13:40:49.366604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96434141-8fb9-4daa-8bbe-f3d33fd53f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde12e9fe90>]}
[0m13:40:49.368545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:49.370273 [info ] [MainThread]: 
[0m13:40:49.384635 [debug] [Thread-1 (]: Began running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m13:40:49.386404 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.stock_metrics_snapshot .......................... [RUN]
[0m13:40:49.387877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.dbt_proj_lab2.stock_metrics_snapshot)
[0m13:40:49.388950 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m13:40:49.403543 [debug] [Thread-1 (]: Began executing node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m13:40:49.496182 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:49.497322 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
[0m13:40:49.498500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.903255 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.405 seconds
[0m13:40:49.987472 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:49.989064 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
create or replace temporary table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.analysis


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m13:40:51.081827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.091 seconds
[0m13:40:51.087566 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:51.088850 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp"
[0m13:40:51.224555 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.134 seconds
[0m13:40:51.231506 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:51.232735 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
[0m13:40:51.363804 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.130 seconds
[0m13:40:51.371029 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:51.372257 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp"
[0m13:40:51.466718 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.093 seconds
[0m13:40:51.473807 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:51.475040 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
[0m13:40:51.556780 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.081 seconds
[0m13:40:51.570883 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:51.572256 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp"
[0m13:40:51.654543 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.081 seconds
[0m13:40:51.691110 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:51.692485 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.analysis


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m13:40:52.309269 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.615 seconds
[0m13:40:52.316282 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:52.317520 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m13:40:52.423771 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.105 seconds
[0m13:40:52.425716 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:52.435097 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:52.436944 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
BEGIN
[0m13:40:52.553956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m13:40:52.555557 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:52.557244 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
merge into "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "RSI", "MOVING_AVG_7D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "RSI", "MOVING_AVG_7D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m13:40:53.334225 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.775 seconds
[0m13:40:53.335943 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m13:40:53.337403 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
COMMIT
[0m13:40:54.358327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.019 seconds
[0m13:40:54.393448 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: Close
[0m13:40:54.535058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96434141-8fb9-4daa-8bbe-f3d33fd53f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2b05a570>]}
[0m13:40:54.537242 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.stock_metrics_snapshot .......................... [[32mSUCCESS 0[0m in 5.15s]
[0m13:40:54.539070 [debug] [Thread-1 (]: Finished running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m13:40:54.542551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:54.543819 [debug] [MainThread]: Connection 'snapshot.dbt_proj_lab2.stock_metrics_snapshot' was properly closed.
[0m13:40:54.544926 [info ] [MainThread]: 
[0m13:40:54.546160 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.26 seconds (7.26s).
[0m13:40:54.548065 [debug] [MainThread]: Command end result
[0m13:40:54.620161 [info ] [MainThread]: 
[0m13:40:54.621340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:54.622265 [info ] [MainThread]: 
[0m13:40:54.623450 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:40:54.625369 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.812995, "process_user_time": 5.418118, "process_kernel_time": 0.567815, "process_mem_max_rss": "214020", "process_out_blocks": "1861", "process_in_blocks": "0"}
[0m13:40:54.626490 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:40:54.626346 after 9.81 seconds
[0m13:40:54.627441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2e466ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde12d36450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde12d355e0>]}
[0m13:40:54.628635 [debug] [MainThread]: Flushing usage events
[0m13:41:00.008579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f478ef3e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f478f2a0bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f478ef3e5d0>]}


============================== 13:41:00.019374 | 80991cbe-9a90-43e6-a802-0413c31fc4e1 ==============================
[0m13:41:00.019374 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:41:00.021025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:41:01.287528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80991cbe-9a90-43e6-a802-0413c31fc4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4789b571a0>]}
[0m13:41:01.364364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80991cbe-9a90-43e6-a802-0413c31fc4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f478f101940>]}
[0m13:41:01.365919 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:41:01.544537 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:41:01.755398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:41:01.757200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:41:01.837209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80991cbe-9a90-43e6-a802-0413c31fc4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4777f9bce0>]}
[0m13:41:02.051894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80991cbe-9a90-43e6-a802-0413c31fc4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47771cd340>]}
[0m13:41:02.053215 [info ] [MainThread]: Found 1 snapshot, 1 model, 3 data tests, 1 source, 459 macros
[0m13:41:02.054606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80991cbe-9a90-43e6-a802-0413c31fc4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f477cea9220>]}
[0m13:41:02.059568 [info ] [MainThread]: 
[0m13:41:02.061975 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:41:02.064787 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m13:41:02.101235 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m13:41:02.102888 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m13:41:02.104252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:02.701890 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.598 seconds
[0m13:41:02.707535 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m13:41:02.838557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m13:41:02.845078 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m13:41:02.846191 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m13:41:02.847091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:03.259495 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.412 seconds
[0m13:41:03.263508 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m13:41:03.401544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80991cbe-9a90-43e6-a802-0413c31fc4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47771a6510>]}
[0m13:41:03.403372 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:41:03.404798 [info ] [MainThread]: 
[0m13:41:03.418587 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e
[0m13:41:03.420094 [info ] [Thread-1 (]: 1 of 3 START test idempotent_data_analysis_date ................................ [RUN]
[0m13:41:03.421431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e)
[0m13:41:03.422604 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e
[0m13:41:03.455691 [debug] [Thread-1 (]: Compilation Error in test idempotent_data_analysis_date (models/schema.yml)
  'test_idempotent_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:41:03.457740 [error] [Thread-1 (]: 1 of 3 ERROR idempotent_data_analysis_date ..................................... [[31mERROR[0m in 0.04s]
[0m13:41:03.459601 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e
[0m13:41:03.461074 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m13:41:03.463267 [info ] [Thread-1 (]: 2 of 3 START test not_null_analysis_date ....................................... [RUN]
[0m13:41:03.464634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e, now test.dbt_proj_lab2.not_null_analysis_date.82ab678f33)
[0m13:41:03.465807 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m13:41:03.478181 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m13:41:03.481157 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m13:41:03.512253 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m13:41:03.515383 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m13:41:03.516419 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.analysis
where date is null



      
    ) dbt_internal_test
[0m13:41:03.517491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:04.189194 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m13:41:04.215595 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: Close
[0m13:41:04.347342 [info ] [Thread-1 (]: 2 of 3 PASS not_null_analysis_date ............................................. [[32mPASS[0m in 0.88s]
[0m13:41:04.351332 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m13:41:04.353437 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m13:41:04.356641 [info ] [Thread-1 (]: 3 of 3 START test unique_analysis_date ......................................... [RUN]
[0m13:41:04.361466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_date.82ab678f33, now test.dbt_proj_lab2.unique_analysis_date.9fe96713fa)
[0m13:41:04.364337 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m13:41:04.383397 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m13:41:04.394919 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m13:41:04.412310 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m13:41:04.418176 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m13:41:04.420467 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.analysis
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m13:41:04.422111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:04.909720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m13:41:04.913567 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: Close
[0m13:41:05.027087 [info ] [Thread-1 (]: 3 of 3 PASS unique_analysis_date ............................................... [[32mPASS[0m in 0.67s]
[0m13:41:05.029241 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m13:41:05.032703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:05.034896 [debug] [MainThread]: Connection 'test.dbt_proj_lab2.unique_analysis_date.9fe96713fa' was properly closed.
[0m13:41:05.036163 [info ] [MainThread]: 
[0m13:41:05.037802 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m13:41:05.040400 [debug] [MainThread]: Command end result
[0m13:41:05.117538 [info ] [MainThread]: 
[0m13:41:05.118720 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:41:05.119822 [info ] [MainThread]: 
[0m13:41:05.121256 [error] [MainThread]:   Compilation Error in test idempotent_data_analysis_date (models/schema.yml)
  'test_idempotent_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:41:05.122413 [info ] [MainThread]: 
[0m13:41:05.123660 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:41:05.125824 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.2499104, "process_user_time": 5.466939, "process_kernel_time": 0.563591, "process_mem_max_rss": "215584", "process_in_blocks": "200", "process_out_blocks": "1848", "command_success": false}
[0m13:41:05.127128 [debug] [MainThread]: Command `dbt test` failed at 13:41:05.126963 after 5.25 seconds
[0m13:41:05.128549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f478f81f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47777a6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4790384470>]}
[0m13:41:05.129717 [debug] [MainThread]: Flushing usage events
[0m13:46:11.517106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd114c768a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd114c75b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd114b9dd00>]}


============================== 13:46:11.533927 | d6a3acf4-bf0f-41eb-ad33-7d49a27aefe0 ==============================
[0m13:46:11.533927 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:46:11.536616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m13:46:13.564804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6a3acf4-bf0f-41eb-ad33-7d49a27aefe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd10107dc10>]}
[0m13:46:13.637491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6a3acf4-bf0f-41eb-ad33-7d49a27aefe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd100deb680>]}
[0m13:46:13.638984 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:46:13.818656 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:46:14.015639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:14.017009 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:14.120232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6a3acf4-bf0f-41eb-ad33-7d49a27aefe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd100bd3bf0>]}
[0m13:46:14.324733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6a3acf4-bf0f-41eb-ad33-7d49a27aefe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1005052b0>]}
[0m13:46:14.326059 [info ] [MainThread]: Found 1 snapshot, 1 model, 3 data tests, 1 source, 459 macros
[0m13:46:14.327594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6a3acf4-bf0f-41eb-ad33-7d49a27aefe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd100b83fb0>]}
[0m13:46:14.330561 [info ] [MainThread]: 
[0m13:46:14.334524 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:46:14.336879 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m13:46:14.367835 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m13:46:14.369284 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m13:46:14.370397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:14.979559 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.609 seconds
[0m13:46:14.982592 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m13:46:15.105025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m13:46:15.110748 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m13:46:15.112148 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m13:46:15.113273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:15.524366 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.411 seconds
[0m13:46:15.528379 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m13:46:15.634613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6a3acf4-bf0f-41eb-ad33-7d49a27aefe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1006c9700>]}
[0m13:46:15.636550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:15.638173 [info ] [MainThread]: 
[0m13:46:15.652930 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e
[0m13:46:15.654401 [info ] [Thread-1 (]: 1 of 3 START test idempotent_data_analysis_date ................................ [RUN]
[0m13:46:15.655783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e)
[0m13:46:15.657102 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e
[0m13:46:15.681120 [debug] [Thread-1 (]: Compilation Error in test idempotent_data_analysis_date (models/schema.yml)
  'test_idempotent_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:46:15.682546 [error] [Thread-1 (]: 1 of 3 ERROR idempotent_data_analysis_date ..................................... [[31mERROR[0m in 0.03s]
[0m13:46:15.683897 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e
[0m13:46:15.685251 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m13:46:15.687150 [info ] [Thread-1 (]: 2 of 3 START test not_null_analysis_date ....................................... [RUN]
[0m13:46:15.688486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.idempotent_data_analysis_date.260b8d8a0e, now test.dbt_proj_lab2.not_null_analysis_date.82ab678f33)
[0m13:46:15.689528 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m13:46:15.704050 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m13:46:15.707502 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m13:46:15.741315 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m13:46:15.745031 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m13:46:15.746254 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.analysis
where date is null



      
    ) dbt_internal_test
[0m13:46:15.747216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:16.229750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m13:46:16.245217 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: Close
[0m13:46:16.390166 [info ] [Thread-1 (]: 2 of 3 PASS not_null_analysis_date ............................................. [[32mPASS[0m in 0.70s]
[0m13:46:16.392180 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m13:46:16.393812 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m13:46:16.396595 [info ] [Thread-1 (]: 3 of 3 START test unique_analysis_date ......................................... [RUN]
[0m13:46:16.398974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_date.82ab678f33, now test.dbt_proj_lab2.unique_analysis_date.9fe96713fa)
[0m13:46:16.400452 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m13:46:16.413297 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m13:46:16.416490 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m13:46:16.421855 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m13:46:16.426247 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m13:46:16.428553 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.analysis
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m13:46:16.429870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:16.863553 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m13:46:16.870460 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: Close
[0m13:46:16.996008 [info ] [Thread-1 (]: 3 of 3 PASS unique_analysis_date ............................................... [[32mPASS[0m in 0.60s]
[0m13:46:16.997951 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m13:46:17.001381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:17.002509 [debug] [MainThread]: Connection 'test.dbt_proj_lab2.unique_analysis_date.9fe96713fa' was properly closed.
[0m13:46:17.003603 [info ] [MainThread]: 
[0m13:46:17.004752 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m13:46:17.007164 [debug] [MainThread]: Command end result
[0m13:46:17.077647 [info ] [MainThread]: 
[0m13:46:17.080424 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:46:17.081577 [info ] [MainThread]: 
[0m13:46:17.082782 [error] [MainThread]:   Compilation Error in test idempotent_data_analysis_date (models/schema.yml)
  'test_idempotent_data' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:46:17.084547 [info ] [MainThread]: 
[0m13:46:17.085672 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:46:17.088000 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.7431674, "process_user_time": 7.398734, "process_kernel_time": 0.66988, "process_mem_max_rss": "215664", "process_out_blocks": "1848", "command_success": false, "process_in_blocks": "0"}
[0m13:46:17.089358 [debug] [MainThread]: Command `dbt test` failed at 13:46:17.089183 after 5.74 seconds
[0m13:46:17.090891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd11585c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd11585c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1003c9070>]}
[0m13:46:17.092903 [debug] [MainThread]: Flushing usage events
[0m15:33:34.255785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3eac44a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e4127a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3eac7cb0>]}


============================== 15:33:34.264930 | ffbb583a-d5c0-4339-b356-aa6e4520b743 ==============================
[0m15:33:34.264930 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:33:34.266565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:33:35.524049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffbb583a-d5c0-4339-b356-aa6e4520b743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e2757c8f0>]}
[0m15:33:35.592488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffbb583a-d5c0-4339-b356-aa6e4520b743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e2c5f3a70>]}
[0m15:33:35.593874 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:33:35.748374 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:33:35.947757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:33:35.949282 [debug] [MainThread]: Partial parsing: updated file: dbt_proj_lab2://models/schema.yml
[0m15:33:36.241019 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:33:36.242320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ffbb583a-d5c0-4339-b356-aa6e4520b743', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e3e23ffb0>]}
[0m15:33:36.520606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffbb583a-d5c0-4339-b356-aa6e4520b743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e265768d0>]}
[0m15:33:36.740067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffbb583a-d5c0-4339-b356-aa6e4520b743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e2602b7a0>]}
[0m15:33:36.741442 [info ] [MainThread]: Found 1 snapshot, 1 model, 2 data tests, 1 source, 459 macros
[0m15:33:36.742554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffbb583a-d5c0-4339-b356-aa6e4520b743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e26d7ac00>]}
[0m15:33:36.745346 [info ] [MainThread]: 
[0m15:33:36.746772 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:36.749825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m15:33:36.776253 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m15:33:36.777297 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m15:33:36.778201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:37.370581 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.592 seconds
[0m15:33:37.374810 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:33:37.501842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m15:33:37.508358 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m15:33:37.509614 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m15:33:37.510682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:38.013520 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.503 seconds
[0m15:33:38.017278 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m15:33:38.152408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffbb583a-d5c0-4339-b356-aa6e4520b743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e26549be0>]}
[0m15:33:38.153942 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:38.155572 [info ] [MainThread]: 
[0m15:33:38.177205 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m15:33:38.179947 [info ] [Thread-1 (]: 1 of 2 START test not_null_analysis_date ....................................... [RUN]
[0m15:33:38.182068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.dbt_proj_lab2.not_null_analysis_date.82ab678f33)
[0m15:33:38.183891 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m15:33:38.225302 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m15:33:38.229950 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m15:33:38.265269 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m15:33:38.269379 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m15:33:38.270464 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.analysis
where date is null



      
    ) dbt_internal_test
[0m15:33:38.271765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:38.767001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m15:33:38.781633 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: Close
[0m15:33:38.896993 [info ] [Thread-1 (]: 1 of 2 PASS not_null_analysis_date ............................................. [[32mPASS[0m in 0.71s]
[0m15:33:38.900714 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m15:33:38.903160 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m15:33:38.905782 [info ] [Thread-1 (]: 2 of 2 START test unique_analysis_date ......................................... [RUN]
[0m15:33:38.909246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_date.82ab678f33, now test.dbt_proj_lab2.unique_analysis_date.9fe96713fa)
[0m15:33:38.910882 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m15:33:38.932278 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m15:33:38.936186 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m15:33:38.947777 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m15:33:39.004054 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m15:33:39.005630 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.analysis
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m15:33:39.010172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:39.602431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m15:33:39.606659 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: Close
[0m15:33:39.760674 [info ] [Thread-1 (]: 2 of 2 PASS unique_analysis_date ............................................... [[32mPASS[0m in 0.85s]
[0m15:33:39.762725 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m15:33:39.766332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:39.767640 [debug] [MainThread]: Connection 'test.dbt_proj_lab2.unique_analysis_date.9fe96713fa' was properly closed.
[0m15:33:39.768822 [info ] [MainThread]: 
[0m15:33:39.770116 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m15:33:39.772046 [debug] [MainThread]: Command end result
[0m15:33:39.851096 [info ] [MainThread]: 
[0m15:33:39.852193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:39.853068 [info ] [MainThread]: 
[0m15:33:39.854010 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:33:39.855551 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.7373466, "process_user_time": 5.446064, "process_kernel_time": 0.882616, "process_mem_max_rss": "220472", "process_out_blocks": "2750", "process_in_blocks": "0"}
[0m15:33:39.856651 [debug] [MainThread]: Command `dbt test` succeeded at 15:33:39.856513 after 5.74 seconds
[0m15:33:39.857554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e40355af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e40354d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e26e92db0>]}
[0m15:33:39.858474 [debug] [MainThread]: Flushing usage events
[0m15:34:47.425763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7705748860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7705253830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7705749b20>]}


============================== 15:34:47.434500 | ec41fa35-2c36-4b39-a2c6-c91d331aa974 ==============================
[0m15:34:47.434500 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:34:47.436019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m15:34:48.717799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec41fa35-2c36-4b39-a2c6-c91d331aa974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f770579e3f0>]}
[0m15:34:48.813313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec41fa35-2c36-4b39-a2c6-c91d331aa974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77060915b0>]}
[0m15:34:48.814862 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:34:48.979339 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:34:49.203259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:34:49.204365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:34:49.289712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec41fa35-2c36-4b39-a2c6-c91d331aa974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f118c920>]}
[0m15:34:49.626596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec41fa35-2c36-4b39-a2c6-c91d331aa974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77047fdee0>]}
[0m15:34:49.634919 [info ] [MainThread]: Found 1 snapshot, 1 model, 2 data tests, 1 source, 459 macros
[0m15:34:49.637169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec41fa35-2c36-4b39-a2c6-c91d331aa974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ffdba4e0>]}
[0m15:34:49.648708 [info ] [MainThread]: 
[0m15:34:49.656408 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:34:49.659413 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m15:34:49.730522 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m15:34:49.732130 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m15:34:49.735954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:50.513780 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.778 seconds
[0m15:34:50.516644 [debug] [ThreadPool]: On list_dev: Close
[0m15:34:50.635908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m15:34:50.651955 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m15:34:50.653136 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m15:34:50.654095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:51.080680 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.427 seconds
[0m15:34:51.083680 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:34:51.200696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m15:34:51.205393 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m15:34:51.206366 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m15:34:51.207164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:51.724141 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.517 seconds
[0m15:34:51.727148 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m15:34:51.847725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec41fa35-2c36-4b39-a2c6-c91d331aa974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77041861b0>]}
[0m15:34:51.849173 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:34:51.850242 [info ] [MainThread]: 
[0m15:34:51.861477 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.analysis
[0m15:34:51.862709 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.analysis ................................ [RUN]
[0m15:34:51.864018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.dbt_proj_lab2.analysis)
[0m15:34:51.864985 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.analysis
[0m15:34:51.876067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.analysis"
[0m15:34:51.881950 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.analysis
[0m15:34:51.928002 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.analysis"
[0m15:34:51.933963 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.analysis"
[0m15:34:51.935498 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.analysis"} */
create or replace transient table dev.analytics.analysis
         as
        (WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

-- Calculate price change (used for RSI calculation)
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate gains and losses
gains_and_losses AS (
    SELECT
        date,
        symbol,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

-- Calculate the average gains and losses for RSI calculation
averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),

-- Calculate RSI based on average gains and losses
rsi_data AS (
    SELECT
        date,
        symbol,
        CASE 
            WHEN avg_loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
        END AS rsi
    FROM averages
),

-- Calculate the 7-day moving average
moving_avg_data AS (
    SELECT
        date,
        symbol,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
    FROM base_data
),

-- Use ROW_NUMBER to ensure we only take the first row per symbol and date
ranked_data AS (
    SELECT
        rsi_data.date,
        rsi_data.symbol,
        rsi_data.rsi,
        moving_avg_data.moving_avg_7d,
        ROW_NUMBER() OVER (PARTITION BY rsi_data.symbol, rsi_data.date ORDER BY rsi_data.date) AS rn
    FROM rsi_data
    JOIN moving_avg_data
        ON rsi_data.date = moving_avg_data.date AND rsi_data.symbol = moving_avg_data.symbol
)

-- Select only the rows with rank 1 (the first occurrence per symbol and date)
SELECT 
    date,
    symbol,
    rsi,
    moving_avg_7d
FROM ranked_data
WHERE rn = 1
ORDER BY symbol, date
        );
[0m15:34:51.936952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:53.452799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.516 seconds
[0m15:34:53.502518 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: Close
[0m15:34:53.520996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14c8bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd145223f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd13e18f20>]}


============================== 15:34:53.530086 | b4d1c745-0c6e-43e3-8709-1c0467b0b20e ==============================
[0m15:34:53.530086 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:34:53.531619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:34:53.629993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec41fa35-2c36-4b39-a2c6-c91d331aa974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7705e89a00>]}
[0m15:34:53.633439 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.analysis ........................... [[32mSUCCESS 1[0m in 1.76s]
[0m15:34:53.636250 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.analysis
[0m15:34:53.641347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:53.642133 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.analysis' was properly closed.
[0m15:34:53.643314 [info ] [MainThread]: 
[0m15:34:53.646263 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m15:34:53.648369 [debug] [MainThread]: Command end result
[0m15:34:53.736598 [info ] [MainThread]: 
[0m15:34:53.738290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:34:53.739518 [info ] [MainThread]: 
[0m15:34:53.740618 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:34:53.742771 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4379406, "process_user_time": 5.423401, "process_kernel_time": 0.775799, "process_mem_max_rss": "213080", "process_out_blocks": "1847", "process_in_blocks": "0"}
[0m15:34:53.743835 [debug] [MainThread]: Command `dbt run` succeeded at 15:34:53.743694 after 6.44 seconds
[0m15:34:53.744713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77050a1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7704807c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7704c887a0>]}
[0m15:34:53.745660 [debug] [MainThread]: Flushing usage events
[0m15:34:54.878720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4d1c745-0c6e-43e3-8709-1c0467b0b20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd00878e00>]}
[0m15:34:54.957955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4d1c745-0c6e-43e3-8709-1c0467b0b20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd0dfc84a0>]}
[0m15:34:54.959730 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:34:55.139254 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:34:55.328742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:34:55.329682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:34:55.397961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4d1c745-0c6e-43e3-8709-1c0467b0b20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd00408da0>]}
[0m15:34:55.566459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4d1c745-0c6e-43e3-8709-1c0467b0b20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd003a17f0>]}
[0m15:34:55.567623 [info ] [MainThread]: Found 1 snapshot, 1 model, 2 data tests, 1 source, 459 macros
[0m15:34:55.568932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4d1c745-0c6e-43e3-8709-1c0467b0b20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd00147170>]}
[0m15:34:55.572067 [info ] [MainThread]: 
[0m15:34:55.573639 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:34:55.575593 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m15:34:55.598290 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m15:34:55.599815 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m15:34:55.600899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:57.181603 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.581 seconds
[0m15:34:57.184983 [debug] [ThreadPool]: On list_dev: Close
[0m15:34:57.336471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m15:34:57.349958 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m15:34:57.350924 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m15:34:57.351907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:57.809494 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.457 seconds
[0m15:34:57.813719 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m15:34:57.925853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m15:34:57.929969 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m15:34:57.930895 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m15:34:57.931694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:58.472421 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.541 seconds
[0m15:34:58.476059 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:34:58.595534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4d1c745-0c6e-43e3-8709-1c0467b0b20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd000fe3f0>]}
[0m15:34:58.597307 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:34:58.598419 [info ] [MainThread]: 
[0m15:34:58.609593 [debug] [Thread-1 (]: Began running node model.dbt_proj_lab2.analysis
[0m15:34:58.610827 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.analysis ................................ [RUN]
[0m15:34:58.612393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.dbt_proj_lab2.analysis)
[0m15:34:58.613933 [debug] [Thread-1 (]: Began compiling node model.dbt_proj_lab2.analysis
[0m15:34:58.624978 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_proj_lab2.analysis"
[0m15:34:58.627782 [debug] [Thread-1 (]: Began executing node model.dbt_proj_lab2.analysis
[0m15:34:58.671577 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_proj_lab2.analysis"
[0m15:34:58.677236 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_proj_lab2.analysis"
[0m15:34:58.678689 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "model.dbt_proj_lab2.analysis"} */
create or replace transient table dev.analytics.analysis
         as
        (WITH base_data AS (
    SELECT
        date,
        symbol,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS previous_close
    FROM dev.raw_data.stockprice
),

-- Calculate price change (used for RSI calculation)
price_changes AS (
    SELECT
        date,
        symbol,
        close,
        close - previous_close AS price_change
    FROM base_data
    WHERE previous_close IS NOT NULL
),

-- Calculate gains and losses
gains_and_losses AS (
    SELECT
        date,
        symbol,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM price_changes
),

-- Calculate the average gains and losses for RSI calculation
averages AS (
    SELECT
        date,
        symbol,
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM gains_and_losses
),

-- Calculate RSI based on average gains and losses
rsi_data AS (
    SELECT
        date,
        symbol,
        CASE 
            WHEN avg_loss = 0 THEN 100
            ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
        END AS rsi
    FROM averages
),

-- Calculate the 7-day moving average
moving_avg_data AS (
    SELECT
        date,
        symbol,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
    FROM base_data
),

-- Use ROW_NUMBER to ensure we only take the first row per symbol and date
ranked_data AS (
    SELECT
        rsi_data.date,
        rsi_data.symbol,
        rsi_data.rsi,
        moving_avg_data.moving_avg_7d,
        ROW_NUMBER() OVER (PARTITION BY rsi_data.symbol, rsi_data.date ORDER BY rsi_data.date) AS rn
    FROM rsi_data
    JOIN moving_avg_data
        ON rsi_data.date = moving_avg_data.date AND rsi_data.symbol = moving_avg_data.symbol
)

-- Select only the rows with rank 1 (the first occurrence per symbol and date)
SELECT 
    date,
    symbol,
    rsi,
    moving_avg_7d
FROM ranked_data
WHERE rn = 1
ORDER BY symbol, date
        );
[0m15:34:58.679977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:58.894369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66312622d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6632025700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6630ac6a20>]}


============================== 15:34:58.902518 | 291d3d81-8772-4fbc-bb39-a42dbfa05d8f ==============================
[0m15:34:58.902518 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:34:58.904392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m15:34:59.913921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.234 seconds
[0m15:34:59.977966 [debug] [Thread-1 (]: On model.dbt_proj_lab2.analysis: Close
[0m15:35:00.104935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4d1c745-0c6e-43e3-8709-1c0467b0b20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd14586a20>]}
[0m15:35:00.107359 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.analysis ........................... [[32mSUCCESS 1[0m in 1.49s]
[0m15:35:00.110060 [debug] [Thread-1 (]: Finished running node model.dbt_proj_lab2.analysis
[0m15:35:00.119895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:00.121101 [debug] [MainThread]: Connection 'model.dbt_proj_lab2.analysis' was properly closed.
[0m15:35:00.122358 [info ] [MainThread]: 
[0m15:35:00.127099 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m15:35:00.135184 [debug] [MainThread]: Command end result
[0m15:35:00.235867 [info ] [MainThread]: 
[0m15:35:00.237126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:00.238543 [info ] [MainThread]: 
[0m15:35:00.239791 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:35:00.242056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8404326, "process_user_time": 4.861313, "process_kernel_time": 0.684562, "process_mem_max_rss": "213060", "process_out_blocks": "1847", "process_in_blocks": "0"}
[0m15:35:00.243504 [debug] [MainThread]: Command `dbt run` succeeded at 15:35:00.243297 after 6.84 seconds
[0m15:35:00.246062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd17967020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd1417af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd1417b890>]}
[0m15:35:00.247438 [debug] [MainThread]: Flushing usage events
[0m15:35:00.336696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '291d3d81-8772-4fbc-bb39-a42dbfa05d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662ad89010>]}
[0m15:35:00.405475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '291d3d81-8772-4fbc-bb39-a42dbfa05d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661d6a35f0>]}
[0m15:35:00.406854 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:35:00.556387 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:35:00.757421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:00.758971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:00.856770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '291d3d81-8772-4fbc-bb39-a42dbfa05d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661d1f3350>]}
[0m15:35:01.113643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '291d3d81-8772-4fbc-bb39-a42dbfa05d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661d038e00>]}
[0m15:35:01.115160 [info ] [MainThread]: Found 1 snapshot, 1 model, 2 data tests, 1 source, 459 macros
[0m15:35:01.118588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '291d3d81-8772-4fbc-bb39-a42dbfa05d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661cf20b90>]}
[0m15:35:01.123732 [info ] [MainThread]: 
[0m15:35:01.126629 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:35:01.129514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m15:35:01.167042 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m15:35:01.169679 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m15:35:01.171929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:01.731030 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.559 seconds
[0m15:35:01.737408 [debug] [ThreadPool]: On list_dev: Close
[0m15:35:01.893076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m15:35:01.911061 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m15:35:01.912396 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m15:35:01.913559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:02.419225 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.505 seconds
[0m15:35:02.423090 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:35:02.548382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m15:35:02.553886 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m15:35:02.555095 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m15:35:02.556792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:03.100332 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.543 seconds
[0m15:35:03.103203 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m15:35:03.229959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '291d3d81-8772-4fbc-bb39-a42dbfa05d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661cf20b90>]}
[0m15:35:03.231542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:35:03.233370 [info ] [MainThread]: 
[0m15:35:03.248384 [debug] [Thread-1 (]: Began running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m15:35:03.250612 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.stock_metrics_snapshot .......................... [RUN]
[0m15:35:03.252507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.dbt_proj_lab2.stock_metrics_snapshot)
[0m15:35:03.253579 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m15:35:03.269075 [debug] [Thread-1 (]: Began executing node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m15:35:03.378405 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:03.380013 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
[0m15:35:03.381325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:03.837859 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.457 seconds
[0m15:35:03.914805 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:03.916328 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
create or replace temporary table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.analysis


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m15:35:04.920490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.003 seconds
[0m15:35:04.925431 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:04.927038 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp"
[0m15:35:05.040942 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.113 seconds
[0m15:35:05.046819 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:05.047963 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
[0m15:35:05.140367 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.091 seconds
[0m15:35:05.147349 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:05.148771 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp"
[0m15:35:05.217557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9798a5c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9799ef2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797ee4fe0>]}


============================== 15:35:05.226696 | 44d70955-b1de-45d5-8c3f-990b82bd2fa6 ==============================
[0m15:35:05.226696 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:35:05.228229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:35:05.264522 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.114 seconds
[0m15:35:05.270884 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:05.272037 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
[0m15:35:05.354921 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.082 seconds
[0m15:35:05.379044 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:05.383488 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp"
[0m15:35:05.533539 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.148 seconds
[0m15:35:05.571852 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:05.573742 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.analysis


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m15:35:05.948103 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.373 seconds
[0m15:35:05.955200 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:05.956515 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:35:06.048217 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.090 seconds
[0m15:35:06.049626 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:06.056549 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:06.057619 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
BEGIN
[0m15:35:06.218634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m15:35:06.220656 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:06.222356 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
merge into "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "RSI", "MOVING_AVG_7D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "RSI", "MOVING_AVG_7D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m15:35:06.552600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44d70955-b1de-45d5-8c3f-990b82bd2fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979b35aff0>]}
[0m15:35:06.624846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44d70955-b1de-45d5-8c3f-990b82bd2fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f977fe53d10>]}
[0m15:35:06.626639 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:35:06.780470 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:35:07.041560 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.817 seconds
[0m15:35:07.046569 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:07.059862 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
COMMIT
[0m15:35:07.123493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:07.124729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:07.213555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44d70955-b1de-45d5-8c3f-990b82bd2fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f977fd76510>]}
[0m15:35:07.382755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44d70955-b1de-45d5-8c3f-990b82bd2fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f977f90af90>]}
[0m15:35:07.383873 [info ] [MainThread]: Found 1 snapshot, 1 model, 2 data tests, 1 source, 459 macros
[0m15:35:07.385156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44d70955-b1de-45d5-8c3f-990b82bd2fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f977fad8aa0>]}
[0m15:35:07.387715 [info ] [MainThread]: 
[0m15:35:07.388862 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:35:07.391190 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m15:35:07.413874 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m15:35:07.415133 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m15:35:07.416273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:07.435581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m15:35:07.468152 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: Close
[0m15:35:07.588195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291d3d81-8772-4fbc-bb39-a42dbfa05d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66312d26f0>]}
[0m15:35:07.590383 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.stock_metrics_snapshot .......................... [[32mSUCCESS 0[0m in 4.33s]
[0m15:35:07.592476 [debug] [Thread-1 (]: Finished running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m15:35:07.595728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:07.596690 [debug] [MainThread]: Connection 'snapshot.dbt_proj_lab2.stock_metrics_snapshot' was properly closed.
[0m15:35:07.597702 [info ] [MainThread]: 
[0m15:35:07.598927 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.47 seconds (6.47s).
[0m15:35:07.600573 [debug] [MainThread]: Command end result
[0m15:35:07.660965 [info ] [MainThread]: 
[0m15:35:07.662459 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:07.663846 [info ] [MainThread]: 
[0m15:35:07.665442 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:35:07.667246 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.886348, "process_user_time": 5.573966, "process_kernel_time": 0.62116, "process_mem_max_rss": "214056", "process_out_blocks": "1851", "process_in_blocks": "0"}
[0m15:35:07.668575 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:35:07.668396 after 8.89 seconds
[0m15:35:07.669580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6630ea6c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6630ee8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6630e8e180>]}
[0m15:35:07.670505 [debug] [MainThread]: Flushing usage events
[0m15:35:07.949644 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.534 seconds
[0m15:35:07.953234 [debug] [ThreadPool]: On list_dev: Close
[0m15:35:08.097470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m15:35:08.120751 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m15:35:08.122093 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m15:35:08.123923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:08.629762 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.506 seconds
[0m15:35:08.634774 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m15:35:08.751498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m15:35:08.755866 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m15:35:08.757099 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m15:35:08.758068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:09.265908 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.508 seconds
[0m15:35:09.269758 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:35:09.435692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44d70955-b1de-45d5-8c3f-990b82bd2fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f977fddc620>]}
[0m15:35:09.437358 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:35:09.438907 [info ] [MainThread]: 
[0m15:35:09.453925 [debug] [Thread-1 (]: Began running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m15:35:09.455550 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.stock_metrics_snapshot .......................... [RUN]
[0m15:35:09.456971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.dbt_proj_lab2.stock_metrics_snapshot)
[0m15:35:09.458055 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m15:35:09.473151 [debug] [Thread-1 (]: Began executing node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m15:35:09.566672 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:09.568108 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
[0m15:35:09.569419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:10.015006 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.445 seconds
[0m15:35:10.098489 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:10.100136 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
create or replace temporary table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.analysis


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m15:35:11.268755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.167 seconds
[0m15:35:11.273348 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:11.274512 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp"
[0m15:35:11.415294 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.140 seconds
[0m15:35:11.420851 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:11.422044 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
[0m15:35:11.495980 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.073 seconds
[0m15:35:11.503578 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:11.504968 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp"
[0m15:35:11.594072 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.087 seconds
[0m15:35:11.600468 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:11.601617 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
[0m15:35:11.699410 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.097 seconds
[0m15:35:11.714150 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:11.716114 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
describe table "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp"
[0m15:35:11.824006 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.106 seconds
[0m15:35:11.862691 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:11.864256 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.analysis


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        date as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m15:35:12.345439 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.479 seconds
[0m15:35:12.355395 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:12.359190 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:35:12.462616 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.102 seconds
[0m15:35:12.464067 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:12.468153 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:12.469297 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
BEGIN
[0m15:35:12.600206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m15:35:12.601422 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:12.602480 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
merge into "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."STOCK_METRICS_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "RSI", "MOVING_AVG_7D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "RSI", "MOVING_AVG_7D", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m15:35:12.918568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97a01dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b3a2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97b289ac0>]}


============================== 15:35:12.932158 | 8c081a96-94df-4179-b0f3-de2ae5b711b0 ==============================
[0m15:35:12.932158 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:35:12.933900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:35:13.115025 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.510 seconds
[0m15:35:13.124057 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m15:35:13.127856 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
COMMIT
[0m15:35:13.492031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.362 seconds
[0m15:35:13.525582 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: Close
[0m15:35:13.727797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44d70955-b1de-45d5-8c3f-990b82bd2fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797ee6930>]}
[0m15:35:13.729523 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.stock_metrics_snapshot .......................... [[32mSUCCESS 0[0m in 4.27s]
[0m15:35:13.731115 [debug] [Thread-1 (]: Finished running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m15:35:13.734031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:13.734785 [debug] [MainThread]: Connection 'snapshot.dbt_proj_lab2.stock_metrics_snapshot' was properly closed.
[0m15:35:13.735584 [info ] [MainThread]: 
[0m15:35:13.736643 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m15:35:13.738228 [debug] [MainThread]: Command end result
[0m15:35:13.806095 [info ] [MainThread]: 
[0m15:35:13.807414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:13.808489 [info ] [MainThread]: 
[0m15:35:13.809483 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:35:13.811168 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.714822, "process_user_time": 5.356505, "process_kernel_time": 0.557149, "process_mem_max_rss": "213508", "process_out_blocks": "1851", "process_in_blocks": "0"}
[0m15:35:13.812347 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:35:13.812197 after 8.72 seconds
[0m15:35:13.813314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797957440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797ee5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9797597f80>]}
[0m15:35:13.814237 [debug] [MainThread]: Flushing usage events
[0m15:35:14.164699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c081a96-94df-4179-b0f3-de2ae5b711b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97434e1b0>]}
[0m15:35:14.250281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c081a96-94df-4179-b0f3-de2ae5b711b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa974dff470>]}
[0m15:35:14.252484 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:35:14.452354 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:35:14.820911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:14.821975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:14.915470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c081a96-94df-4179-b0f3-de2ae5b711b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9743ddac0>]}
[0m15:35:15.105937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c081a96-94df-4179-b0f3-de2ae5b711b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa965b97410>]}
[0m15:35:15.106997 [info ] [MainThread]: Found 1 snapshot, 1 model, 2 data tests, 1 source, 459 macros
[0m15:35:15.107981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c081a96-94df-4179-b0f3-de2ae5b711b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa965e58bf0>]}
[0m15:35:15.110610 [info ] [MainThread]: 
[0m15:35:15.112328 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:35:15.114773 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m15:35:15.140628 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m15:35:15.141635 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m15:35:15.142672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:15.741891 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.599 seconds
[0m15:35:15.744759 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m15:35:15.876244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m15:35:15.881245 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m15:35:15.882224 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m15:35:15.883212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:16.378174 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.495 seconds
[0m15:35:16.381055 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:35:16.518247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c081a96-94df-4179-b0f3-de2ae5b711b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa965e5b1a0>]}
[0m15:35:16.519732 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:35:16.521093 [info ] [MainThread]: 
[0m15:35:16.536147 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m15:35:16.537493 [info ] [Thread-1 (]: 1 of 2 START test not_null_analysis_date ....................................... [RUN]
[0m15:35:16.538636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.dbt_proj_lab2.not_null_analysis_date.82ab678f33)
[0m15:35:16.539612 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m15:35:16.583401 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m15:35:16.585929 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m15:35:16.631605 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m15:35:16.635441 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m15:35:16.636543 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.analysis
where date is null



      
    ) dbt_internal_test
[0m15:35:16.637636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:17.138527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m15:35:17.150412 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: Close
[0m15:35:17.266321 [info ] [Thread-1 (]: 1 of 2 PASS not_null_analysis_date ............................................. [[32mPASS[0m in 0.73s]
[0m15:35:17.267983 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m15:35:17.271347 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m15:35:17.272515 [info ] [Thread-1 (]: 2 of 2 START test unique_analysis_date ......................................... [RUN]
[0m15:35:17.273725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_date.82ab678f33, now test.dbt_proj_lab2.unique_analysis_date.9fe96713fa)
[0m15:35:17.277385 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m15:35:17.293943 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m15:35:17.300411 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m15:35:17.305205 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m15:35:17.310954 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m15:35:17.313108 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.analysis
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m15:35:17.314477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:17.813739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m15:35:17.817268 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: Close
[0m15:35:17.962297 [info ] [Thread-1 (]: 2 of 2 PASS unique_analysis_date ............................................... [[32mPASS[0m in 0.69s]
[0m15:35:17.964959 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m15:35:17.970308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:17.971655 [debug] [MainThread]: Connection 'test.dbt_proj_lab2.unique_analysis_date.9fe96713fa' was properly closed.
[0m15:35:17.973222 [info ] [MainThread]: 
[0m15:35:17.975495 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m15:35:17.980581 [debug] [MainThread]: Command end result
[0m15:35:18.085122 [info ] [MainThread]: 
[0m15:35:18.087097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:18.088604 [info ] [MainThread]: 
[0m15:35:18.090557 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:35:18.093035 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.321561, "process_user_time": 5.168172, "process_kernel_time": 0.534638, "process_mem_max_rss": "215200", "process_out_blocks": "1833", "process_in_blocks": "0"}
[0m15:35:18.096133 [debug] [MainThread]: Command `dbt test` succeeded at 15:35:18.095004 after 5.32 seconds
[0m15:35:18.098550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97d3daff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9799a4f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97a01dd60>]}
[0m15:35:18.099955 [debug] [MainThread]: Flushing usage events
[0m15:35:18.568581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553465da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5532ee4440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55356e9dc0>]}


============================== 15:35:18.580618 | 250be46c-21a3-4ac2-8d2e-17c76594a329 ==============================
[0m15:35:18.580618 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:35:18.583624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:35:20.219313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '250be46c-21a3-4ac2-8d2e-17c76594a329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5532e3aff0>]}
[0m15:35:20.287491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '250be46c-21a3-4ac2-8d2e-17c76594a329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f551b6b9430>]}
[0m15:35:20.289158 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:35:20.434883 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:35:20.611371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:20.613004 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:20.688020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '250be46c-21a3-4ac2-8d2e-17c76594a329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5532df2510>]}
[0m15:35:20.874881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '250be46c-21a3-4ac2-8d2e-17c76594a329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f551b0b55e0>]}
[0m15:35:20.876227 [info ] [MainThread]: Found 1 snapshot, 1 model, 2 data tests, 1 source, 459 macros
[0m15:35:20.877527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '250be46c-21a3-4ac2-8d2e-17c76594a329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f551b95a2d0>]}
[0m15:35:20.880351 [info ] [MainThread]: 
[0m15:35:20.882213 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:35:20.885026 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m15:35:20.921259 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m15:35:20.922649 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m15:35:20.923954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:21.553741 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.630 seconds
[0m15:35:21.558171 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:35:21.680375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m15:35:21.686860 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m15:35:21.688056 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m15:35:21.689227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:22.176955 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.488 seconds
[0m15:35:22.180543 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m15:35:22.312242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '250be46c-21a3-4ac2-8d2e-17c76594a329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f551b2eba10>]}
[0m15:35:22.314013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:35:22.315534 [info ] [MainThread]: 
[0m15:35:22.340174 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m15:35:22.341708 [info ] [Thread-1 (]: 1 of 2 START test not_null_analysis_date ....................................... [RUN]
[0m15:35:22.345219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.dbt_proj_lab2.not_null_analysis_date.82ab678f33)
[0m15:35:22.346817 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m15:35:22.390965 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m15:35:22.396391 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m15:35:22.445545 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m15:35:22.451582 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"
[0m15:35:22.453684 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.not_null_analysis_date.82ab678f33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.analysis
where date is null



      
    ) dbt_internal_test
[0m15:35:22.456091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:22.947657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m15:35:22.963130 [debug] [Thread-1 (]: On test.dbt_proj_lab2.not_null_analysis_date.82ab678f33: Close
[0m15:35:23.157201 [info ] [Thread-1 (]: 1 of 2 PASS not_null_analysis_date ............................................. [[32mPASS[0m in 0.81s]
[0m15:35:23.159394 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.not_null_analysis_date.82ab678f33
[0m15:35:23.161173 [debug] [Thread-1 (]: Began running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m15:35:23.162928 [info ] [Thread-1 (]: 2 of 2 START test unique_analysis_date ......................................... [RUN]
[0m15:35:23.164680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_proj_lab2.not_null_analysis_date.82ab678f33, now test.dbt_proj_lab2.unique_analysis_date.9fe96713fa)
[0m15:35:23.166034 [debug] [Thread-1 (]: Began compiling node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m15:35:23.178524 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m15:35:23.182104 [debug] [Thread-1 (]: Began executing node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m15:35:23.187538 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m15:35:23.191640 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"
[0m15:35:23.193866 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "test.dbt_proj_lab2.unique_analysis_date.9fe96713fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from dev.analytics.analysis
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m15:35:23.195516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:23.602229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m15:35:23.606667 [debug] [Thread-1 (]: On test.dbt_proj_lab2.unique_analysis_date.9fe96713fa: Close
[0m15:35:23.731484 [info ] [Thread-1 (]: 2 of 2 PASS unique_analysis_date ............................................... [[32mPASS[0m in 0.57s]
[0m15:35:23.733989 [debug] [Thread-1 (]: Finished running node test.dbt_proj_lab2.unique_analysis_date.9fe96713fa
[0m15:35:23.738572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:23.740289 [debug] [MainThread]: Connection 'test.dbt_proj_lab2.unique_analysis_date.9fe96713fa' was properly closed.
[0m15:35:23.741806 [info ] [MainThread]: 
[0m15:35:23.743533 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m15:35:23.745854 [debug] [MainThread]: Command end result
[0m15:35:23.811872 [info ] [MainThread]: 
[0m15:35:23.813115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:23.814393 [info ] [MainThread]: 
[0m15:35:23.815542 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:35:23.817325 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.400008, "process_user_time": 5.346525, "process_kernel_time": 0.569343, "process_mem_max_rss": "215128", "process_out_blocks": "1833", "process_in_blocks": "0"}
[0m15:35:23.818525 [debug] [MainThread]: Command `dbt test` succeeded at 15:35:23.818378 after 5.40 seconds
[0m15:35:23.819419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553392c4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553310bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f553312c5f0>]}
[0m15:35:23.820265 [debug] [MainThread]: Flushing usage events
[0m07:48:35.790005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103096420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9a7b0>]}


============================== 07:48:35.797432 | 6cb2325f-88bc-4475-8c3a-5b76d7928d6a ==============================
[0m07:48:35.797432 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:48:35.798340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/sridharvummidichetty/Desktop/lab/dbt_proj_lab2/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:48:38.373403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cb2325f-88bc-4475-8c3a-5b76d7928d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119474890>]}
[0m07:48:38.445024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cb2325f-88bc-4475-8c3a-5b76d7928d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b86f00>]}
[0m07:48:38.448522 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m07:48:38.476241 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:48:38.708411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:48:38.709046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:48:38.780703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cb2325f-88bc-4475-8c3a-5b76d7928d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119726ab0>]}
[0m07:48:38.926739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cb2325f-88bc-4475-8c3a-5b76d7928d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198424e0>]}
[0m07:48:38.927471 [info ] [MainThread]: Found 1 snapshot, 1 model, 2 data tests, 1 source, 459 macros
[0m07:48:38.927986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cb2325f-88bc-4475-8c3a-5b76d7928d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119655460>]}
[0m07:48:38.930313 [info ] [MainThread]: 
[0m07:48:38.931038 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:48:38.932071 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m07:48:38.954765 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m07:48:38.955274 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m07:48:38.955673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:48:39.652094 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.696 seconds
[0m07:48:39.655441 [debug] [ThreadPool]: On list_dev: Close
[0m07:48:39.765116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m07:48:39.778992 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m07:48:39.779609 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m07:48:39.780099 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:48:40.296187 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.516 seconds
[0m07:48:40.299753 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m07:48:40.409011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m07:48:40.413677 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m07:48:40.414221 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m07:48:40.414712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:48:40.874518 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.460 seconds
[0m07:48:40.877235 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m07:48:40.994914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cb2325f-88bc-4475-8c3a-5b76d7928d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119589790>]}
[0m07:48:40.995939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:48:40.996744 [info ] [MainThread]: 
[0m07:48:41.002253 [debug] [Thread-1 (]: Began running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m07:48:41.003567 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.stock_metrics_snapshot .......................... [RUN]
[0m07:48:41.004688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.dbt_proj_lab2.stock_metrics_snapshot)
[0m07:48:41.005333 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m07:48:41.018911 [debug] [Thread-1 (]: Began executing node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m07:48:41.149583 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m07:48:41.152270 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.analysis

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m07:48:41.152896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:41.648409 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.495 seconds
[0m07:48:41.657953 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m07:48:41.658651 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m07:48:41.808939 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.150 seconds
[0m07:48:41.810067 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m07:48:41.815026 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbt_proj_lab2.stock_metrics_snapshot"
[0m07:48:41.815832 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_proj_lab2", "target_name": "dev", "node_id": "snapshot.dbt_proj_lab2.stock_metrics_snapshot"} */
create or replace transient table dev.snapshot.stock_metrics_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



SELECT * FROM dev.analytics.analysis

    ) sbq



        );
[0m07:48:42.706468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m07:48:42.744850 [debug] [Thread-1 (]: On snapshot.dbt_proj_lab2.stock_metrics_snapshot: Close
[0m07:48:42.880004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cb2325f-88bc-4475-8c3a-5b76d7928d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106135d90>]}
[0m07:48:42.881289 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.stock_metrics_snapshot .......................... [[32mSUCCESS 1[0m in 1.87s]
[0m07:48:42.882394 [debug] [Thread-1 (]: Finished running node snapshot.dbt_proj_lab2.stock_metrics_snapshot
[0m07:48:42.884295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:48:42.884872 [debug] [MainThread]: Connection 'snapshot.dbt_proj_lab2.stock_metrics_snapshot' was properly closed.
[0m07:48:42.885375 [info ] [MainThread]: 
[0m07:48:42.885926 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.95 seconds (3.95s).
[0m07:48:42.887087 [debug] [MainThread]: Command end result
[0m07:48:42.929248 [info ] [MainThread]: 
[0m07:48:42.929975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:48:42.930496 [info ] [MainThread]: 
[0m07:48:42.931095 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:48:42.935272 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.2337313, "process_user_time": 4.328088, "process_kernel_time": 0.956192, "process_mem_max_rss": "179044352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:48:42.936327 [debug] [MainThread]: Command `dbt snapshot` succeeded at 07:48:42.936148 after 7.24 seconds
[0m07:48:42.936910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119956bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106532ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9a9f0>]}
[0m07:48:42.937428 [debug] [MainThread]: Flushing usage events
